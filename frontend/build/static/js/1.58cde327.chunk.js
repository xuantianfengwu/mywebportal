/*! For license information please see 1.58cde327.chunk.js.LICENSE.txt */
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[1],{279:function(e,t,r){var n=r(75),a=r(73);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},280:function(e,t,r){var n=r(283),a=r(116),i=r(279),o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=s.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):o.test(e)?NaN:+e}},283:function(e,t,r){var n=r(284),a=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(a,""):e}},284:function(e,t){var r=/\s/;e.exports=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t}},289:function(e,t,r){var n=r(317),a=r(318);e.exports=function(e,t,r,i){var o=!r;r||(r={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=i?i(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),o?a(r,u,c):n(r,u,c)}return r}},296:function(e,t,r){var n=r(116),a=r(297),i=r(280),o=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,d,f,h,v=0,p=!1,g=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=l,n=u;return l=u=void 0,v=t,d=e.apply(n,r)}function b(e){return v=e,f=setTimeout(S,t),p?y(e):d}function E(e){var r=e-h;return void 0===h||r>=t||r<0||g&&e-v>=c}function S(){var e=a();if(E(e))return k(e);f=setTimeout(S,function(e){var r=t-(e-h);return g?s(r,c-(e-v)):r}(e))}function k(e){return f=void 0,m&&l?y(e):(l=u=void 0,d)}function T(){var e=a(),r=E(e);if(l=arguments,u=this,h=e,r){if(void 0===f)return b(h);if(g)return clearTimeout(f),f=setTimeout(S,t),y(h)}return void 0===f&&(f=setTimeout(S,t)),d}return t=i(t)||0,n(r)&&(p=!!r.leading,c=(g="maxWait"in r)?o(i(r.maxWait)||0,t):c,m="trailing"in r?!!r.trailing:m),T.cancel=function(){void 0!==f&&clearTimeout(f),v=0,l=h=u=f=void 0},T.flush=function(){return void 0===f?d:k(a())},T}},297:function(e,t,r){var n=r(36);e.exports=function(){return n.Date.now()}},298:function(e,t,r){"use strict";var n,a;r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return u})),function(e){e.PLAY="event/dom/play",e.PLAYING="event/dom/playing",e.PAUSE="event/dom/pause",e.ENDED="event/dom/ended",e.TIMEUPDATE="event/dom/timeupdate",e.ERROR="event/dom/error",e.WAITING="event/dom/waiting"}(n||(n={})),function(e){e.QUALITY_CHANGE="event/player/quality-change",e.CHANGE_QUALITY_START="event/player/quality-change-start",e.CHANGE_QUALITY_SUCCESS="event/player/quality-change-success",e.CHANGE_QUALITY_FAIL="event/player/quality-change-fail",e.PLAYBACK_RATE_CHANGE="event/player/rate-change",e.REQUEST_PLAY="event/player/request-play",e.PLAY_REJECTED="event/player/play-rejected",e.REQUEST_PAUSE="event/player/request-pause",e.PLAY_COUNT="event/player/play-count",e.PLAY_FAILED="event/player/play-failed",e.ENTER_FULLSCREEN="event/player/enter-fullscreen",e.EXIT_FULLSCREEN="event/player/exit-fullscreen",e.ENTER_PAGE_FULLSCREEN="event/player/enter-page-fullscreen",e.EXIT_PAGE_FULLSCREEN="event/player/exit-page-fullscreen",e.ENTER_PIP="event/player/enter-pip",e.EXIT_PIP="event/player/exit-pip",e.SHOW_CONTROLLER="event/player/show-controller",e.HIDE_CONTROLLER="event/player/hide-controller",e.HOVER_PROGRESS_DOT="event/player/hover-progress-dot",e.LEAVE_PROGRESS_DOT="event/player/leave-progress-dot",e.SUBSCRIPTION_READY="event/player/subscription-ready"}(a||(a={}));var i,o=Object.assign(Object.assign(Object.assign({},n),a),{DOM:n,PLAYER:a});!function(e){e.PLAY="action/player/play",e.PAUSE="action/player/pause",e.SET_VOLUME="action/player/set-volume",e.ENTER_FULLSCREEN="action/player/enter-fullscreen",e.EXIT_FULLSCREEN="action/player/exit-fullscreen",e.ENTER_PAGE_FULLSCREEN="event/player/enter-page-fullscreen",e.EXIT_PAGE_FULLSCREEN="event/player/exit-page-fullscreen",e.ENTER_PIP="action/player/enter-pip",e.EXIT_PIP="action/player/exit-pip",e.TIME_UPDATE="action/player/time-update",e.SHOW_CONTROLLER="action/player/show-controller"}(i||(i={}));var s=Object.assign(Object.assign({},i),{PLAYER:i}),l="griffith";function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Set;function a(a,i){var o="function"===typeof a,s=o?a:i,u=o?void 0:a;function c(n){var a=n.origin,i="*"===t||t===a,c=n.data||{},d=c.from,f=c.id,h=c.payload;if(i&&d===l&&(!r||e===f)&&h){var v=h.name,p=h.data;if(!v||"function"!==typeof s)return;o?s(v,p,n.source):u===v&&s(p,n.source)}}window.addEventListener("message",c);var d={unsubscribe:function(){window.removeEventListener("message",c),n.delete(d)}};return n.add(d),d}var i=function(){n.forEach((function(e){return e.unsubscribe()}))},o=function(r,n){var a;null===(a=null===r||void 0===r?void 0:r.postMessage)||void 0===a||a.call(r,{from:l,id:e,payload:{name:n,data:arguments.length<=2?void 0:arguments[2]}},t||"*")};return{subscribeMessage:a,dispatchMessage:o,dispose:i}}},299:function(e,t,r){var n=r(175),a=r(372),i=r(177);e.exports=function(e){return i(e)?n(e,!0):a(e)}},300:function(e,t,r){var n=r(170);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},304:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(125);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){a=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}}(e,t)||Object(n.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},313:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return Yt}));var n=r(121),a=r(331),i=r(34),o=r(41),s=r(43),l=r(42),u=r(304),c=r(0),d=r.n(c),f=r(352),h=r(356),v=r.n(h),p=r(298),g=r(316),m=r(358),y=r.n(m),b=r(296),E=r.n(b),S=r(363),k=r(365),T=r(359),L=r.n(T),w=r(360),_=r.n(w),A=r(362),O=r.n(A);function R(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}var C={en:{"quality-auto":"Auto","quality-ld":"LD","quality-sd":"SD","quality-hd":"HD","quality-fhd":"FHD","action-enter-fullscreen":"Fullscreen","action-exit-fullscreen":"Exit Fullscreen","action-enter-page-fullscreen":"PageFullscreen","action-exit-page-fullscreen":"Exit PageFullscreen","action-enter-pip":"Picture in Picture","action-exit-pip":"Exit Picture in Picture","playback-rate":"Speed",replay:"Replay"},ja:{"quality-auto":"\u81ea\u52d5","quality-ld":"\u4f4e\u753b\u8cea","quality-sd":"\u6a19\u6e96\u753b\u8cea","quality-hd":"\u9ad8\u753b\u8cea","quality-fhd":"\u8d85\u9ad8\u753b\u8cea","action-enter-fullscreen":"\u5168\u753b\u9762","action-exit-fullscreen":"\u5168\u753b\u9762\u7d42\u4e86","action-enter-page-fullscreen":"\u5168\u753b\u9762\u30da\u30fc\u30b8","action-exit-page-fullscreen":"\u5168\u753b\u9762\u304b\u3089\u64a4\u9000\u3059\u308b","action-enter-pip":"\u30d4\u30af\u30c1\u30e3\u30fc\u30a4\u30f3\u30d4\u30af\u30c1\u30e3\u30fc","action-exit-pip":"\u30d4\u30af\u30c1\u30e3\u30fc\u30a4\u30f3\u30d4\u30af\u30c1\u30e3\u30fc\u7d42\u4e86","playback-rate":"\u518d\u751f\u901f\u5ea6",replay:"\u3082\u3046\u4e00\u56de\u898b\u308b"},"zh-Hans":{"quality-auto":"\u81ea\u52a8","quality-ld":"\u4f4e\u6e05","quality-sd":"\u6807\u6e05","quality-hd":"\u9ad8\u6e05","quality-fhd":"\u8d85\u6e05","action-enter-fullscreen":"\u5168\u5c4f","action-exit-fullscreen":"\u9000\u51fa\u5168\u5c4f","action-enter-page-fullscreen":"\u7f51\u9875\u5168\u5c4f","action-exit-page-fullscreen":"\u9000\u51fa\u7f51\u9875\u5168\u5c4f","action-enter-pip":"\u753b\u4e2d\u753b","action-exit-pip":"\u9000\u51fa\u753b\u4e2d\u753b","playback-rate":"\u500d\u901f",replay:"\u91cd\u65b0\u64ad\u653e"},"zh-Hant":{"quality-auto":"\u81ea\u52d5","quality-ld":"\u4f4e\u756b\u8cea","quality-sd":"\u6a19\u6e96\u756b\u8cea","quality-hd":"\u9ad8\u756b\u8cea","quality-fhd":"\u8d85\u9ad8\u756b\u8cea","action-enter-fullscreen":"\u5168\u87a2\u5e55","action-exit-fullscreen":"\u7d50\u675f\u5168\u87a2\u5e55","action-enter-page-fullscreen":"\u7db2\u9801\u5168\u5c4f","action-exit-page-fullscreen":"\u9000\u51fa\u7db2\u9801\u5168\u5c4f","action-enter-pip":"\u5b50\u6bcd\u756b\u9762","action-exit-pip":"\u95dc\u9589\u5b50\u6bcd\u756b\u9762","playback-rate":"\u500d\u901f",replay:"\u91cd\u65b0\u64ad\u653e"}},P=d.a.createContext({});P.displayName="VideoSourceContext";var x=["auto","ld","sd","hd","fhd"],D=g.e.isMobile,M=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={qualities:[],currentQuality:void 0,format:void 0,sources:[],expiration:0,dataKey:void 0,currentPlaybackRate:void 0},e.setCurrentQuality=function(t){var r=e.state.currentQuality;r!==t&&(e.setState({currentQuality:t}),e.props.onEvent(p.b.QUALITY_CHANGE,{prevQuality:r,quality:t}))},e.setCurrentPlaybackRate=function(t){var r=e.state.currentPlaybackRate;r!==t&&(e.setState({currentPlaybackRate:t}),e.props.onEvent(p.b.PLAYBACK_RATE_CHANGE,{prevRate:r,rate:t}))},e.getCurrentSrc=function(){var t=e.state,r=t.currentQuality,n=t.sources;if(0!==n.length)return(n.find((function(e){return e.quality===r}))||n[0]).source},e}return Object(o.a)(r,[{key:"render",value:function(){var e=this.state,t=e.qualities,r=e.currentQuality,n=e.format,a=e.dataKey,i=e.sources,o=e.currentPlaybackRate,s=this.props.playbackRates;return d.a.createElement(P.Provider,{value:{dataKey:a,qualities:t,playbackRates:s,format:n,sources:i,currentQuality:r,currentPlaybackRate:o,currentSrc:this.getCurrentSrc(),setCurrentQuality:this.setCurrentQuality,setCurrentPlaybackRate:this.setCurrentPlaybackRate}},this.props.children)}}]),r}(d.a.Component);M.getDerivedStateFromProps=function(e,t){var r=e.sources,n=e.id,a=e.defaultQuality,i=e.useAutoQuality,o=e.defaultPlaybackRate;if(!r)return null;var s=Object.values(r)[0],l=s.format,c=function(e,t){var r=new RegExp("\\b".concat(t,"=([^&]+)")).exec(e)||[];return Object(u.a)(r,2)[1]}(s.play_url,"expiration"),d="".concat(n,"-").concat(c);if(d==t.dataKey)return null;var f=function(e,t){var r=Object.keys(e).sort((function(e,t){return x.indexOf(e)-x.indexOf(t)}));return r.length>1?t?r.slice(0,1):r.filter((function(e){return"ld"!==e})):r}(r,D),h=function(e,t){return e.map((function(e){var r=t[e],n=r.play_url,a=R(r,["play_url"]);return Object.assign(Object.assign({},a),{source:n,quality:e})}))}(f,r);!i||D||"m3u8"!==l||f.includes("auto")||f.unshift("auto");var v=a||f[0];return{currentQuality:t.currentQuality||v,currentPlaybackRate:t.currentPlaybackRate||o,qualities:f,sources:h,format:l,expiration:Number(c),dataKey:d}};var I=function(e){var t=Object(c.useRef)(e);return t.current=e,Object(c.useRef)((function(){return t.current.apply(t,arguments)})).current},B="event",F="action",j=d.a.createContext({});j.displayName="InternalMessageContext";var N=d.a.createContext(null);N.displayName="MessageContext";var U=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(e){var n;Object(i.a)(this,r),(n=t.call(this,e)).emitEvent=function(e,t){var r,a;n.emitter.emit(e,{__type__:B,data:t}),null===(a=(r=n.props).onEvent)||void 0===a||a.call(r,e,t),n.props.enableCrossWindow&&n.crossWindowMessager.dispatchMessage(window.parent,e,t)},n.subscribeEvent=function(e,t){var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.__type__,n=e.data;r===B&&t(n)};return n.emitter.on(e,r),{unsubscribe:function(){return n.emitter.off(e,r)}}},n.dispatchAction=function(e,t){n.emitter.emit(e,{__type__:F,data:t})},n.subscribeAction=function(e,t){var r=function(e){var r=e.__type__,n=e.data;r===F&&t(n)};return n.emitter.on(e,r),{unsubscribe:function(){return n.emitter.off(e,r)}}},n.internalContextValue={emitEvent:n.emitEvent,subscribeAction:n.subscribeAction},n.externalContextValue={dispatchAction:n.dispatchAction,subscribeEvent:n.subscribeEvent},n.emitter=new y.a;var a=n.props,o=a.id,s=a.targetOrigin;return n.crossWindowMessager=Object(p.c)(o,s),n.props.dispatchRef&&(n.props.dispatchRef.current=n.externalContextValue.dispatchAction),n.props.messageContextRef&&(n.props.messageContextRef.current=n.externalContextValue),Promise.resolve().then((function(){n.emitEvent(p.b.SUBSCRIPTION_READY)})),n}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.props.enableCrossWindow&&this.crossWindowMessager.subscribeMessage((function(t,r){e.dispatchAction(t,r)}))}},{key:"componentWillUnmount",value:function(){this.props.dispatchRef&&(this.props.dispatchRef.current=void 0),this.props.messageContextRef&&(this.props.messageContextRef.current=void 0),this.crossWindowMessager.dispose(),this.emitter.removeAllListeners()}},{key:"render",value:function(){return d.a.createElement(j.Provider,{value:this.internalContextValue},d.a.createElement(N.Provider,{value:this.externalContextValue},this.props.children))}}]),r}(d.a.PureComponent);U.defaultProps={targetOrigin:"*"};var G=d.a.createContext({});G.displayName="ObjectFitContext";var V="function"===typeof ResizeObserver?function(e,t){var r=new ResizeObserver((function(e){return t(e[0].contentRect)}));return r.observe(e),function(){r.disconnect()}}:function(e,t){var r,n=window.MutationObserver||window.WebKitMutationObserver,a=function(){var n=e.getBoundingClientRect();!(r&&["left","top","width","height"].every((function(e){return r[e]===n[e]})))&&(r=n,t(n))},i=new n(E()(a,100));return i.observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),a(),window.addEventListener("resize",a),function(){i.disconnect(),window.removeEventListener("resize",a)}},H=d.a.createContext({isFullWidth:!1,updateVideoSize:function(){}});H.displayName="PositionContext";var W=f.StyleSheet.create({root:{position:"relative",width:"100%",height:"100%"}}),z=function(e){var t=e.children,r=Object(c.useRef)(null),n=Object(c.useState)(null),a=Object(u.a)(n,2),i=a[0],o=a[1],s=Object(c.useState)(!1),l=Object(u.a)(s,2),h=l[0],v=l[1],p=Object(c.useState)({videoWidth:0,videoHeight:0}),g=Object(u.a)(p,2),m=g[0],y=g[1],b=I((function(){var e,t=m.videoWidth,r=m.videoHeight;t&&r&&o((e=r,"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='".concat(t,"' height='").concat(e,"'></svg>")))})),E=I((function(){var e=m.videoWidth,t=m.videoHeight;if(e&&t&&r.current){var n=r.current.getBoundingClientRect(),a=n.width/n.height-e/t<=.01;a!==h&&v(a)}}));Object(c.useEffect)((function(){if(r.current)return V(r.current,E)}),[r,E]),Object(c.useEffect)((function(){b()}),[b]);var S=function(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){t.current=e}),[e]),t.current}(m);Object(c.useEffect)((function(){if(S){var e=S.videoWidth,t=S.videoHeight,r=m.videoWidth,n=m.videoHeight;e===r&&t===n||(requestAnimationFrame(E),b())}}),[S,b,E,m]);var k=Object(c.useMemo)((function(){return{isFullWidth:h,helperImageSrc:i,updateVideoSize:y}}),[i,h]);return d.a.createElement(H.Provider,{value:k},d.a.createElement("div",{className:Object(f.css)(W.root),ref:r},t))},q=function(e){var t=e.initialObjectFit,r=void 0===t?"contain":t,n=e.children,a=Object(c.useState)(r),i=Object(u.a)(a,2),o=i[0],s=i[1],l=Object(c.useMemo)((function(){return{objectFit:o,setObjectFit:s}}),[o,s]);return Object(c.useEffect)((function(){s(r)}),[r]),d.a.createElement(G.Provider,{value:l},n)},K=d.a.createContext(C.en);K.displayName="LocaleContext";var Y=function(e){var t=e.locale,r=e.localeConfig,n=e.children,a=Object(c.useMemo)((function(){return function(e,t){var r=C[e],n=null===t||void 0===t?void 0:t[e];return n?Object.assign({},r,n):r}(t,r)}),[t,r]);return d.a.createElement(K.Provider,{value:a},n)},Q=function(e){var t=e.name,r=e.style,n=void 0===r?"text":r;return d.a.createElement(K.Consumer,null,(function(e){return"object"===typeof e[t]?e[t][n]:e[t]}))},X=f.StyleSheet.create({root:{display:"inline-block",width:"1.5em",height:"1.5em"},svg:{display:"block",width:"100%",height:"100%",fill:"currentColor"}});function Z(e){var t=e.icon,r=e.styles,n=Object(c.cloneElement)(t,{className:Object(f.css)(X.svg)});return d.a.createElement("span",{className:Object(f.css)(X.root,r)},n)}var J=d.a.createElement("svg",{viewBox:"0 0 20 20"},d.a.createElement("path",{d:"M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm-.034 2.966c1.95 0 1.485 1.807 1.485 2.21 0 .116-.784 7.79-.784 7.79h-1.4S8.48 5.344 8.48 5.23c0-.417-.462-2.264 1.486-2.264zm1.057 13.522c-.294.287-.647.43-1.056.43-.41 0-.762-.142-1.058-.43-.296-.286-.444-.643-.444-1.07 0-.41.148-.762.443-1.057.294-.294.647-.44 1.057-.44.41 0 .762.142 1.056.43.296.286.443.643.443 1.07 0 .426-.147.782-.443 1.068z"})),$=d.a.createElement("svg",{viewBox:"0 0 72 72"},d.a.createElement("g",{fill:"none",fillRule:"evenodd"},d.a.createElement("circle",{cx:"36",cy:"36",r:"36",fill:"#FFF",fillOpacity:".95"}),d.a.createElement("path",{fill:"#444",fillRule:"nonzero",d:"M41.143 22.5h5.786v27h-5.786zM25.071 22.5h5.786v27h-5.786z"}))),ee=d.a.createElement("svg",{viewBox:"0 0 72 72"},d.a.createElement("g",{fill:"none",fillRule:"evenodd"},d.a.createElement("circle",{cx:"36",cy:"36",r:"36",fill:"#FFF",fillOpacity:".95"}),d.a.createElement("path",{fill:"#444",fillRule:"nonzero",d:"M50.8350169,37.0602664 L29.4767217,49.9693832 C28.900608,50.3175908 28.1558807,50.1251285 27.8133266,49.5395068 C27.701749,49.3487566 27.6428571,49.1309436 27.6428571,48.9090213 L27.6428571,23.0907876 C27.6428571,22.4094644 28.1862113,21.8571429 28.8564727,21.8571429 C29.0747919,21.8571429 29.2890685,21.9170066 29.4767217,22.0304257 L50.8350169,34.9395425 C51.4111306,35.28775 51.6004681,36.0447682 51.257914,36.6303899 C51.154433,36.8072984 51.0090531,36.9550776 50.8350169,37.0602664 Z"}))),te=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("g",{fill:"none",fillRule:"evenodd"},d.a.createElement("rect",{width:"24",height:"24"}),d.a.createElement("path",{fill:"#FFF",d:"M12.4049973,3.62840003 C17.1876069,3.84468032 21,7.87252205 21,12.8096305 C21,17.8853314 16.9705627,22 12,22 C7.02943725,22 3,17.8853314 3,12.8096305 C3,12.0229797 3.624497,11.3852732 4.39485308,11.3852732 C5.16520917,11.3852732 5.78970616,12.0229797 5.78970616,12.8096305 C5.78970616,16.3120298 8.57014942,19.1512855 12,19.1512855 C15.4298506,19.1512855 18.2102938,16.3120298 18.2102938,12.8096305 C18.2102938,9.44617464 15.6460805,6.69429107 12.4049973,6.4812447 L12.4049973,8.30324795 C12.4049973,8.71101381 12.0954942,9.04157334 11.7137028,9.04157334 C11.5841406,9.04157334 11.457186,9.00268616 11.3473174,8.92934663 L6.42999892,5.64693477 C6.10624047,5.4308193 6.00781868,4.97530916 6.21016772,4.62952441 C6.26580359,4.53445089 6.34098153,4.45415835 6.42999892,4.3947374 L11.3473174,1.11232554 C11.6710759,0.896210069 12.0975703,1.00132779 12.2999193,1.34711255 C12.3685872,1.46445578 12.4049973,1.60004749 12.4049973,1.73842422 L12.4049973,3.62840003 Z"}))),re=2*Math.PI*30.5,ne={"0%":{strokeDashoffset:re,transform:"rotate(0deg)"},"50%":{strokeDashoffset:re/4,transform:"rotate(90deg)"},"100%":{strokeDashoffset:re,transform:"rotate(360deg)"}},ae=f.StyleSheet.create({root:{width:"4em",height:"4em"},svg:{display:"block",width:"100%",height:"100%",animationName:{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}},animationDuration:"2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},circle:{cx:"50%",cy:"50%",r:30.5,strokeDasharray:re,stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",fill:"none",transformOrigin:"center",animationName:ne,animationDuration:"1.5s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}}),ie=function(){return d.a.createElement("div",{className:Object(f.css)(ae.root)},d.a.createElement("svg",{viewBox:"0 0 64 64",className:Object(f.css)(ae.svg)},d.a.createElement("circle",{className:Object(f.css)(ae.circle)})))},oe=[[p.b.PLAY,"onPlay"],[p.b.PLAYING,"onPlaying"],[p.b.PAUSE,"onPause"],[p.b.ENDED,"onEnded"],[p.b.TIMEUPDATE,"onTimeUpdate"],[p.b.ERROR,"onError"],[p.b.WAITING,"onWaiting"]];function se(e){var t,r=e.currentTarget,n=r.currentTime,a=r.duration,i=r.error;return{currentTime:n,duration:a,error:(t=i,t?{code:t.code,message:t.message,name:t.name}:null)}}var le=d.a.forwardRef((function(e,t){var r=Object(c.useContext)(H).updateVideoSize,n=Object(c.useContext)(G).objectFit,a=Object(c.useContext)(j).emitEvent,i=Object(c.useRef)(e);Object(c.useEffect)((function(){i.current=e}),[e]);var o=Object(c.useMemo)((function(){var e={};return oe.forEach((function(t){var r=Object(u.a)(t,2),n=r[0],o=r[1];e[o]=function(e){a(n,se(e));for(var t=i.current[o],r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];return null===t||void 0===t?void 0:t.apply(void 0,[e].concat(s))}})),e}),[a]),s=Object(c.useCallback)((function(e){var t,n,a=e.currentTarget;if(a){var o=a.videoWidth,s=a.videoHeight;r({videoWidth:o,videoHeight:s})}null===(n=(t=i.current).onLoadedMetadata)||void 0===n||n.call(t,e)}),[r]),l=e.Video,f=R(e,["Video"]);return d.a.createElement(l,Object.assign({},f,o,{ref:t,style:{objectFit:n},onLoadedMetadata:s}))})),ue={pluginName:"native",VideoComponent:function(e){var t=e.onRef,r=(e.paused,e.currentQuality,e.useAutoQuality,e.sources,R(e,["onRef","paused","currentQuality","useAutoQuality","sources"]));return d.a.createElement("video",Object.assign({},r,{ref:t}))},willHandleSrcChange:!1};var ce=L()((function(e,t){return"m3u8"===e&&(null===S.a||void 0===S.a?void 0:S.a.VideoComponent)&&Object(g.b)()&&!Object(g.a)()?S.a:"mp4"===e&&(null===k.a||void 0===k.a?void 0:k.a.VideoComponent)&&Object(g.b)()&&t?k.a:ue}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return String(t)})),de=f.StyleSheet.create({root:{display:"block",width:"100%",height:"100%"}}),fe=g.e.isMobile,he=function(e){return e&&"AbortError"===e.name||e instanceof MediaError&&e.code===MediaError.MEDIA_ERR_ABORTED},ve=function(e){return e&&"NotAllowedError"===e.name},pe=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).isMetadataLoaded=!1,e.pendingAction=null,e.loading=!1,e.isSwitchDefinition=!1,e.root=null,e.safeExecute=function(t){void 0!==e.playPromise?e.playPromise.then((function(){t()})):t()},e.handleMetadataLoaded=function(){e.isMetadataLoaded=!0,e.applyPendingAction(),e.isSwitchDefinition&&(e.isSwitchDefinition=!1,e.setRate(e.props.currentPlaybackRate),e.props.onEvent(p.b.CHANGE_QUALITY_SUCCESS,e.props.currentQuality))},e.handleDurationChange=function(){var t=e.props.onDurationChange;t&&t(e.root.duration)},e.handleLoadedData=function(){var t=e.props.onLoadedData;t&&t()},e.handleWaiting=function(){e.loading||(e.loading=!0),e.props.onWaiting()},e.handlePlaying=function(){e.loading&&(e.loading=!1),e.props.onPlaying()},e.handleTimeUpdate=function(t){var r=e.props,n=r.onTimeUpdate,a=r.paused;if(e.disposeTimer(),!a&&!e.loading){var i=(e.root||{}).currentTime;if(n&&i)n(i,"number"===typeof t),fe||(e._playTimer=window.requestAnimationFrame(e.handleTimeUpdate))}},e.handleProgress=function(){for(var t=e.props.onProgress,r=e.root.buffered,n=[],a=0;a<r.length;a++)n.push({start:r.start(a),end:r.end(a)});t&&t(n)},e.handleError=function(){var t=e.root||{},r=t.error,n=t.currentTime;if(r){var a=r.code,i=r.message;g.c.debug("Error: %o",{code:a,message:i,name:r.name}),ve(r)||he(r)||e.props.onEvent(p.b.PLAY_FAILED,{currentTime:n}),e.isSwitchDefinition&&(e.isSwitchDefinition=!1,e.setRate(e.props.currentPlaybackRate),e.props.onEvent(p.b.CHANGE_QUALITY_FAIL,e.props.currentQuality)),e.props.onError(r)}},e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){this.root.volume=Math.pow(this.props.volume,2)}},{key:"getSnapshotBeforeUpdate",value:function(){return{paused:this.root.paused,currentTime:this.root.currentTime}}},{key:"componentDidUpdate",value:function(e,t,r){var n=this,a=this.props,i=a.src,o=a.paused,s=a.volume,l=a.format,u=a.useMSE,c=a.currentPlaybackRate,d=a.currentQuality,f=a.onEvent;e.src&&i!==e.src&&(this.isSwitchDefinition=!0,f(p.b.CHANGE_QUALITY_START,d),ce(l,u).willHandleSrcChange||this.safeExecute((function(){n.isMetadataLoaded=!1,n.seek(r.currentTime),r.paused||n.play()})));o!==e.paused&&this.root&&o!==this.root.paused&&(o?this.pause():this.play()),this.root&&this.root.volume!==Math.pow(s,2)&&!fe&&(this.root.volume=Math.pow(s,2)),e.currentPlaybackRate.value!==c.value&&this.setRate(c)}},{key:"pending",value:function(e){this.pendingAction=Object.assign(Object.assign({},this.pendingAction),e)}},{key:"applyPendingAction",value:function(){if(this.pendingAction){var e=this.pendingAction;this.pendingAction=null,void 0!==e.currentTime&&this.seek(e.currentTime),void 0!==e.paused&&this.root&&e.paused!==this.root.paused&&(e.paused?this.pause():this.play())}}},{key:"setRate",value:function(e){var t=this;fe||this.isMetadataLoaded?this.safeExecute((function(){return t.root.playbackRate=Number(e.value)})):this.pending({paused:!0})}},{key:"play",value:function(){var e,t=this;if(!fe&&!this.isMetadataLoaded)return this.pending({paused:!1}),void((null===(e=this.root)||void 0===e?void 0:e.load)&&this.safeExecute((function(){return t.root.load()})));this.playPromise=Promise.resolve(this.root.play()).catch((function(e){var r=t.props.onError;r&&r(e)}))}},{key:"pause",value:function(){var e=this;fe||this.isMetadataLoaded?this.safeExecute((function(){return e.root.pause()})):this.pending({paused:!0})}},{key:"seek",value:function(e){var t;Number.isFinite(e)&&(this.isMetadataLoaded?(null===(t=this.root)||void 0===t?void 0:t.duration)&&(this.root.currentTime=e):this.pending({currentTime:e}))}},{key:"disposeTimer",value:function(){window.cancelAnimationFrame(this._playTimer)}},{key:"render",value:function(){var e=this,t=this.props,r=t.src,n=t.controls,a=t.loop,i=t.paused,o=t.volume,s=t.onPlay,l=t.onPause,u=t.onEnded,c=t.onLoadedData,h=t.onSeeking,v=t.onSeeked,p=t.format,g=t.useMSE,m=t.sources,y=t.currentQuality,b=ce(p,g).VideoComponent;return d.a.createElement(le,{onRef:function(t){e.root=t},className:Object(f.css)(de.root),preload:"metadata",playsInline:!0,"webkit-playsinline":"","x-webkit-airplay":"deny",muted:!o,controls:n,loop:a,src:r,onPlay:s,onPause:l,onEnded:u,onLoadedData:c,onSeeking:h,onSeeked:v,onClick:this.handleClick,onLoadedMetadata:this.handleMetadataLoaded,onError:this.handleError,onDurationChange:this.handleDurationChange,onTimeUpdate:this.handleTimeUpdate,onProgress:this.handleProgress,onWaiting:this.handleWaiting,onPlaying:this.handlePlaying,paused:i,sources:m,currentQuality:y,Video:b})}}]),r}(c.Component);pe.defaultProps={paused:!0,volume:.5};var ge=d.a.forwardRef((function(e,t){return d.a.createElement(P.Consumer,null,(function(r){var n=r.currentSrc,a=r.sources,i=r.currentQuality,o=r.format,s=r.currentPlaybackRate;return d.a.createElement(pe,Object.assign({ref:t},e,{src:n,format:o,sources:a,currentQuality:i,currentPlaybackRate:s}))}))})),me=13,ye=32,be=27,Ee=37,Se=38,ke=39,Te=40,Le=48,we=49,_e=50,Ae=51,Oe=52,Re=53,Ce=54,Pe=55,xe=56,De=57,Me=70,Ie=74,Be=75,Fe=76,je=77,Ne=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M19.7180574,15 C20.1638168,15 20.3254599,15.0464128 20.4884229,15.1335664 C20.6513858,15.2207199 20.7792801,15.3486142 20.8664336,15.5115771 C20.9535872,15.6745401 21,15.8361832 21,16.2819426 L21,19.7180574 C21,20.1638168 20.9535872,20.3254599 20.8664336,20.4884229 C20.7792801,20.6513858 20.6513858,20.7792801 20.4884229,20.8664336 C20.3254599,20.9535872 20.1638168,21 19.7180574,21 L16.2819426,21 C15.8361832,21 15.6745401,20.9535872 15.5115771,20.8664336 C15.3486142,20.7792801 15.2207199,20.6513858 15.1335664,20.4884229 C15.0464128,20.3254599 15,20.1638168 15,19.7180574 L15,16.2819426 C15,15.8361832 15.0464128,15.6745401 15.1335664,15.5115771 C15.2207199,15.3486142 15.3486142,15.2207199 15.5115771,15.1335664 C15.6745401,15.0464128 15.8361832,15 16.2819426,15 L19.7180574,15 Z M18.5,4 C19.3284271,4 20,4.67157288 20,5.5 L20,11.75 C20,11.8880712 19.8880712,12 19.75,12 L18.25,12 C18.1119288,12 18,11.8880712 18,11.75 L18,6.5 C18,6.24358208 17.8069799,6.03224642 17.5583106,6.00336387 L17.5,6 L6.5,6 C6.24358208,6 6.03224642,6.1930201 6.00336387,6.44168944 L6,6.5 L6,17.5 C6,17.7564179 6.1930201,17.9677536 6.44168944,17.9966361 L6.5,18 L11.75,18 C11.8880712,18 12,18.1119288 12,18.25 L12,19.75 C12,19.8880712 11.8880712,20 11.75,20 L5.5,20 C4.67157288,20 4,19.3284271 4,18.5 L4,5.5 C4,4.67157288 4.67157288,4 5.5,4 L18.5,4 Z M12.263324,13.6777091 L9.53508966,10.956021 L9.55615206,13.2225752 C9.55502994,13.3470231 9.46566931,13.4482773 9.34885743,13.4683645 L9.30388492,13.4719793 L7.79658322,13.4583417 C7.67542934,13.4572455 7.57490537,13.3702653 7.5531943,13.2554476 L7.54886064,13.2111995 L7.49923911,7.74790313 C7.50035209,7.62546574 7.5897117,7.52443494 7.70652348,7.50437256 L7.75149597,7.50076089 L13.2230869,7.55026617 C13.3442408,7.55136234 13.4447648,7.6383426 13.4664758,7.75316028 L13.4708095,7.79740841 L13.4844791,9.30570263 C13.4833661,9.42814002 13.3940065,9.52917082 13.2771947,9.5492332 L13.2322222,9.55284487 L10.9362217,9.53206969 L13.6775376,12.2668086 C13.7751687,12.364211 13.7751687,12.5221314 13.6775376,12.6195338 L12.6168774,13.6777091 C12.5192463,13.7751115 12.3609551,13.7751115 12.263324,13.6777091 Z"})),Ue=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M20,10 L20,5 C20,4.44771525 19.5490248,4 19.009222,4 L14,4 L14,6 L18,6 L18,10 L20,10 Z M19.7115371,19.7068284 C19.8902571,19.5277733 20,19.2813055 20,19.009222 L20,14 L18,14 L18,18 L14,18 L14,20 L19.009222,20 C19.2776249,20 19.5240668,19.8893106 19.7040291,19.7101145 L19.7115371,19.7068284 Z M6,18 L6,14 L4,14 L4,19.009222 C4,19.2813055 4.10974288,19.5277733 4.28846285,19.7068284 C4.47593315,19.8893106 4.72237506,20 4.99077797,20 L10,20 L10,18 L6,18 Z M4.28846285,4.29317155 C4.10974288,4.47222673 4,4.71869448 4,4.99077797 L4,10 L6,10 L6,6 L10,6 L10,4 L4.99077797,4 C4.72237506,4 4.47593315,4.11068941 4.29597088,4.28988548 L4.28846285,4.29317155 Z"})),Ge=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M7.38001507,9.5 L5,9.5 L5,12.0119396 L5,14.5238791 L8.33098415,14.5238791 L8.33098415,14.5238791 C8.39017333,14.520451 8.4497727,14.5223174 8.50904598,14.5296109 C8.72475585,14.5524598 8.91816198,14.6424266 9.06920843,14.7779841 L13,17.4293365 L13,15.1199849 L7.38001507,9.5 Z M15,17.1199849 L15,19.251289 C15,19.8045373 14.5522847,20.25 14,20.25 C13.98423,20.25 13.9685502,20.2496405 13.9529683,20.2489292 C13.7472793,20.2584936 13.5372091,20.2041245 13.3535806,20.0802655 L8.08102098,16.5238791 L4.00000001,16.5238791 C3.71994909,16.5238791 3.46994918,16.4119504 3.29196292,16.2310404 C3.11117675,16.0497507 3,15.7991447 3,15.5223056 L3,12.0119396 L3,8.50157356 C3,8.2247344 3.11117675,7.97412842 3.29196292,7.79283868 C3.46994918,7.61192872 3.71994909,7.5 4.00000001,7.5 L5.38001507,7.5 L3.38382011,5.50380504 C2.99233448,5.1123194 2.98883249,4.48109777 3.38207944,4.08785081 C3.77260374,3.69732652 4.3999302,3.691488 4.79803367,4.08959148 L18.936688,18.2282458 C19.3281736,18.6197314 19.3316756,19.250953 18.9384286,19.6442 C18.5479043,20.0347243 17.9205779,20.0405628 17.5224744,19.6424593 L15,17.1199849 Z M10.792179,8.08373676 L9.35149599,6.64305379 L13.3535806,3.94361361 C13.5372091,3.81975463 13.7472793,3.76538554 13.9529683,3.77494994 C13.9685502,3.77423867 13.98423,3.77387913 14,3.77387913 C14.5522847,3.77387913 15,4.21934183 15,4.77259008 L15,12.0119396 L15,12.2915578 L13,10.2915578 L13,6.59454265 L10.792179,8.08373676 Z M18.0173138,15.3088716 C18.8917509,14.408489 19.4301566,13.1799808 19.4301566,11.8257212 C19.4301566,10.2214787 18.6746368,8.79369726 17.5,7.87877967 L17.5067574,7.87009164 C17.2041341,7.69816923 17,7.37292366 17,7 C17,6.44771525 17.4477153,6 18,6 C18.2836948,6 18.5397977,6.11813499 18.721799,6.30789526 L18.7279374,6.30000305 C20.3724289,7.58088767 21.4301566,9.57978168 21.4301566,11.8257212 C21.4301566,13.7322659 20.6679517,15.4607882 19.431636,16.7231938 L18.0173138,15.3088716 Z"})),Ve=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M9,5 C10,5 10,6 10,6 C10,6 10,17 10,18 C10,19 9,19 9,19 L7,19 C6,19 6,18 6,18 L6,6 C6,5 7,5 7,5 C7,5 8,5 9,5 Z M17,5 C18,5 18,6 18,6 C18,6 18,17 18,18 C18,19 17,19 17,19 L15,19 C14,19 14,18 14,18 L14,6 C14,5 15,5 15,5 C15,5 16,5 17,5 Z"})),He=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M19.7180574,15 C20.1638168,15 20.3254599,15.0464128 20.4884229,15.1335664 C20.6513858,15.2207199 20.7792801,15.3486142 20.8664336,15.5115771 C20.9535872,15.6745401 21,15.8361832 21,16.2819426 L21,19.7180574 C21,20.1638168 20.9535872,20.3254599 20.8664336,20.4884229 C20.7792801,20.6513858 20.6513858,20.7792801 20.4884229,20.8664336 C20.3254599,20.9535872 20.1638168,21 19.7180574,21 L16.2819426,21 C15.8361832,21 15.6745401,20.9535872 15.5115771,20.8664336 C15.3486142,20.7792801 15.2207199,20.6513858 15.1335664,20.4884229 C15.0464128,20.3254599 15,20.1638168 15,19.7180574 L15,16.2819426 C15,15.8361832 15.0464128,15.6745401 15.1335664,15.5115771 C15.2207199,15.3486142 15.3486142,15.2207199 15.5115771,15.1335664 C15.6745401,15.0464128 15.8361832,15 16.2819426,15 L19.7180574,15 Z M18.5,4 C19.3284271,4 20,4.67157288 20,5.5 L20,11.75 C20,11.8880712 19.8880712,12 19.75,12 L18.25,12 C18.1119288,12 18,11.8880712 18,11.75 L18,6.5 C18,6.24358208 17.8069799,6.03224642 17.5583106,6.00336387 L17.5,6 L6.5,6 C6.24358208,6 6.03224642,6.1930201 6.00336387,6.44168944 L6,6.5 L6,17.5 C6,17.7564179 6.1930201,17.9677536 6.44168944,17.9966361 L6.5,18 L11.75,18 C11.8880712,18 12,18.1119288 12,18.25 L12,19.75 C12,19.8880712 11.8880712,20 11.75,20 L5.5,20 C4.67157288,20 4,19.3284271 4,18.5 L4,5.5 C4,4.67157288 4.67157288,4 5.5,4 L18.5,4 Z M8.98667598,7.57381266 L11.7149103,10.2955008 L11.6938479,8.02894655 C11.6949701,7.90449864 11.7843307,7.80324445 11.9011426,7.78315725 L11.9461151,7.77954248 L13.4534168,7.79318008 C13.5745707,7.79427625 13.6750946,7.88125651 13.6968057,7.99607419 L13.7011394,8.04032232 L13.7507609,13.5036187 C13.7496479,13.626056 13.6602883,13.7270868 13.5434765,13.7471492 L13.498504,13.7507609 L8.0269131,13.7012556 C7.90575922,13.7001594 7.80523525,13.6131792 7.78352418,13.4983615 L7.77919052,13.4541134 L7.76552089,11.9458192 C7.76663388,11.8233818 7.85599349,11.722351 7.97280526,11.7022886 L8.01777775,11.6986769 L10.3137783,11.7194521 L7.57246241,8.98471315 C7.47483134,8.8873108 7.47483134,8.72939038 7.57246241,8.63198803 L8.63312259,7.57381266 C8.73075366,7.4764103 8.8890449,7.4764103 8.98667598,7.57381266 Z"})),We=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M8.03610236,19.7012935 C6.93281899,20.3993842 6,19.8347521 6,18.4154722 L6,5.59575582 C6,4.14567779 6.91151094,3.59901121 8.03610236,4.30993442 L18.1645278,10.7185093 C19.2678112,11.4166 19.2891193,12.5817954 18.1645278,13.2927186 L8.03610236,19.7012935 Z"})),ze=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M14.2884629,14.2931716 C14.1097429,14.4722267 14,14.7186945 14,14.990778 L14,20 L16,20 L16,16 L20,16 L20,14 L14.990778,14 C14.7223751,14 14.4759332,14.1106894 14.2959709,14.2898855 L14.2884629,14.2931716 Z M16,8 L16,4 L14,4 L14,9.00922203 C14,9.28130552 14.1097429,9.52777327 14.2884629,9.70682845 C14.4759332,9.88931059 14.7223751,10 14.990778,10 L20,10 L20,8 L16,8 Z M8,16 L8,20 L10,20 L10,14.990778 C10,14.7186945 9.89025712,14.4722267 9.71153715,14.2931716 C9.52406685,14.1106894 9.27762494,14 9.00922203,14 L4,14 L4,16 L8,16 L8,16 Z M9.71153715,9.70682845 C9.89025712,9.52777327 10,9.28130552 10,9.00922203 L10,4 L8,4 L8,8 L4,8 L4,10 L9.00922203,10 C9.27762494,10 9.52406685,9.88931059 9.70402912,9.71011452 L9.71153715,9.70682845 Z"})),qe=d.a.createElement("svg",{viewBox:"0 0 24 24"},d.a.createElement("path",{d:"M5,12.0119396 L5,14.5238791 L8.33098415,14.5238791 L8.33098415,14.5238791 C8.39017333,14.520451 8.4497727,14.5223174 8.50904598,14.5296109 C8.72475585,14.5524598 8.91816198,14.6424266 9.06920843,14.7779841 L13,17.4293365 L13,12.0119396 L13,6.59454265 L9.06920843,9.24589504 C8.91816198,9.38145255 8.72475585,9.47141933 8.50904598,9.49426822 C8.4497727,9.50156175 8.39017333,9.5034281 8.33098415,9.5 L8.33098415,9.5 L5,9.5 L5,12.0119396 Z M3,12.0119396 L3,8.50157356 C3,8.2247344 3.11117675,7.97412842 3.29196292,7.79283868 C3.46994918,7.61192872 3.71994909,7.5 4.00000001,7.5 L8.08102098,7.5 L13.3535806,3.94361361 C13.5372091,3.81975463 13.7472793,3.76538554 13.9529683,3.77494994 C13.9685502,3.77423867 13.98423,3.77387913 14,3.77387913 C14.5522847,3.77387913 15,4.21934183 15,4.77259008 L15,12.0119396 L15,19.251289 C15,19.8045373 14.5522847,20.25 14,20.25 C13.98423,20.25 13.9685502,20.2496405 13.9529683,20.2489292 C13.7472793,20.2584936 13.5372091,20.2041245 13.3535806,20.0802655 L8.08102098,16.5238791 L4.00000001,16.5238791 C3.71994909,16.5238791 3.46994918,16.4119504 3.29196292,16.2310404 C3.11117675,16.0497507 3,15.7991447 3,15.5223056 L3,12.0119396 Z M17.5059844,15.7803571 L17.5,15.7726628 C18.6746368,14.8577452 19.4301566,13.4299638 19.4301566,11.8257212 C19.4301566,10.2214787 18.6746368,8.79369726 17.5,7.87877967 L17.5067574,7.87009164 C17.2041341,7.69816923 17,7.37292366 17,7 C17,6.44771525 17.4477153,6 18,6 C18.2836948,6 18.5397977,6.11813499 18.721799,6.30789526 L18.7279374,6.30000305 C20.3724289,7.58088767 21.4301566,9.57978168 21.4301566,11.8257212 C21.4301566,14.0716608 20.3724289,16.0705548 18.7279374,17.3514394 L18.7211832,17.3427554 C18.5392202,17.5321404 18.283375,17.6500092 18,17.6500092 C17.4477153,17.6500092 17,17.2022939 17,16.6500092 C17,16.2774031 17.2037866,15.9523939 17.5059844,15.7803571 L17.5059844,15.7803571 Z"})),Ke=d.a.createElement("svg",{viewBox:"0 -4 16 24"},d.a.createElement("path",{d:"M15.9964 0.207284C15.9763 0.0904726 15.8753 0.00111298 15.7529 0L10.2896 0.0496215L10.2453 0.0539552C10.1305 0.0756663 10.0435 0.17619 10.0424 0.297344L10.0288 1.80465L10.0324 1.84962C10.0525 1.96643 10.1537 2.05579 10.2782 2.05691L12.5447 2.03585L9.82305 4.76408C9.72565 4.86172 9.72565 5.02001 9.82305 5.11764L10.8812 6.1783C10.9786 6.27593 11.1365 6.27593 11.234 6.1783L13.9687 3.43698L13.9479 5.73298L13.9515 5.77796C13.9716 5.89477 14.0726 5.98413 14.1951 5.98524L15.7034 5.97157L15.7476 5.96724C15.8624 5.94553 15.9494 5.845 15.9505 5.72385L16 0.252257L15.9964 0.207284ZM0.00361156 15.7942C0.0236739 15.911 0.124705 16.0004 0.247142 16.0015L5.71044 15.9519L5.75469 15.9476C5.8695 15.9259 5.95648 15.8253 5.95758 15.7042L5.97122 14.1969L5.9676 14.1519C5.94752 14.0351 5.84626 13.9457 5.72181 13.9446L3.45526 13.9657L6.17695 11.2374C6.27435 11.1398 6.27435 10.9815 6.17695 10.8839L5.11877 9.82322C5.02137 9.72559 4.86345 9.72559 4.76605 9.82322L2.03131 12.5645L2.05208 10.2685L2.04847 10.2236C2.02841 10.1068 1.92738 10.0174 1.80494 10.0163L0.296648 10.03L0.252399 10.0343C0.137582 10.056 0.0506014 10.1565 0.0495052 10.2777L0 15.7493L0.00361156 15.7942Z"})),Ye=d.a.createElement("svg",{viewBox:"0 -4 16 24"},d.a.createElement("path",{d:"M9.75361 6.04424C9.77367 6.16105 9.87471 6.25041 9.99714 6.25152L15.4604 6.2019L15.5047 6.19757C15.6195 6.17586 15.7065 6.07533 15.7076 5.95418L15.7212 4.44688L15.7176 4.4019C15.6975 4.28509 15.5963 4.19573 15.4718 4.19461L13.2053 4.21567L15.9269 1.48744C16.0244 1.38981 16.0244 1.23151 15.9269 1.13388L14.8688 0.0732233C14.7714 -0.0244078 14.6135 -0.0244078 14.516 0.0732233L11.7813 2.81454L11.8021 0.518539L11.7985 0.473566C11.7784 0.356754 11.6774 0.267395 11.5549 0.266282L10.0466 0.279951L10.0024 0.284285C9.88758 0.305996 9.8006 0.40652 9.79951 0.527674L9.75 5.99926L9.75361 6.04424ZM6.24639 9.95728C6.22633 9.84047 6.1253 9.75111 6.00286 9.75L0.539561 9.79962L0.495313 9.80396C0.380496 9.82567 0.293515 9.92619 0.292419 10.0473L0.278782 11.5546L0.282396 11.5996C0.302484 11.7164 0.403738 11.8058 0.528186 11.8069L2.79474 11.7859L0.0730518 14.5141C-0.0243506 14.6117 -0.0243506 14.77 0.0730518 14.8676L1.13123 15.9283C1.22863 16.0259 1.38655 16.0259 1.48395 15.9283L4.21869 13.187L4.19792 15.483L4.20153 15.528C4.22159 15.6448 4.32262 15.7341 4.44506 15.7352L5.95335 15.7216L5.9976 15.7172C6.11242 15.6955 6.1994 15.595 6.20049 15.4738L6.25 10.0023L6.24639 9.95728Z"})),Qe=f.StyleSheet.create({root:{padding:"0 0.5em"},rootTop:{height:"2em"},rootBottom:{height:"2.5em",display:"flex",alignItems:"center",justifyContent:"space-between"},rootBottomLeft:{display:"flex"},rootBottomRight:{display:"flex"},button:{display:"block",width:"2.5em",height:"2.5em",margin:0,padding:"0.5em",border:"none",borderRadius:0,fontSize:"inherit",color:"rgba(255, 255, 255, 0.7)",background:"none",cursor:"pointer",transition:"color 300ms",":hover":{color:"#fff"},":focus":{outline:"none"}},menuContainer:{position:"relative"},menu:{position:"absolute",left:"50%",bottom:"100%",visibility:"hidden",opacity:0,transform:"translateX(-50%)",transition:"visibility 300ms, opacity 300ms",backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:"4px"},menuShown:{visibility:"visible",opacity:1},timeline:{flex:1},timelineHolder:{flex:1},time:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 0.5em",width:"100px",fontSize:"0.875em",color:"rgba(255, 255, 255, 0.9)"},labelButton:{width:"auto",lineHeight:1.5},labelButtonText:{fontSize:"0.875em"},qualityMenu:{padding:"0.25em 0"},qualityMenuItem:{display:"block",width:"100%",boxSizing:"border-box",height:"2em",margin:0,padding:"0 0.75em",border:"none",borderRadius:0,fontSize:"0.875em",lineHeight:2,whiteSpace:"nowrap",color:"rgba(255, 255, 255, 0.5)",background:"none",cursor:"pointer",transition:"color 300ms, background-color 300ms",":hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"},":focus":{outline:"none"}},qualityMenuActiveItem:{color:"#fff"},fullScreenTooltip:{pointerEvents:"none"},fullScreenedTime:{width:"150px"},fullScreenTooltipWide:{left:"30%"},pipTooltip:{pointerEvents:"none"}}),Xe=function(e){var t=e.icon,r=e.label,n=R(e,["icon","label"]);return d.a.createElement("button",Object.assign({},n,{className:Object(f.css)(Qe.button,r?Qe.labelButton:null),type:"button"}),t&&d.a.createElement(Z,{icon:t}),r&&d.a.createElement("span",{className:Object(f.css)(Qe.labelButtonText)},r))},Ze=function(e){var t=e.isPlaying,r=e.onClick;return d.a.createElement("div",null,d.a.createElement(Xe,{icon:t?Ve:We,onClick:r}))};function Je(e,t){return t?"".concat(100*_()(e/t,0,1),"%"):"0%"}var $e=f.StyleSheet.create({root:{position:"absolute",display:"flex",top:0,bottom:0,width:"100%"},item:{position:"absolute",width:12,height:"100%",transform:"translate(-50%)",":hover":{height:6,top:-1}},innerItem:{width:6,backgroundColor:"#ff9607",height:"100%",margin:"0 auto"}}),et=function(e){var t=e.startTime,r=e.total,n=e.onProgressDotHover,a=e.onProgressDotLeave,i=Object(c.useRef)(null);return d.a.createElement("div",{className:Object(f.css)($e.item),style:{left:Je(t,r)},onMouseEnter:function(){if(i.current){var e=i.current.getBoundingClientRect(),r=e.left,a=e.top;null===n||void 0===n||n({startTime:t,left:r,top:a})}},onMouseLeave:a},d.a.createElement("div",{ref:i,className:Object(f.css)($e.innerItem)}))},tt=function(e){var t=e.progressDots,r=void 0===t?[]:t,n=e.total,a=e.onProgressDotHover,i=e.onProgressDotLeave;return d.a.createElement("div",{className:Object(f.css)($e.root)},r.map((function(e,t){return d.a.createElement(et,{key:t,startTime:e.startTime,total:n,onProgressDotHover:a,onProgressDotLeave:i})})))},rt=f.StyleSheet.create({root:{overflow:"hidden",userSelect:"none",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent",":focus":{outline:"none"}},inner:{position:"relative",display:"flex",alignItems:"center",width:"100%",height:"100%"},track:{position:"relative",flex:1,overflow:"hidden",backgroundColor:"rgba(255, 255, 255, 0.3)",borderRadius:"2px"},bar:{position:"absolute",backgroundColor:"#fff",borderRadius:"2px 0 0 2px"},thumbWrapper:{position:"absolute"},thumb:{width:"1em",height:"1em",margin:"-0.5em",borderRadius:"50%",backgroundColor:"#fff"}}),nt=f.StyleSheet.create({root:{height:"1em",padding:"0 0.5em"},inner:{flexDirection:"row"},track:{height:4},bar:{top:0,bottom:0},thumbWrapper:{top:"50%"}}),at=f.StyleSheet.create({root:{width:"1em",padding:"0.5em 0"},inner:{flexDirection:"column"},track:{width:4},bar:{left:0,right:0},thumbWrapper:{left:"50%"}}),it=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={isSlideActive:!1,isSliding:!1,slidingValue:null},e.trackRef=d.a.createRef(),e.handleKeyDown=function(t){var r=e.props,n=r.reverse,a=r.value,i=r.total,o=r.step,s=0;t.keyCode!==Ee&&t.keyCode!==Te||(s=-1),t.keyCode!==ke&&t.keyCode!==Se||(s=1),n&&(s=-s);var l=_()(a+o*s,0,i);l!==a&&(t.preventDefault(),e.handleChange(l))},e.handleDragStart=function(t){if(0===t.button){var r=e.getSlidingValue(t);e.setState({isSlideActive:!0,slidingValue:r});var n=e.props.onDragStart;n&&n(),e.handleChange(r),e.registerEvents()}},e.handleDragMove=function(t){var r=e.getSlidingValue(t);e.setState({slidingValue:r,isSliding:!0}),e.handleChange(r)},e.handleDragEnd=function(t){e.unregisterEvents();var r=e.props.onDragEnd;r&&r(),e.state.isSliding&&e.handleChange(e.getSlidingValue(t)),e.setState({isSlideActive:!1,slidingValue:null,isSliding:!1})},e.handleChange=function(t){var r=e.props.onChange;r&&r(t)},e}return Object(o.a)(r,[{key:"registerEvents",value:function(){document.addEventListener("mousemove",this.handleDragMove),document.addEventListener("mouseup",this.handleDragEnd)}},{key:"unregisterEvents",value:function(){document.removeEventListener("mousemove",this.handleDragMove),document.removeEventListener("mouseup",this.handleDragEnd)}},{key:"getVariantStyleSheet",value:function(){return"horizontal"===this.props.orientation?nt:at}},{key:"getStyles",value:function(e){var t=this.props.styles;return Array.isArray(t)||(t=[t]),t=t.filter(Boolean),[rt[e],this.getVariantStyleSheet()[e]].concat(Object(a.a)(t.map((function(t){return t[e]}))))}},{key:"getClassName",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return f.css.apply(void 0,Object(a.a)(r.map((function(t){return e.getStyles(t)}))))}},{key:"getAlignKey",value:function(){var e=this.props,t=e.orientation,r=e.reverse;return"horizontal"===t?r?"right":"left":r?"top":"bottom"}},{key:"getSizeKey",value:function(){return"horizontal"===this.props.orientation?"width":"height"}},{key:"getPercentage",value:function(){var e=this.props,t=e.value,r=e.total,n=this.state,a=n.isSlideActive,i=n.slidingValue;return Je(a?i:t,r)}},{key:"getBufferedPercentage",value:function(){var e=this.props;return Je(e.buffered,e.total)}},{key:"getSlidingValue",value:function(e){var t=this.props,r=t.orientation,n=t.reverse,a=t.total,i=this.trackRef.current;if(!i)return 0;var o,s=i.getBoundingClientRect();return o="horizontal"===r?(e.clientX-s.left)/s.width:(s.bottom-e.clientY)/s.height,o=_()(o,0,1),n&&(o=1-o),o*a}},{key:"render",value:function(){var e,t,r=this.props,a=r.buffered,i=r.onFocus,o=r.onBlur,s=r.noInteraction,l=r.progressDots,u=r.total,c=r.onProgressDotHover,f=r.onProgressDotLeave,h=this.state.isSlideActive,v=s?{}:{tabIndex:0,onFocus:i,onBlur:o,onKeyDown:this.handleKeyDown,onMouseDown:this.handleDragStart};return d.a.createElement("div",Object.assign({className:this.getClassName("root")},v,{role:"slider"}),d.a.createElement("div",{className:this.getClassName("inner")},d.a.createElement("div",{ref:this.trackRef,className:this.getClassName("track")},Boolean(a)&&d.a.createElement("div",{className:this.getClassName("bar","buffered"),style:(e={},Object(n.a)(e,this.getAlignKey(),0),Object(n.a)(e,this.getSizeKey(),this.getBufferedPercentage()),e)}),d.a.createElement("div",{className:this.getClassName("bar"),style:(t={},Object(n.a)(t,this.getAlignKey(),0),Object(n.a)(t,this.getSizeKey(),this.getPercentage()),t)}),Boolean(null===l||void 0===l?void 0:l.length)&&d.a.createElement(tt,{progressDots:l,total:u,onProgressDotHover:c,onProgressDotLeave:f})),!s&&d.a.createElement("div",{className:this.getClassName("thumbWrapper"),style:Object(n.a)({},this.getAlignKey(),this.getPercentage())},d.a.createElement("div",{className:this.getClassName("thumb",h&&"thumbSliding")}))))}}]),r}(c.Component);it.defaultProps={orientation:"horizontal",reverse:!1,value:0,buffered:0,total:0,step:1,progressDots:[]};var ot=f.StyleSheet.create({root:{}}),st=f.StyleSheet.create({root:{},track:{transition:"transform 300ms"},bar:{backgroundColor:"#0f88eb"},thumb:{transform:"scale(0)",transition:"transform 300ms"},buffered:{backgroundColor:"rgba(255, 255, 255, 0.6)",borderRadius:"2px 0 0 2px"}}),lt=f.StyleSheet.create({thumb:{transform:"scale(1)"}}),ut=f.StyleSheet.create({track:{overflow:"visible"}}),ct=f.StyleSheet.create({root:{position:"absolute",bottom:0,left:0,right:0,padding:0,height:"3px"},track:{borderRadius:0},thumb:{display:"none"},buffered:{backgroundColor:"rgba(255, 255, 255, 0.3)",borderRadius:"2px 0 0 2px"}}),dt=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(c.useState)(e),r=Object(u.a)(t,2),n=r[0],a=r[1],i={on:Object(c.useCallback)((function(){return a(!0)}),[]),off:Object(c.useCallback)((function(){return a(!1)}),[]),toggle:Object(c.useCallback)((function(){return a((function(e){return!e}))}),[])};return[n,i]},ft=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(c.useCallback)((function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.forEach((function(e){return e.apply(void 0,r)}))}),[])},ht=function(e){var t=e.value,r=e.onDragStart,n=e.onDragEnd,a=e.onSeek,i=e.onChange,o=e.onProgressDotHover,s=e.onProgressDotLeave,l=R(e,["value","onDragStart","onDragEnd","onSeek","onChange","onProgressDotHover","onProgressDotLeave"]),c=dt(),h=Object(u.a)(c,2),v=h[0],p=h[1],g=dt(),m=Object(u.a)(g,2),y=m[0],b=m[1],E=dt(),S=Object(u.a)(E,2),k=S[0],T=S[1],L=dt(),w=Object(u.a)(L,2),_=w[0],A=w[1],C=I((function(e){e!==t&&(null===i||void 0===i||i(e)),k||null===a||void 0===a||a(e)}));return d.a.createElement("div",{className:Object(f.css)(ot.root),onMouseEnter:b.on,onMouseLeave:ft(b.off,p.off)},d.a.createElement(it,Object.assign({},l,{styles:[st,(y||v||k)&&lt,_&&ut].filter(Boolean),value:t,onChange:C,onFocus:p.on,onBlur:p.off,onDragStart:ft(T.on,I(r||O.a)),onDragEnd:ft(T.off,I(n||O.a)),onProgressDotHover:ft(A.on,I(o||O.a)),onProgressDotLeave:ft(A.off,I(s||O.a))})))},vt=function(e){return d.a.createElement("div",{className:Object(f.css)(Qe.timeline)},d.a.createElement(ht,Object.assign({},e)))};function pt(e){var t=String(e);return t.length<2&&(t="0"+t),t}function gt(e){if(!Number.isFinite(e))return"";var t=(e=Math.floor(e))%60,r=Math.floor(e/60);return"".concat(pt(r),":").concat(pt(t))}var mt=function(e){var t=e.isFullScreen,r=e.currentTime,n=e.duration;return d.a.createElement("div",{className:Object(f.css)(Qe.time,t&&Qe.fullScreenedTime)},"".concat(gt(r)," / ").concat(gt(n)))},yt=function(e){return e.slice().reverse()},bt={auto:"quality-auto",ld:"quality-ld",sd:"quality-sd",hd:"quality-hd",fhd:"quality-fhd"},Et=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={isQualityHovered:!1},e.handleQualityPointerEnter=function(){e.setState({isQualityHovered:!0})},e.handleQualityPointerLeave=function(){e.setState({isQualityHovered:!1})},e}return Object(o.a)(r,[{key:"render",value:function(){var e=this,t=this.state.isQualityHovered;return d.a.createElement(P.Consumer,null,(function(r){var n=r.qualities,a=r.setCurrentQuality,i=r.currentQuality;return n.length>1&&d.a.createElement("div",{className:Object(f.css)(Qe.menuContainer),onMouseEnter:e.handleQualityPointerEnter,onMouseLeave:e.handleQualityPointerLeave},d.a.createElement(Xe,{label:d.a.createElement(Q,{style:"narrow",name:bt[i]})}),d.a.createElement("div",{className:Object(f.css)(Qe.menu,t&&Qe.menuShown)},d.a.createElement("div",{className:Object(f.css)(Qe.qualityMenu)},yt(n).map((function(t){return d.a.createElement("button",{key:t,className:Object(f.css)(Qe.qualityMenuItem,i===t&&Qe.qualityMenuActiveItem),onClick:function(){e.handleQualityPointerLeave(),a(t)}},d.a.createElement(Q,{name:bt[t]}))})))))}))}}]),r}(d.a.PureComponent),St=f.StyleSheet.create({root:{padding:"0.375em 0"}}),kt=f.StyleSheet.create({root:{width:"2.5em",height:"4em"},track:{margin:"-0.4em 0",transform:"translate3d(0, 0, 0)"},thumb:{transform:"scale(0.8)",transition:"transform 300ms",":hover":{transform:"scale(1)"}},thumbSliding:{transform:"scale(1)"}}),Tt=function(e){return d.a.createElement("div",{className:Object(f.css)(St.root)},d.a.createElement(it,Object.assign({},e,{styles:kt,orientation:"vertical",step:.1})))},Lt=function(e){var t=e.volume,r=e.menuShown,n=e.onMouseEnter,a=e.onMouseLeave,i=e.onDragStart,o=e.onDragEnd,s=e.onChange,l=e.onToggleMuted;return d.a.createElement("div",{className:Object(f.css)(Qe.menuContainer),onMouseEnter:n,onMouseLeave:a},d.a.createElement(Xe,{icon:0===t?Ge:qe,onClick:l}),d.a.createElement("div",{className:Object(f.css)(Qe.menu,r&&Qe.menuShown)},d.a.createElement(Tt,{value:t,total:1,onDragStart:i,onDragEnd:o,onChange:s})))},wt=f.StyleSheet.create({root:{padding:"0.25em 0.5em",fontSize:"0.875em",whiteSpace:"nowrap",color:"#fff"}}),_t=function(e){var t=e.content;return d.a.createElement("div",{className:Object(f.css)(wt.root)},d.a.createElement(Q,{name:t}))},At=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={isHovered:!1},e.handlePointerEnter=function(){e.setState({isHovered:!0})},e.handlePointerLeave=function(){e.setState({isHovered:!1})},e}return Object(o.a)(r,[{key:"render",value:function(){var e=this.props,t=e.onMouseEnter,r=e.onMouseLeave,n=e.children,a=R(e,["onMouseEnter","onMouseLeave","children"]),i=this.state.isHovered;return d.a.createElement("div",Object.assign({},a,{onMouseEnter:Object(g.d)(this.handlePointerEnter,t||O.a),onMouseLeave:Object(g.d)(this.handlePointerLeave,r||O.a)}),n(i))}}]),r}(d.a.Component),Ot=g.e.isMobile,Rt=function(e){var t=e.isFullScreen,r=e.onClick;return d.a.createElement(At,{className:Object(f.css)(Qe.menuContainer)},(function(e){return d.a.createElement(d.a.Fragment,null,d.a.createElement(Xe,{icon:t?ze:Ue,onClick:r}),d.a.createElement("div",{className:Object(f.css)(Qe.fullScreenTooltip,Qe.menu,e&&Qe.menuShown,t&&Qe.fullScreenTooltipWide)},!Ot&&d.a.createElement(_t,{content:t?"action-exit-fullscreen":"action-enter-fullscreen"})))}))},Ct=g.e.isMobile,Pt=function(e){var t=e.isPip,r=e.onClick;return d.a.createElement(At,{className:Object(f.css)(Qe.menuContainer)},(function(e){return d.a.createElement(d.a.Fragment,null,d.a.createElement(Xe,{icon:t?Ne:He,onClick:r}),d.a.createElement("div",{className:Object(f.css)(Qe.pipTooltip,Qe.menu,e&&Qe.menuShown)},!Ct&&d.a.createElement(_t,{content:t?"action-exit-pip":"action-enter-pip"})))}))},xt=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={isPlaybackRateHovered:!1},e.handlePlaybackRatePointerEnter=function(){e.setState({isPlaybackRateHovered:!0})},e.handlePlaybackRatePointerLeave=function(){e.setState({isPlaybackRateHovered:!1})},e}return Object(o.a)(r,[{key:"render",value:function(){var e=this,t=this.state.isPlaybackRateHovered;return d.a.createElement(P.Consumer,null,(function(r){var n=r.playbackRates,a=r.setCurrentPlaybackRate,i=r.currentPlaybackRate;return n.length>1&&d.a.createElement("div",{className:Object(f.css)(Qe.menuContainer),onMouseEnter:e.handlePlaybackRatePointerEnter,onMouseLeave:e.handlePlaybackRatePointerLeave},d.a.createElement(Xe,{label:1===i.value?d.a.createElement(Q,{name:"playback-rate"}):"".concat(i.text)}),d.a.createElement("div",{className:Object(f.css)(Qe.menu,t&&Qe.menuShown)},d.a.createElement("div",{className:Object(f.css)(Qe.qualityMenu)},yt(n).map((function(t){return d.a.createElement("button",{key:t.value,className:Object(f.css)(Qe.qualityMenuItem,i.value===t.value&&Qe.qualityMenuActiveItem),onClick:function(){e.handlePlaybackRatePointerLeave(),a(t)}},t.text)})))))}))}}]),r}(d.a.PureComponent),Dt=g.e.isMobile,Mt=function(e){var t=e.isFullScreen,r=e.onClick;return d.a.createElement(At,{className:Object(f.css)(Qe.menuContainer)},(function(e){return d.a.createElement(d.a.Fragment,null,d.a.createElement(Xe,{icon:t?Ye:Ke,onClick:r}),d.a.createElement("div",{className:Object(f.css)(Qe.fullScreenTooltip,Qe.menu,e&&Qe.menuShown,t&&Qe.fullScreenTooltipWide)},!Dt&&d.a.createElement(_t,{content:t?"action-exit-page-fullscreen":"action-enter-page-fullscreen"})))}))},It=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={slideTime:void 0,isVolumeHovered:!1,isVolumeDragging:!1,isVolumeKeyboard:!1},e.prevVolume=1,e.firstKey=!0,e.slideTime=null,e.onDragMove=function(t){var r=e.props.duration;t=_()(t,0,r),e.setState({slideTime:t})},e.handleToggle=function(t){var r=e.props,n=r.isPlaying,a=r.onPlay,i=r.onPause;!n&&a&&a(t),n&&i&&i(t)},e.handleSeek=function(t){var r=e.props,n=r.duration,a=r.onSeek;t=_()(t,0,n),a&&(a(t),e.setState({slideTime:null}))},e.handleVolumeChange=function(t){t=_()(t,0,1);var r=e.props.onVolumeChange;r&&r(t)},e.handleToggleMuted=function(){var t=e.props.volume;t&&(e.prevVolume=t),e.handleVolumeChange(t?0:e.prevVolume)},e.handleVolumePointerEnter=function(){e.setState({isVolumeHovered:!0})},e.handleVolumePointerLeave=function(){e.setState({isVolumeHovered:!1})},e.handleVolumeDragStart=function(){var t=e.props.volume;t&&(e.prevVolume=t),e.setState({isVolumeDragging:!0});var r=e.props.onDragStart;r&&r()},e.handleVolumeDragEnd=function(){e.setState({isVolumeDragging:!1});var t=e.props.onDragEnd;t&&t()},e.handleKeyDown=function(t){var r=e.props,n=r.duration,a=r.currentTime,i=r.volume,o=r.show,s=r.onToggleFullScreen,l=r.onTogglePageFullScreen,u=r.isPageFullScreen,c=!0;switch(t.keyCode){case ye:case Be:e.firstKey&&e.handleToggle("keyCode");break;case me:case Me:e.firstKey&&(null===s||void 0===s||s());break;case be:e.firstKey&&u&&(null===l||void 0===l||l());break;case Ee:e.handleSeek(a-5);break;case ke:e.handleSeek(a+5);break;case Ie:e.firstKey&&e.handleSeek(a-10);break;case Fe:e.firstKey&&e.handleSeek(a+10);break;case Le:case we:case _e:case Ae:case Oe:case Re:case Ce:case Pe:case xe:case De:if(o&&e.firstKey){var d=n/10*(t.keyCode-Le);e.handleSeek(d)}break;case je:e.firstKey&&e.handleToggleMuted();break;case Se:e.firstKey&&i&&(e.prevVolume=i),e.setState({isVolumeKeyboard:!0}),e.handleVolumeChange(i+.05);break;case Te:e.firstKey&&i&&(e.prevVolume=i),e.handleVolumeChange(i-.05);break;default:c=!1}c&&t.preventDefault(),e.firstKey=!1},e.handleKeyUp=function(t){switch(e.firstKey=!0,t.keyCode){case Se:case Te:e.handleVolumeKeyboard()}},e.handleVolumeKeyboard=E()((function(){e.setState({isVolumeKeyboard:!1})}),1e3),e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){this.props.standalone&&(document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp))}},{key:"shouldComponentUpdate",value:function(e){return this.props.show||e.show}},{key:"componentWillUnmount",value:function(){this.props.standalone&&(document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp))}},{key:"render",value:function(){var e=this,t=this.props,r=t.isPlaying,n=t.buffered,a=t.duration,i=t.currentTime,o=t.volume,s=t.isFullScreen,l=t.isPageFullScreen,u=t.isPip,c=t.onDragStart,h=t.onDragEnd,v=t.onToggleFullScreen,p=t.onTogglePageFullScreen,g=t.onTogglePip,m=t.showPip,y=t.progressDots,b=t.hiddenPlayButton,E=t.hiddenTimeline,S=t.hiddenTime,k=t.hiddenQualityMenu,T=t.hiddenVolumeItem,L=t.hiddenPlaybackRateItem,w=t.hiddenFullScreenButton,_=t.shouldShowPageFullScreenButton,A=t.onProgressDotHover,O=t.onProgressDotLeave,R=this.state,C=R.isVolumeHovered,P=R.isVolumeDragging,x=R.isVolumeKeyboard,D=R.slideTime||i;return d.a.createElement("div",{className:Object(f.css)(Qe.root,s&&Qe.fullScreened)},!E&&d.a.createElement(vt,{value:i,total:a,buffered:n,progressDots:y,onDragStart:c,onDragEnd:h,onChange:this.onDragMove,onSeek:this.handleSeek,onProgressDotHover:A,onProgressDotLeave:O}),d.a.createElement("div",{className:Object(f.css)(Qe.rootBottom)},d.a.createElement("div",{className:Object(f.css)(Qe.rootBottomLeft)},!b&&d.a.createElement(Ze,{isPlaying:r,onClick:function(){return e.handleToggle("button")}}),E&&d.a.createElement("div",{className:Object(f.css)(Qe.timelineHolder)}),!S&&d.a.createElement(mt,{isFullScreen:s,currentTime:D,duration:a})),d.a.createElement("div",{className:Object(f.css)(Qe.rootBottomRight)},!L&&d.a.createElement(xt,null),!k&&d.a.createElement(Et,null),m&&d.a.createElement(Pt,{isPip:u,onClick:g}),_&&d.a.createElement(Mt,{isFullScreen:l,onClick:p}),!w&&d.a.createElement(Rt,{isFullScreen:s,onClick:v}),!T&&d.a.createElement(Lt,{volume:o,menuShown:C||P||x,onMouseEnter:this.handleVolumePointerEnter,onMouseLeave:this.handleVolumePointerLeave,onToggleMuted:this.handleToggleMuted,onDragStart:this.handleVolumeDragStart,onDragEnd:this.handleVolumeDragEnd,onChange:this.handleVolumeChange}))))}}]),r}(c.Component);It.defaultProps={show:!1,standalone:!1,isPlaying:!1,duration:0,currentTime:0,volume:.5,buffered:0,isFullScreen:!1,isPageFullScreen:!1,showPip:!1,hiddenPlayButton:!1,hiddenTimeline:!1,hiddenTime:!1,hiddenQualityMenu:!1,hiddenPlaybackRateItem:!1,hiddenVolumeItem:!1,hiddenFullScreenButton:!1,progressDots:[]};var Bt=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(o.a)(r,[{key:"shouldComponentUpdate",value:function(e){return this.props.show||e.show}},{key:"render",value:function(){var e=this.props,t=e.duration,r=e.currentTime,n=e.buffered,a=e.progressDots;return d.a.createElement(it,{value:r,total:t,buffered:n,progressDots:a,styles:[st,ct],noInteraction:!0})}}]),r}(c.Component);Bt.defaultProps={show:!1,duration:0,currentTime:0,buffered:0,progressDots:[]};var Ft,jt={store:{},setItem:function(e,t){this.store[e]=t},removeItem:function(e){return delete this.store[e]},getItem:function(e){return this.store[e]}},Nt={isSupported:L()((function(){try{var t={key:"__test_support_key__",value:"__test_support_value__"},r=Boolean(e.localStorage);return localStorage.setItem(t.key,t.value),localStorage.removeItem(t.key),r}catch(n){return!1}})),getStorage:L()((function(){return Nt.isSupported()?localStorage:jt})),set:function(e,t){Nt.getStorage().setItem(e,JSON.stringify(t))},get:function(e){try{var t=Nt.getStorage().getItem(e);return JSON.parse(t)}catch(r){return null}},delete:function(e){Nt.getStorage().removeItem(e)}},Ut=new(function(){function e(){Object(i.a)(this,e),this.inited=!1}return Object(o.a)(e,[{key:"init",value:function(e,t,r){this.inited=!0,this.element=e,this.onEnter=t,this.onExit=r,this.element.addEventListener("enterpictureinpicture",this.handleEnter.bind(this)),this.element.addEventListener("leavepictureinpicture",this.handleExit.bind(this))}},{key:"handleEnter",value:function(e){this.onEnter&&this.onEnter(e)}},{key:"handleExit",value:function(e){this.onExit&&this.onExit(e)}},{key:"supported",get:function(){return!!this.inited&&document.pictureInPictureEnabled}},{key:"pictureInPictureElement",get:function(){return document.pictureInPictureElement}},{key:"request",value:function(){this.element&&this.element.requestPictureInPicture()}},{key:"exit",value:function(){document.exitPictureInPicture()}},{key:"toggle",value:function(){this.pictureInPictureElement?this.exit():this.request()}}]),e}()),Gt={mobile:"26em"},Vt=f.StyleSheet.create({root:{position:"relative",overflow:"hidden",userSelect:"none",width:"100%",height:"100%",fontSize:16,backgroundColor:"#000",":focus":{outline:"none"}},fullScreened:{fontSize:24},pageFullScreen:{position:"fixed",top:0,left:0,zIndex:1e5},actionButton:{width:"4.5em",height:"4.5em"},actionButtonAnimated:{animationName:{"0%":{opacity:0,transform:"scale(0)"},"50%":{opacity:.6,transform:"scale(0.8)"},"100%":{opacity:0,transform:"scale(1)"}},animationDuration:"600ms",animationFillMode:"both"},actionIcon:Object(n.a)({width:"4.5em",height:"4.5em"},(Ft="mobile","@media screen and (max-width: ".concat(Gt[Ft],")")),{transform:"scale(0.75)"}),video:{width:"100%",height:"100%"},overlay:{position:"absolute",left:0,right:0,top:0,bottom:0,overflow:"hidden"},overlayMask:{background:"rgba(0, 0, 0, 0.08)"},loader:{position:"absolute",left:"50%",top:"50%",color:"#0f88eb",transform:"translate(-50%, -50%)"},action:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},backdrop:{position:"absolute",left:0,right:0,top:0,bottom:0},title:{position:"absolute",left:0,right:0,top:0,overflow:"hidden",padding:"0 1em",lineHeight:2.5,textOverflow:"ellipsis",whiteSpace:"nowrap",color:"#fff",backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.3))",transform:"translateY(-100%)",transition:"transform 300ms"},titleShown:{transform:"translateY(0)"},controller:{position:"absolute",left:0,right:0,bottom:0,backgroundImage:"linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.3))"},volumeButton:{position:"absolute",bottom:0,right:8},cover:{position:"absolute",left:0,right:0,top:0,bottom:0,overflow:"hidden",backgroundColor:"#000",cursor:"pointer",visibility:"hidden",opacity:0,transition:"visibility 300ms, opacity 300ms"},coverShown:{visibility:"visible",opacity:1},coverImage:{position:"absolute",left:0,top:0,width:"100%",height:"100%"},coverTime:{position:"absolute",right:"0.5em",bottom:"0.5em",padding:"0.375em",fontSize:"0.875em",lineHeight:1,color:"rgba(255, 255, 255, 0.9)",backgroundColor:"transparent",textShadow:"0 0 6px rgba(0, 0, 0, 0.4)"},coverTimeMobile:{padding:0},coverAction:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},coverReplayAction:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0",backgroundColor:"rgba(0, 0, 0, 0.16)",animationName:{"0%":{opacity:0},"100%":{opacity:1}},animationDuration:"600ms",animationFillMode:"both"},coverReplayButton:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0",height:"40px",width:"116px",margin:"auto",backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:"4px",color:"#fff",fontSize:"16px",lineHeight:"24px",padding:"8px",boxSizing:"border-box",textAlign:"center",whiteSpace:"nowrap",transition:"transform 200ms, opacity 200ms",willChange:"transform"},coverReplayButtonHovered:{transform:"scale(1.1)"},coverReplayButtonPressed:{opacity:.7},replayIcon:{verticalAlign:"top",marginRight:"4px"},error:{position:"absolute",left:0,right:0,top:0,bottom:0,overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center",color:"#fff",backgroundColor:"#000"},errorIcon:{width:"2.5em",height:"2.5em",margin:"0 auto",fill:"currentColor"},errorMessage:{marginTop:"1em",fontSize:"1.25em",lineHeight:1,textAlign:"center"}}),Ht=f.StyleSheet.create({base:{transition:"opacity .5s ease-in-out, visibility .5s ease-in-out"},hidden:{opacity:0,visibility:"hidden"},shown:{opacity:1,visibility:"visible"}}),Wt=g.e.isMobile,zt=function(e){Object(s.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).state={isPlaybackStarted:!1,isNeverPlayed:!0,lastAction:void 0,isDataLoaded:!1,isPlaying:!1,isLoading:!1,duration:0,currentTime:0,volume:.5,buffered:[],isControllerShown:!1,isControllerHovered:!1,isControllerDragging:!1,type:null,hovered:!1,pressed:!1,isEnterPageFullScreen:!1},e.isSeeking=!1,e.showLoaderTimeout=null,e.hideControllerTimeout=null,e.playerRef=d.a.createRef(),e.videoRef=d.a.createRef(),e.actionSubscriptions_=[],e.getShowController=function(e){var t=e.isPlaybackStarted,r=e.isPlaying,n=e.isControllerShown,a=e.isControllerHovered,i=e.isControllerDragging,o=e.currentTime;return t?!r||n||a||i:0!==o},e.setDocumentTitle=function(){var t=e.props,r=t.title;t.standalone&&"string"===typeof r&&r!==document.title&&(document.title=r)},e.initPip=function(){e.props.disablePictureInPicture||!e.videoRef.current.root||Ut.inited||Ut.init(e.videoRef.current.root,(function(){return e.props.onEvent(p.b.ENTER_PIP)}),(function(){return e.props.onEvent(p.b.EXIT_PIP)}))},e.handlePauseAction=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.dontApplyOnFullScreen;e.state.isPlaying&&(r&&Boolean(v.a.element)||e.handlePause("button"))},e.handleToggle=function(){e.state.isPlaying?e.handlePause("video"):e.handlePlay("video")},e.handlePlay=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=e.props,n=r.onEvent,a=r.onBeforePlay,i=e.context.currentSrc;n(p.b.REQUEST_PLAY),Promise.resolve(null===a||void 0===a?void 0:a(i)).then((function(){e.state.isPlaybackStarted?e.setState({lastAction:"play"}):(n(p.b.PLAY_COUNT),e.setState({isPlaybackStarted:!0}),e.state.isDataLoaded||e.setState({isLoading:!0}),0!==e.state.currentTime&&e.handleSeek(0)),e.setState({isPlaying:!0,type:t,isNeverPlayed:!1})})).catch((function(){n(p.b.PLAY_REJECTED)}))},e.handlePause=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.props.onEvent(p.b.REQUEST_PAUSE);var r=e.state.isLoading;r||e.setState({lastAction:"pause",isPlaying:!1,type:t})},e.handleVideoPlay=function(){e.state.isPlaying||e.setState({isPlaying:!0})},e.handleVideoPause=function(){e.state.isPlaying&&e.setState({isPlaying:!1})},e.handleVideoEnded=function(){e.setState({isPlaybackStarted:!1,lastAction:null,isPlaying:!1,isLoading:!1})},e.handleVideoLoadedData=function(){e.setState({isDataLoaded:!0,isLoading:!1})},e.handleVideoError=function(){e.setState({isPlaying:!1,isLoading:!1})},e.handleVideoDurationChange=function(t){e.setState({duration:t})},e.handleVideoTimeUpdate=function(t){e.state.isLoading||e.isSeeking||e.isSeeking||e.setState({currentTime:t})},e.handleVideoVolumeChange=function(t){t=Math.round(100*t)/100,e.setState({volume:t}),Nt.set("@griffith/history-volume",t)},e.handleSeek=function(t){var r,n=e.state,a=n.isPlaybackStarted,i=n.isNeverPlayed,o=n.currentTime,s=!a&&!i&&0!==o;e.setState({currentTime:t}),null===(r=e.videoRef.current)||void 0===r||r.seek(t),s&&e.handlePlay()},e.handleVideoWaiting=function(){null===e.showLoaderTimeout&&(e.showLoaderTimeout=setTimeout((function(){e.setState({isLoading:!0})}),1e3))},e.handleVideoPlaying=function(){null!==e.showLoaderTimeout&&(clearTimeout(e.showLoaderTimeout),e.showLoaderTimeout=null),e.setState({isLoading:!1})},e.handleVideoSeeking=function(){e.isSeeking=!0},e.handleVideoSeeked=function(){e.isSeeking=!1},e.handleVideoProgress=function(t){e.setState({buffered:t})},e.handleToggleFullScreen=function(){if(v.a.enabled){var t=e.props.onEvent;null===v.a||void 0===v.a||v.a.toggle(e.playerRef.current,(function(){return t(p.b.ENTER_FULLSCREEN)}),(function(){return t(p.b.EXIT_FULLSCREEN)}))}},e.handleTogglePageFullScreen=function(){var t=e.props.onEvent;Boolean(v.a.element)&&!Ut.pictureInPictureElement&&e.handleToggleFullScreen(),e.state.isEnterPageFullScreen?(e.setState({isEnterPageFullScreen:!1}),t(p.b.EXIT_PAGE_FULLSCREEN)):(e.setState({isEnterPageFullScreen:!0}),t(p.b.ENTER_PAGE_FULLSCREEN))},e.handleTogglePip=function(){var t=e.props.onEvent;e.state.isEnterPageFullScreen&&(e.setState({isEnterPageFullScreen:!1}),t(p.b.EXIT_PAGE_FULLSCREEN)),Ut.toggle()},e.handleShowController=function(){e.state.isControllerShown||e.setState({isControllerShown:!0}),null!==e.hideControllerTimeout&&clearTimeout(e.hideControllerTimeout),e.hideControllerTimeout=setTimeout((function(){e.hideControllerTimeout=null,e.setState({isControllerShown:!1})}),3e3)},e.handleHideController=function(){null!==e.hideControllerTimeout&&(clearTimeout(e.hideControllerTimeout),e.hideControllerTimeout=null),e.setState({isControllerShown:!1})},e.handleControllerPointerEnter=function(){e.setState({isControllerHovered:!0})},e.handleControllerPointerLeave=function(){e.setState({isControllerHovered:!1})},e.handleControllerDragStart=function(){e.setState({isControllerDragging:!0})},e.handleControllerDragEnd=function(){e.setState({isControllerDragging:!1})},e.handleMouseEnter=function(){e.setState({hovered:!0}),e.handleShowController()},e.handleMouseLeave=function(){e.setState({hovered:!1}),e.handleHideController()},e.handleMouseDown=function(){e.setState({pressed:!0}),e.handleShowController()},e.handleMouseUp=function(){e.setState({pressed:!1}),e.handleShowController()},e.handleMouseMove=function(){e.state.hovered||e.setState({hovered:!0}),e.handleShowController()},e.handleProgressDotHover=function(t){e.props.onEvent(p.b.HOVER_PROGRESS_DOT,t)},e.handleProgressDotLeave=function(){e.props.onEvent(p.b.LEAVE_PROGRESS_DOT)},e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.setDocumentTitle(),this.initPip(),this.getShowController(this.state)&&this.props.onEvent(p.b.SHOW_CONTROLLER);var t=Nt.get("@griffith/history-volume");t&&this.setState({volume:t}),this.actionSubscriptions_=[this.props.subscribeAction(p.a.PLAY,(function(){return e.handlePlay()})),this.props.subscribeAction(p.a.PAUSE,this.handlePauseAction),this.props.subscribeAction(p.a.TIME_UPDATE,(function(t){var r=t.currentTime;return e.handleSeek(r)})),this.props.subscribeAction(p.a.SHOW_CONTROLLER,this.handleShowController),this.props.subscribeAction(p.a.SET_VOLUME,(function(t){var r=t.volume;return e.handleVideoVolumeChange(r)}))],this.videoRef.current.root&&(this.props.muted&&this.handleVideoVolumeChange(0),this.props.autoplay&&this.handlePlay("video"))}},{key:"componentDidUpdate",value:function(e,t){this.setDocumentTitle(),this.initPip();var r=this.getShowController(t),n=this.getShowController(this.state);r!==n&&(n?this.props.onEvent(p.b.SHOW_CONTROLLER):this.props.onEvent(p.b.HIDE_CONTROLLER))}},{key:"componentWillUnmount",value:function(){this.actionSubscriptions_.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){var e=this,t=this.props,r=t.error,n=t.title,a=t.cover,i=t.standalone,o=t.loop,s=t.onEvent,l=t.useMSE,u=t.useAutoQuality,c=t.alwaysShowVolumeButton,h=t.disablePictureInPicture,p=t.progressDots,g=t.hiddenPlayButton,m=t.hiddenTimeline,y=t.hiddenTime,b=t.hiddenQualityMenu,E=t.hiddenVolume,S=t.hiddenFullScreenButton,k=t.shouldShowPageFullScreenButton,T=t.children,L=t.hiddenPlaybackRateItem,w=this.state,_=w.isPlaybackStarted,A=w.lastAction,O=w.isPlaying,R=w.isLoading,C=w.duration,P=w.currentTime,x=w.isNeverPlayed,D=w.volume,M=w.buffered,I=w.type,B=w.hovered,F=w.pressed,j=w.isEnterPageFullScreen,N=Boolean(Ut.pictureInPictureElement),U=Boolean(v.a.element)&&!N,V=this.getShowController(this.state),H=function(e,t){var r=t.find((function(t){return t.start<=e&&e<=t.end}));return r?r.end:0}(P,M),W=!R||0!==P,z=W&&_;return d.a.createElement("div",{className:Object(f.css)(Vt.root,U&&Vt.fullScreened,j&&Vt.pageFullScreen),onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseMove:this.handleShowController,ref:this.playerRef},d.a.createElement("div",{className:Object(f.css)(Vt.video)},d.a.createElement(ge,{ref:this.videoRef,controls:Wt&&_,paused:!O,volume:D,loop:o,onPlay:this.handleVideoPlay,onPause:this.handleVideoPause,onEnded:this.handleVideoEnded,onLoadedData:this.handleVideoLoadedData,onError:this.handleVideoError,onDurationChange:this.handleVideoDurationChange,onTimeUpdate:this.handleVideoTimeUpdate,onWaiting:this.handleVideoWaiting,onPlaying:this.handleVideoPlaying,onSeeking:this.handleVideoSeeking,onSeeked:this.handleVideoSeeked,onProgress:this.handleVideoProgress,onEvent:s,useMSE:l,useAutoQuality:u})),d.a.createElement("div",{className:Object(f.css)(Vt.cover,!_&&Vt.coverShown),onClick:function(){return e.handlePlay()}},a&&d.a.createElement(G.Consumer,null,(function(e){var t=e.objectFit;return d.a.createElement("img",{className:Object(f.css)(Vt.coverImage),src:a,style:{objectFit:t}})})),C&&0===P&&d.a.createElement("div",{className:Object(f.css)(Vt.coverTime,Wt&&Vt.coverTimeMobile)},gt(C)),x&&d.a.createElement("div",{className:Object(f.css)(Vt.coverAction)},d.a.createElement("div",{className:Object(f.css)(Vt.actionButton)},d.a.createElement(Z,{icon:ee,styles:Vt.actionIcon}))),!x&&0!==P&&d.a.createElement("div",{className:Object(f.css)(Vt.coverReplayAction)},d.a.createElement("div",{className:Object(f.css)(Vt.coverReplayButton,B&&Vt.coverReplayButtonHovered,F&&Vt.coverReplayButtonPressed)},d.a.createElement(Z,{icon:te,styles:Vt.replayIcon}),d.a.createElement(Q,{name:"replay"})))),!Wt&&d.a.createElement("div",{className:Object(f.css)(Vt.overlay,x&&Vt.overlayMask)},_&&R&&d.a.createElement("div",{className:Object(f.css)(Vt.loader)},d.a.createElement(ie,null)),A&&"button"!==I&&d.a.createElement("div",{className:Object(f.css)(Vt.action),key:A},d.a.createElement("div",{className:Object(f.css)(Vt.actionButton,Vt.actionButtonAnimated)},d.a.createElement(Z,{icon:"play"===A?ee:$,styles:Vt.actionIcon}))),d.a.createElement("div",{className:Object(f.css)(Vt.backdrop),onTouchStart:function(e){e.preventDefault()},onClick:this.handleToggle}),n&&U&&d.a.createElement("div",{className:Object(f.css)(Vt.title,V&&Vt.titleShown)},n),!m&&O&&W&&d.a.createElement("div",{className:Object(f.css)(Ht.base,V?Ht.hidden:Ht.shown)},d.a.createElement(Bt,{progressDots:p,buffered:H,duration:C,currentTime:P,show:!V})),c&&z&&d.a.createElement("div",{className:Object(f.css)(Vt.volumeButton,Ht.base,V?Ht.hidden:Ht.shown)},d.a.createElement(Lt,{volume:D})),z&&d.a.createElement("div",{className:Object(f.css)(Vt.controller,Ht.base,V?Ht.shown:Ht.hidden),onMouseEnter:this.handleControllerPointerEnter,onMouseLeave:this.handleControllerPointerLeave},d.a.createElement(It,{standalone:i,isPlaying:O,duration:C,currentTime:P,volume:D,progressDots:p,buffered:H,isFullScreen:U,isPageFullScreen:j,isPip:N,onDragStart:this.handleControllerDragStart,onDragEnd:this.handleControllerDragEnd,onPlay:this.handlePlay,onPause:this.handlePause,onSeek:this.handleSeek,onVolumeChange:this.handleVideoVolumeChange,onToggleFullScreen:this.handleToggleFullScreen,onTogglePageFullScreen:this.handleTogglePageFullScreen,onTogglePip:this.handleTogglePip,onProgressDotHover:this.handleProgressDotHover,onProgressDotLeave:this.handleProgressDotLeave,show:V,showPip:Ut.supported&&!h,hiddenPlayButton:g,hiddenTimeline:m,hiddenTime:y,hiddenQualityMenu:b,hiddenVolumeItem:E,hiddenPlaybackRateItem:L,hiddenFullScreenButton:S,shouldShowPageFullScreenButton:k}))),r&&d.a.createElement("div",{className:Object(f.css)(Vt.error)},d.a.createElement(Z,{icon:J,styles:Vt.errorIcon}),r.message&&d.a.createElement("div",{className:Object(f.css)(Vt.errorMessage)},r.message)),T)}}]),r}(c.Component);zt.contextType=P,zt.defaultProps={standalone:!1,duration:0,autoplay:!1,muted:!1,disablePictureInPicture:!1,progressDots:[]},zt.getDerivedStateFromProps=function(e,t){var r=e.duration,n=r&&!t.duration?{duration:r}:null;return Object.assign({},n)};var qt={value:1,text:"1.0x"},Kt=[{value:.5,text:"0.5x"},{value:.75,text:"0.75x"},{value:1,text:"1.0x"},{value:1.25,text:"1.25x"},{value:1.5,text:"1.5x"},{value:2,text:"2.0x"}],Yt=function(e){var t=e.standalone,r=e.id,n=e.sources,a=e.onEvent,i=e.dispatchRef,o=e.messageContextRef,s=e.shouldObserveResize,l=e.initialObjectFit,u=e.locale,c=void 0===u?"en":u,f=e.localeConfig,h=e.shouldShowPageFullScreenButton,v=void 0!==h&&h,p=e.defaultQuality,g=e.defaultPlaybackRate,m=void 0===g?qt:g,y=e.playbackRates,b=void 0===y?Kt:y,E=e.useAutoQuality,S=void 0!==E&&E,k=R(e,["standalone","id","sources","onEvent","dispatchRef","messageContextRef","shouldObserveResize","initialObjectFit","locale","localeConfig","shouldShowPageFullScreenButton","defaultQuality","defaultPlaybackRate","playbackRates","useAutoQuality"]);return d.a.createElement(q,{initialObjectFit:l},d.a.createElement(z,{shouldObserveResize:s},d.a.createElement(U,{id:r,enableCrossWindow:t,onEvent:a,dispatchRef:i,messageContextRef:o},d.a.createElement(j.Consumer,null,(function(e){var a=e.emitEvent,i=e.subscribeAction;return d.a.createElement(M,{onEvent:a,sources:n,id:r,defaultQuality:p,useAutoQuality:S,defaultPlaybackRate:m,playbackRates:b},d.a.createElement(Y,{locale:c,localeConfig:f},d.a.createElement(zt,Object.assign({shouldShowPageFullScreenButton:v},k,{useAutoQuality:S,standalone:t,onEvent:a,subscribeAction:i}))))})))))};f.StyleSheet.create({container:{position:"absolute",pointerEvents:"none",overflow:"hidden"},containerFullWidth:{width:"100%",height:"auto",top:"50%",left:0,transform:"translate(0, -50%)"},containerFullHeight:{width:"auto",height:"100%",top:0,left:"50%",transform:"translate(-50%)"},image:{display:"block",visibility:"hidden"},imageFullWidth:{width:"100%",height:"auto"},imageFullHeight:{width:"auto",height:"100%"},layer:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden",pointerEvents:"none"}})}).call(this,r(76))},314:function(e,t,r){"use strict";e.exports=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0}},315:function(e,t,r){"use strict";var n=r(355),a=[],i=[],o=n.makeRequestCallFromTimer((function(){if(i.length)throw i.shift()}));function s(e){var t;(t=a.length?a.pop():new l).task=e,n(t)}function l(){this.task=null}e.exports=s,l.prototype.call=function(){try{this.task.call()}catch(e){s.onerror?s.onerror(e):(i.push(e),o())}finally{this.task=null,a[a.length]=this}}},316:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return i})),function(e){e.LOG="log",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(n||(n={}));var a={log:function(e){for(var t,r=console[e]?e:"log",n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];(t=console)[r].apply(t,["[griffith]"].concat(a))},debug:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,[n.DEBUG].concat(t))},info:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,[n.INFO].concat(t))},warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,[n.WARN].concat(t))},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,[n.ERROR].concat(t))}},i={isMobile:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),isAndroid:/(android)/i.test(navigator.userAgent),isSafari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent)};function o(){var e=function(){if("undefined"!==typeof window)return window.MediaSource||window.WebKitMediaSource}(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"===typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove;return!!r&&!!n}function s(){var e=document.createElement("video");return Boolean(e.canPlayType("application/vnd.apple.mpegURL"))}function l(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.reduce((function(e,t){return t.apply(void 0,r)}),null)}}},317:function(e,t,r){var n=r(318),a=r(128),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var o=e[t];i.call(e,t)&&a(o,r)&&(void 0!==r||t in e)||n(e,t,r)}},318:function(e,t,r){var n=r(369);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},319:function(e,t,r){var n=r(173),a=r(320),i=r(164),o=r(174),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=a(e);return t}:o;e.exports=s},320:function(e,t,r){var n=r(176)(Object.getPrototypeOf,Object);e.exports=n},331:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(110);var a=r(125);function i(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},352:function(e,t,r){e.exports=r(353)},353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(354);r(314),r(315);var a=n.makeExports(!1),i=a.StyleSheet,o=a.StyleSheetServer,s=a.StyleSheetTestUtils,l=a.css,u=a.minify,c=a.flushToStyleTag,d=a.injectAndGetClassName,f=a.defaultSelectorHandlers,h=a.reset,v=a.resetInjectedStyle;t.StyleSheet=i,t.StyleSheetServer=o,t.StyleSheetTestUtils=s,t.css=l,t.minify=u,t.flushToStyleTag=c,t.injectAndGetClassName=d,t.defaultSelectorHandlers=f,t.reset=h,t.resetInjectedStyle=v},354:function(e,t,r){"use strict";function n(e){return e&&"object"===typeof e&&"default"in e?e.default:e}var a=n(r(314)),i=n(r(315));function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){s(e,t,r[t])}))}return e}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=/([A-Z])/g,d=function(e){return"-".concat(e.toLowerCase())},f={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var h=["Webkit","ms","Moz","O"];Object.keys(f).forEach((function(e){h.forEach((function(t){f[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=f[e]}))}));var v=function(e,t){return"number"===typeof t?f[e]?""+t:t+"px":""+t},p=function(e,t){return m(v(e,t))},g=function(e,t){return a(e).toString(36)},m=function(e){return"!"===e[e.length-10]&&" !important"===e.slice(-11)?e:"".concat(e," !important")},y="undefined"!==typeof Map,b=function(){function e(){this.elements={},this.keyOrder=[]}var t=e.prototype;return t.forEach=function(e){for(var t=0;t<this.keyOrder.length;t++)e(this.elements[this.keyOrder[t]],this.keyOrder[t])},t.set=function(t,r,n){if(this.elements.hasOwnProperty(t)){if(n){var a=this.keyOrder.indexOf(t);this.keyOrder.splice(a,1),this.keyOrder.push(t)}}else this.keyOrder.push(t);if(null!=r){if(y&&r instanceof Map||r instanceof e){var i=this.elements.hasOwnProperty(t)?this.elements[t]:new e;return r.forEach((function(e,t){i.set(t,e,n)})),void(this.elements[t]=i)}if(Array.isArray(r)||"object"!==o(r))this.elements[t]=r;else{for(var s=this.elements.hasOwnProperty(t)?this.elements[t]:new e,l=Object.keys(r),u=0;u<l.length;u+=1)s.set(l[u],r[l[u]],n);this.elements[t]=s}}else this.elements[t]=r},t.get=function(e){return this.elements[e]},t.has=function(e){return this.elements.hasOwnProperty(e)},t.addStyleType=function(t){var r=this;if(y&&t instanceof Map||t instanceof e)t.forEach((function(e,t){r.set(t,e,!0)}));else for(var n=Object.keys(t),a=0;a<n.length;a++)this.set(n[a],t[n[a]],!0)},e}();function E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function S(e,t){return e(t={exports:{}},t.exports),t.exports}var k=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}));E(k);var T=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){if(e.hasOwnProperty(t)){for(var a={},i=e[t],o=(0,n.default)(t),s=Object.keys(r),l=0;l<s.length;l++){var u=s[l];if(u===t)for(var c=0;c<i.length;c++)a[i[c]+o]=r[t];a[u]=r[u]}return a}return r};var r,n=(r=k)&&r.__esModule?r:{default:r}}));E(T);var L=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,n,a){for(var i=0,o=e.length;i<o;++i){var s=e[i](t,r,n,a);if(s)return s}}}));E(L);var w=S((function(e,t){function r(e,t){-1===e.indexOf(t)&&e.push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(Array.isArray(t))for(var n=0,a=t.length;n<a;++n)r(e,t[n]);else r(e,t)}}));E(w);var _=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e instanceof Object&&!Array.isArray(e)}}));E(_);var A=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.prefixMap,o=e.plugins;return function e(s){for(var l in s){var u=s[l];if((0,i.default)(u))s[l]=e(u);else if(Array.isArray(u)){for(var c=[],d=0,f=u.length;d<f;++d){var h=(0,n.default)(o,l,u[d],s,t);(0,a.default)(c,h||u[d])}c.length>0&&(s[l]=c)}else{var v=(0,n.default)(o,l,u,s,t);v&&(s[l]=v),s=(0,r.default)(t,l,s)}}return s}};var r=o(T),n=o(L),a=o(w),i=o(_);function o(e){return e&&e.__esModule?e:{default:e}}})),O=E(A),R=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&"text"===t)return["-webkit-text","text"]}})),C=E(R),P=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"===typeof e&&r.test(e)};var r=/-webkit-|-moz-|-ms-/;e.exports=t.default}));E(P);var x=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,n.default)(t)&&t.indexOf("calc(")>-1)return a.map((function(e){return t.replace(/calc\(/g,e+"calc(")}))};var r,n=(r=P)&&r.__esModule?r:{default:r};var a=["-webkit-","-moz-",""]})),D=E(x),M=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,n.default)(t)&&t.indexOf("cross-fade(")>-1)return a.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,n=(r=P)&&r.__esModule?r:{default:r};var a=["-webkit-",""]})),I=E(M),B=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&n.hasOwnProperty(t))return r.map((function(e){return e+t}))};var r=["-webkit-","-moz-",""],n={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0}})),F=E(B),j=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,n.default)(t)&&t.indexOf("filter(")>-1)return a.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,n=(r=P)&&r.__esModule?r:{default:r};var a=["-webkit-",""]})),N=E(j),U=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&r.hasOwnProperty(t))return r[t]};var r={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]}})),G=E(U),V=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){Object.prototype.hasOwnProperty.call(n,e)&&(o[n[e]]=r[t]||t);if("flex"===e){if(Object.prototype.hasOwnProperty.call(a,t))return void(o.msFlex=a[t]);if(i.test(t))return void(o.msFlex=t+" 1 0%");var s=t.split(/\s/);switch(s.length){case 1:return void(o.msFlex="1 1 "+t);case 2:return void(i.test(s[1])?o.msFlex=s[0]+" "+s[1]+" 0%":o.msFlex=s[0]+" 1 "+s[1]);default:o.msFlex=t}}};var r={"space-around":"distribute","space-between":"justify","flex-start":"start","flex-end":"end"},n={alignContent:"msFlexLinePack",alignSelf:"msFlexItemAlign",alignItems:"msFlexAlign",justifyContent:"msFlexPack",order:"msFlexOrder",flexGrow:"msFlexPositive",flexShrink:"msFlexNegative",flexBasis:"msFlexPreferredSize"},a={auto:"1 1 auto",inherit:"inherit",initial:"0 1 auto",none:"0 0 auto",unset:"unset"},i=/^\d+(\.\d+)?$/})),H=E(V),W=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){"flexDirection"===e&&"string"===typeof t&&(t.indexOf("column")>-1?a.WebkitBoxOrient="vertical":a.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?a.WebkitBoxDirection="reverse":a.WebkitBoxDirection="normal");n.hasOwnProperty(e)&&(a[n[e]]=r[t]||t)};var r={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},n={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines",flexGrow:"WebkitBoxFlex"}})),z=E(W),q=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,n.default)(t)&&i.test(t))return a.map((function(e){return t.replace(i,(function(t){return e+t}))}))};var r,n=(r=P)&&r.__esModule?r:{default:r};var a=["-webkit-","-moz-",""],i=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/gi})),K=E(q),Y=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){a=!0,i=l}finally{try{!n&&s.return&&s.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function n(e){return"number"===typeof e&&!isNaN(e)}t.default=function(e,t,r){if("display"===e&&t in i)return i[t];if(e in o){(0,o[e])(t,r)}};var a=["center","end","start","stretch"],i={"inline-grid":["-ms-inline-grid","inline-grid"],grid:["-ms-grid","grid"]},o={alignSelf:function(e,t){a.indexOf(e)>-1&&(t.msGridRowAlign=e)},gridColumn:function(e,t){if(n(e))t.msGridColumn=e;else{var a=e.split("/").map((function(e){return+e})),i=r(a,2),s=i[0],l=i[1];o.gridColumnStart(s,t),o.gridColumnEnd(l,t)}},gridColumnEnd:function(e,t){var r=t.msGridColumn;n(e)&&n(r)&&(t.msGridColumnSpan=e-r)},gridColumnStart:function(e,t){n(e)&&(t.msGridColumn=e)},gridRow:function(e,t){if(n(e))t.msGridRow=e;else{var a=e.split("/").map((function(e){return+e})),i=r(a,2),s=i[0],l=i[1];o.gridRowStart(s,t),o.gridRowEnd(l,t)}},gridRowEnd:function(e,t){var r=t.msGridRow;n(e)&&n(r)&&(t.msGridRowSpan=e-r)},gridRowStart:function(e,t){n(e)&&(t.msGridRow=e)},gridTemplateColumns:function(e,t){t.msGridColumns=e},gridTemplateRows:function(e,t){t.msGridRows=e},justifySelf:function(e,t){a.indexOf(e)>-1&&(t.msGridColumnAlign=e)}}})),Q=E(Y),X=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,n.default)(t)&&t.indexOf("image-set(")>-1)return a.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,n=(r=P)&&r.__esModule?r:{default:r};var a=["-webkit-",""]})),Z=E(X),J=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(Object.prototype.hasOwnProperty.call(r,e))for(var a=r[e],i=0,o=a.length;i<o;++i)n[a[i]]=t};var r={marginBlockStart:["WebkitMarginBefore"],marginBlockEnd:["WebkitMarginAfter"],marginInlineStart:["WebkitMarginStart","MozMarginStart"],marginInlineEnd:["WebkitMarginEnd","MozMarginEnd"],paddingBlockStart:["WebkitPaddingBefore"],paddingBlockEnd:["WebkitPaddingAfter"],paddingInlineStart:["WebkitPaddingStart","MozPaddingStart"],paddingInlineEnd:["WebkitPaddingEnd","MozPaddingEnd"],borderBlockStart:["WebkitBorderBefore"],borderBlockStartColor:["WebkitBorderBeforeColor"],borderBlockStartStyle:["WebkitBorderBeforeStyle"],borderBlockStartWidth:["WebkitBorderBeforeWidth"],borderBlockEnd:["WebkitBorderAfter"],borderBlockEndColor:["WebkitBorderAfterColor"],borderBlockEndStyle:["WebkitBorderAfterStyle"],borderBlockEndWidth:["WebkitBorderAfterWidth"],borderInlineStart:["WebkitBorderStart","MozBorderStart"],borderInlineStartColor:["WebkitBorderStartColor","MozBorderStartColor"],borderInlineStartStyle:["WebkitBorderStartStyle","MozBorderStartStyle"],borderInlineStartWidth:["WebkitBorderStartWidth","MozBorderStartWidth"],borderInlineEnd:["WebkitBorderEnd","MozBorderEnd"],borderInlineEndColor:["WebkitBorderEndColor","MozBorderEndColor"],borderInlineEndStyle:["WebkitBorderEndStyle","MozBorderEndStyle"],borderInlineEndWidth:["WebkitBorderEndWidth","MozBorderEndWidth"]}})),$=E(J),ee=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]}})),te=E(ee),re=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(n.hasOwnProperty(e)&&a.hasOwnProperty(t))return r.map((function(e){return e+t}))};var r=["-webkit-","-moz-",""],n={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},a={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0}})),ne=E(re),ae=/[A-Z]/g,ie=/^ms-/,oe={};function se(e){return"-"+e.toLowerCase()}var le,ue=(le=Object.freeze({default:function(e){if(oe.hasOwnProperty(e))return oe[e];var t=e.replace(ae,se);return oe[e]=ie.test(t)?"-"+t:t}}))&&le.default||le,ce=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)};var r,n=(r=ue)&&r.__esModule?r:{default:r};e.exports=t.default}));E(ce);var de=S((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,l){if("string"===typeof t&&o.hasOwnProperty(e)){var u=function(e,t){if((0,n.default)(e))return e;for(var a=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,o=a.length;i<o;++i){var l=a[i],u=[l];for(var c in t){var d=(0,r.default)(c);if(l.indexOf(d)>-1&&"order"!==d)for(var f=t[c],h=0,v=f.length;h<v;++h)u.unshift(l.replace(d,s[f[h]]+d))}a[i]=u.join(",")}return a.join(",")}(t,l),c=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return c;var d=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?d:(i["Webkit"+(0,a.default)(e)]=c,i["Moz"+(0,a.default)(e)]=d,u)}};var r=i(ce),n=i(P),a=i(k);function i(e){return e&&e.__esModule?e:{default:e}}var o={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},s={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"}})),fe=["Webkit"],he=["Moz"],ve=["ms"],pe=["Webkit","Moz"],ge=["Webkit","ms"],me=["Webkit","Moz","ms"],ye=O({plugins:[C,D,I,F,N,G,H,z,K,Q,Z,$,te,ne,E(de)],prefixMap:{transform:ge,transformOrigin:ge,transformOriginX:ge,transformOriginY:ge,backfaceVisibility:fe,perspective:fe,perspectiveOrigin:fe,transformStyle:fe,transformOriginZ:fe,animation:fe,animationDelay:fe,animationDirection:fe,animationFillMode:fe,animationDuration:fe,animationIterationCount:fe,animationName:fe,animationPlayState:fe,animationTimingFunction:fe,appearance:pe,userSelect:me,fontKerning:fe,textEmphasisPosition:fe,textEmphasis:fe,textEmphasisStyle:fe,textEmphasisColor:fe,boxDecorationBreak:fe,clipPath:fe,maskImage:fe,maskMode:fe,maskRepeat:fe,maskPosition:fe,maskClip:fe,maskOrigin:fe,maskSize:fe,maskComposite:fe,mask:fe,maskBorderSource:fe,maskBorderMode:fe,maskBorderSlice:fe,maskBorderWidth:fe,maskBorderOutset:fe,maskBorderRepeat:fe,maskBorder:fe,maskType:fe,textDecorationStyle:pe,textDecorationSkip:pe,textDecorationLine:pe,textDecorationColor:pe,filter:fe,fontFeatureSettings:pe,breakAfter:me,breakBefore:me,breakInside:me,columnCount:pe,columnFill:pe,columnGap:pe,columnRule:pe,columnRuleColor:pe,columnRuleStyle:pe,columnRuleWidth:pe,columns:pe,columnSpan:pe,columnWidth:pe,writingMode:ge,flex:ge,flexBasis:fe,flexDirection:ge,flexGrow:fe,flexFlow:ge,flexShrink:fe,flexWrap:ge,alignContent:fe,alignItems:fe,alignSelf:fe,justifyContent:fe,order:fe,transitionDelay:fe,transitionDuration:fe,transitionProperty:fe,transitionTimingFunction:fe,backdropFilter:fe,scrollSnapType:ge,scrollSnapPointsX:ge,scrollSnapPointsY:ge,scrollSnapDestination:ge,scrollSnapCoordinate:ge,shapeImageThreshold:fe,shapeImageMargin:fe,shapeImageOutside:fe,hyphens:me,flowInto:ge,flowFrom:ge,regionFragment:ge,textOrientation:fe,boxSizing:he,textAlignLast:he,tabSize:he,wrapFlow:ve,wrapThrough:ve,wrapMargin:ve,touchAction:ve,textSizeAdjust:ge,borderImage:fe,borderImageOutset:fe,borderImageRepeat:fe,borderImageSlice:fe,borderImageSource:fe,borderImageWidth:fe}}),be=[function(e,t,r){return":"!==e[0]?null:r(t+e)},function(e,t,r){if("@"!==e[0])return null;var n=r(t);return["".concat(e,"{").concat(n.join(""),"}")]}],Ee=function e(t,r,n,a,i){for(var o=new b,s=0;s<r.length;s++)o.addStyleType(r[s]);var l=new b,c=[];o.forEach((function(r,o){n.some((function(s){var l=s(o,t,(function(t){return e(t,[r],n,a,i)}));if(null!=l)return Array.isArray(l)?c.push.apply(c,u(l)):(console.warn("WARNING: Selector handlers should return an array of rules.Returning a string containing multiple rules is deprecated.",s),c.push("@media all {".concat(l,"}"))),!0}))||l.set(o,r,!0)}));var d=Te(t,l,a,i,n);return d&&c.unshift(d),c},Se=function(e,t,r){return"".concat(function(e){var t=e.replace(c,d);return"m"===t[0]&&"s"===t[1]&&"-"===t[2]?"-".concat(t):t}(e),":").concat(r(e,t),";")},ke=function(e,t){return e[t]=!0,e},Te=function(e,t,r,n,a){!function(e,t,r){if(t)for(var n=Object.keys(t),a=0;a<n.length;a++){var i=n[a];e.has(i)&&e.set(i,t[i](e.get(i),r),!1)}}(t,r,a);var i=Object.keys(t.elements).reduce(ke,Object.create(null)),o=ye(t.elements),s=Object.keys(o);if(s.length!==t.keyOrder.length)for(var l=0;l<s.length;l++)if(!i[s[l]]){var u=void 0;if((u="W"===s[l][0]?s[l][6].toLowerCase()+s[l].slice(7):"o"===s[l][1]?s[l][3].toLowerCase()+s[l].slice(4):s[l][2].toLowerCase()+s[l].slice(3))&&i[u]){var c=t.keyOrder.indexOf(u);t.keyOrder.splice(c,0,s[l])}else t.keyOrder.unshift(s[l])}for(var d=!1===n?v:p,f=[],h=0;h<t.keyOrder.length;h++){var g=t.keyOrder[h],m=o[g];if(Array.isArray(m))for(var y=0;y<m.length;y++)f.push(Se(g,m[y],d));else f.push(Se(g,m,d))}return f.length?"".concat(e,"{").concat(f.join(""),"}"):""},Le=null,we={fontFamily:function e(t){if(Array.isArray(t)){var r={};return t.forEach((function(t){r[e(t)]=!0})),Object.keys(r).join(",")}return"object"===o(t)?(Ce(t.src,"@font-face",[t],!1),'"'.concat(t.fontFamily,'"')):t},animationName:function e(t,r){if(Array.isArray(t))return t.map((function(t){return e(t,r)})).join(",");if("object"===o(t)){var n="keyframe_".concat((i=t,g(JSON.stringify(i)))),a="@keyframes ".concat(n,"{");return t instanceof b?t.forEach((function(e,t){a+=Ee(t,[e],r,we,!1).join("")})):Object.keys(t).forEach((function(e){a+=Ee(e,[t[e]],r,we,!1).join("")})),Re(n,[a+="}"]),n}return t;var i}},_e={},Ae=[],Oe=!1,Re=function(e,t){var r;if(!_e[e]){if(!Oe){if("undefined"===typeof document)throw new Error("Cannot automatically buffer without a document");Oe=!0,i(Me)}(r=Ae).push.apply(r,u(t)),_e[e]=!0}},Ce=function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(!_e[e]){var i=Ee(t,r,a,we,n);Re(e,i)}},Pe=function(){Ae=[],_e={},Oe=!1,Le=null},xe=function(e){delete _e[e]},De=function(){Oe=!1;var e=Ae;return Ae=[],e},Me=function(){var e=De();e.length>0&&function(e){if(null==Le&&null==(Le=document.querySelector("style[data-aphrodite]"))){var t=document.head||document.getElementsByTagName("head")[0];(Le=document.createElement("style")).type="text/css",Le.setAttribute("data-aphrodite",""),t.appendChild(Le)}var r=Le.styleSheet||Le.sheet;if(r.insertRule){var n=r.cssRules.length;e.forEach((function(e){try{r.insertRule(e,n),n+=1}catch(t){}}))}else Le.innerText=(Le.innerText||"")+e.join("")}(e)},Ie=function(e){e.forEach((function(e){_e[e]=!0}))},Be=function e(t,r,n,a){for(var i=0;i<t.length;i+=1)if(t[i])if(Array.isArray(t[i]))a+=e(t[i],r,n,a);else{if(!("_definition"in(o=t[i])&&"_name"in o&&"_len"in o))throw new Error("Invalid Style Definition: Styles should be defined using the StyleSheet.create method.");r.push(t[i]._name),n.push(t[i]._definition),a+=t[i]._len}var o;return a},Fe=function(e,t,r){var n,a=[],i=[],o=Be(t,a,i,0);return 0===a.length?"":(n=1===a.length?"_".concat(a[0]):"_".concat(g(a.join())).concat((o%36).toString(36)),Ce(n,".".concat(n),i,e,r),n)},je=function(e,t){return"".concat(t,"_").concat(g(e))},Ne=g,Ue={create:function(e){for(var t={},r=Object.keys(e),n=0;n<r.length;n+=1){var a=r[n],i=e[a],o=JSON.stringify(i);t[a]={_len:o.length,_name:Ne(o,a),_definition:i}}return t},rehydrate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Ie(e)}},Ge="undefined"!==typeof window?null:{renderStatic:function(e){return Pe(),function(){if(Oe)throw new Error("Cannot buffer while already buffering");Oe=!0}(),{html:e(),css:{content:De().join(""),renderedClassNames:Object.keys(_e)}}}};t.makeExports=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return{StyleSheet:l({},Ue,{extend:function(n){var a=n.map((function(e){return e.selectorHandler})).filter((function(e){return e}));return e(t,r.concat(a))}}),StyleSheetServer:Ge,StyleSheetTestUtils:null,minify:function(e){Ne=e?g:je},css:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return Fe(t,n,r)},flushToStyleTag:Me,injectAndGetClassName:Fe,defaultSelectorHandlers:be,reset:Pe,resetInjectedStyle:xe}}},355:function(e,t,r){"use strict";(function(t){function r(e){a.length||(n(),!0),a[a.length]=e}e.exports=r;var n,a=[],i=0;function o(){for(;i<a.length;){var e=i;if(i+=1,a[e].call(),i>1024){for(var t=0,r=a.length-i;t<r;t++)a[t]=a[t+i];a.length-=i,i=0}}a.length=0,i=0,!1}var s="undefined"!==typeof t?t:self,l=s.MutationObserver||s.WebKitMutationObserver;function u(e){return function(){var t=setTimeout(n,0),r=setInterval(n,50);function n(){clearTimeout(t),clearInterval(r),e()}}}n="function"===typeof l?function(e){var t=1,r=new l(e),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}(o):u(o),r.requestFlush=n,r.makeRequestCallFromTimer=u}).call(this,r(76))},356:function(e,t,r){e.exports=r(357)},357:function(e,t,r){var n;!function(a,i,o){"use strict";function s(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var r=e.getElementsByTagName("video");r[0]&&(t=r[0])}return t}function l(e){var t=s(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_METADATA?(t.addEventListener("loadedmetadata",(function e(){t.removeEventListener("loadedmetadata",e,!1),t.webkitEnterFullscreen(),v=!!t.getAttribute("controls")}),!1),t.load()):(t.webkitEnterFullscreen(),v=!!t.getAttribute("controls")),h=t}catch(o){return E("not_supported",e)}return!0}return E(void 0===f.request?"not_supported":"not_enabled",e)}function u(){S.element||(b(),c())}function c(){o&&"webkitfullscreenchange"===f.change&&window.removeEventListener("resize",u,!1)}var d=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,f=function(){var e=i.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},r={};for(var n in t)for(var a=0,o=t[n].length;o>a;a++)if(t[n][a]in e||t[n][a]in i||"on"+t[n][a].toLowerCase()in i){r[n]=t[n][a];break}return r}(),h=null,v=null,p=function(){},g=[],m=!1;navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Chrome")>-1&&(m=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0);var y=function(e){var t=g[g.length-1];t&&(e!==t.element&&e!==h||!t.hasEntered)&&("VIDEO"===e.tagName&&(h=e),1===g.length&&S.onenter(S.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0)},b=function(){!h||v||d||(h.setAttribute("controls","controls"),h.removeAttribute("controls")),h=null,v=null;var e=g.pop();e&&(e.exit.call(e.element),S.element||(g.forEach((function(e){e.exit.call(e.element)})),g=[],S.onexit()))},E=function(e,t){if(g.length>0){var r=g.pop();t=t||r.element,r.error.call(t,e),S.onerror(t,e)}},S={request:function(e,t,r,n){if(e=e||i.body,g.push({element:e,enter:t||p,exit:r||p,error:n||p}),void 0!==f.request)if(o&&!1===i[f.enabled])l(e);else if(!1!==m&&32>m)l(e);else{if(o&&void 0===f.enabled)return f.enabled="webkitFullscreenEnabled",e[f.request](),void setTimeout((function(){i[f.element]?i[f.enabled]=!0:(i[f.enabled]=!1,l(e))}),250);try{e[f.request](),setTimeout((function(){i[f.element]||E(o?"not_enabled":"not_allowed",e)}),100)}catch(c){E("not_enabled",e)}}else l(e)},exit:function(){c(),i[f.exit]()},toggle:function(e,t,r,n){S.element?S.exit():S.request(e,t,r,n)},videoEnabled:function(e){if(S.enabled)return!0;var t=s(e=e||i.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},onenter:p,onexit:p,onchange:p,onerror:p};try{Object.defineProperties(S,{element:{enumerable:!0,get:function(){return h&&h.webkitDisplayingFullscreen?h:i[f.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"===f.exit&&!o||!(!1!==m&&32>m)&&(i[f.enabled]||!1)}}}),f.change&&i.addEventListener(f.change,(function(e){if(S.onchange(S.element),S.element){var t=g[g.length-2];t&&t.element===S.element?b():(y(S.element),o&&"webkitfullscreenchange"===f.change&&window.addEventListener("resize",u,!1))}else b()}),!1),i.addEventListener("webkitbeginfullscreen",(function(e){var t=!0;if(g.length>0)for(var r=0,n=g.length;n>r;r++){if(s(g[r].element)===e.srcElement){t=!1;break}}t&&g.push({element:e.srcElement,enter:p,exit:p,error:p}),S.onchange(e.srcElement),y(e.srcElement)}),!0),i.addEventListener("webkitendfullscreen",(function(e){S.onchange(e.srcElement),b(e.srcElement)}),!0),f.error&&i.addEventListener(f.error,(function(e){E("not_allowed")}),!1)}catch(k){S.element=null,S.enabled=!1}void 0===(n=function(){return S}.call(t,r,t,e))||(e.exports=n)}(0,document,self!==top)},358:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,a="~";function i(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,r,n,i){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new o(r,n||e,i),l=a?a+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function l(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=a?a+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,o=new Array(i);n<i;n++)o[n]=r[n].fn;return o},u.prototype.listenerCount=function(e){var t=a?a+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,i,o){var s=a?a+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,n),!0;case 5:return c.fn.call(c.context,t,r,n,i),!0;case 6:return c.fn.call(c.context,t,r,n,i,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,n);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var i=a?a+e:e;if(!this._events[i])return this;if(!t)return l(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||l(this,i);else{for(var s=0,u=[],c=o.length;s<c;s++)(o[s].fn!==t||n&&!o[s].once||r&&o[s].context!==r)&&u.push(o[s]);u.length?this._events[i]=1===u.length?u[0]:u:l(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&l(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=a,u.EventEmitter=u,e.exports=u},359:function(e,t,r){var n=r(129);function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function r(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(a.Cache||n),r}a.Cache=n,e.exports=a},360:function(e,t,r){var n=r(361),a=r(280);e.exports=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=a(r))===r?r:0),void 0!==t&&(t=(t=a(t))===t?t:0),n(a(e),t,r)}},361:function(e,t){e.exports=function(e,t,r){return e===e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},362:function(e,t){e.exports=function(){}},363:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(34),a=r(41),i=r(43),o=r(42),s=r(304),l=r(0),u=r.n(l),c=r(364),d=r.n(c);function f(e){var t=[];return t.push("#EXTM3U"),e.forEach((function(e){var r={"PROGRAM-ID":"1",BANDWIDTH:String(e.bandwidth)};if(e.resolution){var n=e.resolution,a=n.width,i=n.height;r.RESOLUTION="".concat(a,"x").concat(i)}t.push("#EXT-X-STREAM-INF:".concat(Object.entries(r).map((function(e){var t=Object(s.a)(e,2),r=t[0],n=t[1];return"".concat(r,"=").concat(n)})).join(","))),t.push(e.source)})),t.join("\n")}var h=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).video=null,e.manuallyBuildAdaptiveM3U8Blob=!1,e.hasLoadStarted=!1,e}return Object(a.a)(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.src,r=e.sources,n=e.useAutoQuality;this.hls=new d.a({autoStartLoad:!1}),this.hls.attachMedia(this.video);var a=Boolean(r.find((function(e){return"auto"===e.quality})));if(n&&!a){var i=function(e){var t=e.map((function(e){return{source:e.source,bandwidth:1024*e.bitrate,resolution:{width:e.width,height:e.height}}}));return new Blob([f(t)],{type:"application/vnd.apple.mpegURL"})}(r);this.src=URL.createObjectURL(i),this.manuallyBuildAdaptiveM3U8Blob=!0}else this.src=t;this.hls.loadSource(this.src)}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.currentQuality,n=t.sources,a=t.paused;if(this.hls){if(r!==e.currentQuality){var i=n.find((function(e){return e.quality===r}));if(i)if(this.manuallyBuildAdaptiveM3U8Blob){var o=this.hls.levels.findIndex((function(e){return e.url.includes(i.source)}));this.hls.nextLevel=o}else{var s=this.video.currentTime;this.hls.destroy(),this.hls=new d.a({autoStartLoad:!1}),this.hls.attachMedia(this.video),this.hls.loadSource(i.source),this.video.currentTime=s,this.hls.startLoad(),a||this.video.play()}else this.hls.nextLevel=-1}a||!e.paused||this.hasLoadStarted||(this.hls.startLoad(),this.hasLoadStarted=!0)}}},{key:"componentWillUnmount",value:function(){this.hls.destroy(),this.manuallyBuildAdaptiveM3U8Blob&&URL.revokeObjectURL(this.src)}},{key:"render",value:function(){var e=this,t=this.props,r=t.onRef,n=(t.currentQuality,t.useAutoQuality,t.src,t.sources,t.paused,function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(t,["onRef","currentQuality","useAutoQuality","src","sources","paused"]));return u.a.createElement("video",Object.assign({ref:function(t){r&&r(t),e.video=t}},n))}}]),r}(l.Component),v={pluginName:"griffith-hls",VideoComponent:h,willHandleSrcChange:!0}},364:function(e,t,r){e.exports=function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[o]={exports:{}};t[o][0].call(u.exports,(function(e){return a(t[o][1][e]||e)}),u,u.exports,e,t,r,n)}return r[o].exports}for(var i=!1,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,i,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(s(r=this._events[e]))return!1;if(a(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(o(r))for(i=Array.prototype.slice.call(arguments,1),n=(u=r.slice()).length,l=0;l<n;l++)u[l].apply(this,i);return!0},n.prototype.addListener=function(e,t){var r;if(!a(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.trace),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!a(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,i,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(r=this._events[e]).length,n=-1,r===t||a(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(s=i;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(a(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){!function(e){var n=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,a=/^([^\/;?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var i=this.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=s.normalizePath(i.path),s.buildURLFromParts(i)):t;var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=a.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(u.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+i.path;u.path=s.normalizePath(d)}else u.path=o.path,i.params||(u.params=o.params,i.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(i.path):i.path),s.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};"object"==typeof r&&"object"==typeof t?t.exports=s:"object"==typeof r?r.URLToolkit=s:e.URLToolkit=s}(this)},{}],3:[function(e,t,r){var n=arguments[3],a=arguments[4],i=arguments[5],o=JSON.stringify;t.exports=function(e,t){function r(e){for(var t in g[e]=!0,a[e][1]){var n=a[e][1][t];g[n]||r(n)}}for(var s,l=Object.keys(i),u=0,c=l.length;u<c;u++){var d=l[u],f=i[d].exports;if(f===e||f&&f.default===e){s=d;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var h={};for(u=0,c=l.length;u<c;u++)h[d=l[u]]=d;a[s]=[Function(["require","module","exports"],"("+e+")(self)"),h]}var v=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[s]=s,a[v]=[Function(["require"],"var f = require("+o(s)+");(f.default ? f.default : f)(self);"),p];var g={};r(v);var m="("+n+")({"+Object.keys(g).map((function(e){return o(e)+":["+a[e][0]+","+o(a[e][1])+"]"})).join(",")+"},{},["+o(v)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return b;var E=y.createObjectURL(b),S=new Worker(E);return S.objectURL=E,S}},{}],4:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.hlsDefaultConfig=void 0;var a=n(e(5)),i=n(e(6)),o=n(e(7)),s=n(e(8)),l=n(e(48));r.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:l.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:a.default,bufferController:i.default,capLevelController:o.default,fpsController:s.default,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{48:48,5:5,6:6,7:7,8:8}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=n(e(32)),d=e(28),f=e(46),h=n(e(44)),v=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING,l.default.FRAG_LOADED,l.default.FRAG_BUFFERED,l.default.ERROR));return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return o(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),u.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var r=this.hls,n=e.frag.level,a=r.levels[n].details.live,i=r.config,o=void 0,s=void 0;a?(o=i.abrEwmaFastLive,s=i.abrEwmaSlowLive):(o=i.abrEwmaFastVoD,s=i.abrEwmaSlowVoD),this._bwEstimator=new h.default(r,s,o,i.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"_abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent,n=r.loader,a=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return f.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var i=n.stats;if(t&&i&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var o=performance.now()-i.trequest,s=Math.abs(t.playbackRate);if(o>500*r.duration/s){var u=e.levels,d=Math.max(1,i.bw?i.bw/8:1e3*i.loaded/o),h=u[r.level],v=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=i.total?i.total:Math.max(i.loaded,Math.round(r.duration*v/8)),g=t.currentTime,m=(p-i.loaded)/d,y=(c.default.bufferInfo(t,g,e.config.maxBufferHole).end-g)/s;if(y<2*r.duration/s&&m>y){var b=void 0,E=void 0;for(E=r.level-1;E>a;E--){var S=u[E].realBitrate?Math.max(u[E].realBitrate,u[E].bitrate):u[E].bitrate;if((b=r.duration*S/(6.4*d))<y)break}b<m&&(f.logger.warn("loading too slow, abort fragment loading and switch to level "+E+":fragLoadedDelay["+E+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+m.toFixed(1)+":"+y.toFixed(1)),e.nextLoadLevel=E,this._bwEstimator.sample(o,i.loaded),n.abort(),this.clearTimer(),e.trigger(l.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:i}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,a=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:n,duration:a},r.realBitrate=Math.round(8*n/a)}if(e.frag.bitrateTest){var i=e.stats;i.tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,r=e.frag;if(!(!0===t.aborted||1!==r.loadCounter||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&t.tload!==t.tbuffered)){var n=t.tparsed-t.trequest;f.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(e,t,r,n,a,i,o,s,l){for(var u=a;u>=n;u--){var c=l[u].details,d=c?c.totalduration/c.fragments.length:t,h=!!c&&c.live,v=void 0;v=u<=e?o*r:s*r;var p=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,g=p*d/v;if(f.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(v)+"/"+p+"/"+d+"/"+i+"/"+g),v>p&&(!g||h&&!this.bitrateTestDelay||g<i))return u}return-1}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,a=e.minAutoLevel,i=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=i?i.currentTime:0,u=i&&0!==i.playbackRate?Math.abs(i.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(c.default.bufferInfo(i,l,n.maxBufferHole).end-l)/u,v=this._findBestLevel(o,s,d,a,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(v>=0)return v;f.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===h){var y=this.bitrateTestDelay;y&&(p=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-y,f.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=m=1)}return v=this._findBestLevel(o,s,d,a,t,h+p,g,m,r),Math.max(v,0)}}]),t}(u.default);r.default=v},{28:28,29:29,30:30,32:32,44:44,46:46}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=e(46),d=e(28),f=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return o(t,e),s(t,[{key:"destroy",value:function(){u.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(Math.abs(n.timestampOffset-e.start)>.1){var a=n.updating;try{n.abort()}catch(e){a=!0,c.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(c.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,r=e.video||e.levels.length&&e.audio,n=0;e.altAudio&&(t||r)&&(n=(t?1:0)+(r?1:0),c.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){c.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){c.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){c.logger.log("media source opened"),this.hls.trigger(l.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){c.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){c.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;c.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce((function(e,r){return r.parent===t?e+1:e}),0);this.hls.trigger(l.default.BUFFER_APPENDED,{parent:t,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){c.logger.error("sourceBuffer error:",e),this.hls.trigger(l.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var a=e[n],i=a.levelCodec||a.codec,o=a.container+";codecs="+i;c.logger.log("creating sourceBuffer("+o+")");try{var s=t[n]=r.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[n]={codec:i,container:a.container},a.buffer=s}catch(e){c.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){c.logger.error("sourceBuffer error:",e.event),this.hls.trigger(l.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,c.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}c.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){c.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&r&&0!==e.readyState&&"open"===t.readyState){for(var a in r)if(r[a].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var i=e.duration;(n>this._msDuration&&n>i||i===1/0||isNaN(i))&&(c.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){c.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void c.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var a=t[n.type];a?a.updating?r.unshift(n):(a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){c.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var i={type:d.ErrorTypes.MEDIA_ERROR,parent:n.parent};if(22===t.code)return this.segments=[],i.details=d.ErrorDetails.BUFFER_FULL_ERROR,i.fatal=!1,void e.trigger(l.default.ERROR,i);if(this.appendError?this.appendError++:this.appendError=1,i.details=d.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return c.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],i.fatal=!0,void e.trigger(l.default.ERROR,i);i.fatal=!1,e.trigger(l.default.ERROR,i)}}}}},{key:"flushBuffer",value:function(e,t,r){var n,a,i,o,s,l,u=this.sourceBuffer;if(Object.keys(u).length){if(c.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in u)if(!r||d===r){if((n=u[d]).ended=!1,n.updating)return c.logger.warn("cannot flush, sb updating in progress"),!1;try{for(a=0;a<n.buffered.length;a++)if(i=n.buffered.start(a),o=n.buffered.end(a),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(s=e,l=t):(s=Math.max(i,e),l=Math.min(o,t)),Math.min(l,o)-s>.5)return this.flushBufferCounter++,c.logger.log("flush "+d+" ["+s+","+l+"], of ["+i+","+o+"], pos:"+this.media.currentTime),n.remove(s,l),!1}catch(e){c.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else c.logger.warn("abort flushing too many retries");c.logger.log("buffer flushed")}return!0}}]),t}(u.default);r.default=f},{28:28,29:29,30:30,46:46}],7:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=function(e){function t(e){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FPS_DROP_LEVEL_CAPPING,l.default.MEDIA_ATTACHING,l.default.MANIFEST_PARSED))}return o(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var r=this;if(!this.levels)return-1;var n=this.levels.filter((function(n,a){return t.isLevelAllowed(a,r.restrictedLevels)&&a<=e}));return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var e=void 0,r=this.media;return r&&(e=r.width||r.clientWidth||r.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,r=this.media;return r&&(e=r.height||r.clientHeight||r.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"isLevelAllowed",value:function(e){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(e)}},{key:"getMaxLevelByMediaSize",value:function(e,t,r){if(!e||e&&!e.length)return-1;for(var n=e.length-1,a=0;a<e.length;a+=1){var i=e[a];if((i.width>=t||i.height>=r)&&function(e,t){return!t||e.width!==t.width||e.height!==t.height}(i,e[a+1])){n=a;break}}return n}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(n(e(29)).default);r.default=u},{29:29,30:30}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=e(46),d=function(e){function t(e){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var a=n-this.lastTime,i=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*i/a,u=this.hls;if(u.trigger(l.default.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:r}),s>0&&i>u.config.fpsDroppedMonitoringThreshold*o){var d=u.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=d)&&(d-=1,u.trigger(l.default.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,u.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(u.default);r.default=d},{29:29,30:30,46:46}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=n(e(22)),d=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHED,l.default.MEDIA_DETACHING,l.default.FRAG_PARSING_METADATA));return r.id3Track=void 0,r.media=void 0,r}return o(t,e),s(t,[{key:"destroy",value:function(){u.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(e){for(var t=e.frag,r=e.samples,n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,a=0;a<r.length;a++){var i=c.default.getID3Frames(r[a].data);if(i){var o=r[a].pts,s=a<r.length-1?r[a+1].pts:t.endPTS;o===s&&(s+=1e-4);for(var l=0;l<i.length;l++){var u=i[l];if(!c.default.isTimeStampFrame(u)){var d=new n(o,s,"");d.value=u,this.id3Track.addCue(d)}}}}}}]),t}(u.default);r.default=d},{22:22,29:29,30:30}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=e(46),d=e(28),f=n(e(32)),h=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MANIFEST_LOADED,l.default.LEVEL_LOADED,l.default.FRAG_LOADED,l.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=-1,r}return o(t,e),s(t,[{key:"destroy",value:function(){this.cleanTimer(),this._manualLevel=-1}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r=[],n=[],a={},i=!1,o=!1,s=this.hls,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),f=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach((function(e){e.videoCodec&&(i=!0),u&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(o=!0);var t=a[e.bitrate];void 0===t?(a[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)})),i&&o?r.forEach((function(e){e.videoCodec&&n.push(e)})):n=r,(n=n.filter((function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||f("audio",t))&&(!r||f("video",r))}))).length){t=n[0].bitrate,n.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=n;for(var h=0;h<n.length;h++)if(n[h].bitrate===t){this._firstLevel=h,c.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}s.trigger(l.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:o,video:i,altAudio:e.audioTracks.length>0})}else s.trigger(l.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this._level!==e){c.logger.log("switching to level "+e),this._level=e;var n=t[e];n.level=e,r.trigger(l.default.LEVEL_SWITCH,n),r.trigger(l.default.LEVEL_SWITCHING,n)}var a=t[e],i=a.details;if(!i||!0===i.live){var o=a.urlId;r.trigger(l.default.LEVEL_LOADING,{url:a.url[o],level:e,id:o})}}else r.trigger(l.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(e.fatal)e.type===d.ErrorTypes.NETWORK_ERROR&&this.cleanTimer();else{var t=e.details,r=this.hls,n=void 0,a=void 0,i=!1;switch(t){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case d.ErrorDetails.LEVEL_LOAD_ERROR:case d.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,i=!0;break;case d.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){(a=this._levels[n]).loadError?a.loadError++:a.loadError=1;var o=a.url.length;if(o>1&&a.loadError<o)a.urlId=(a.urlId+1)%o,a.details=void 0,c.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+a.urlId);else if(-1===this._manualLevel&&n)c.logger.warn("level controller,"+t+": switch-down for next fragment"),r.nextAutoLevel=Math.max(0,n-1);else if(a&&a.details&&a.details.live)c.logger.warn("level controller,"+t+" on live stream, discard"),i&&(this._level=void 0);else if(t===d.ErrorDetails.LEVEL_LOAD_ERROR||t===d.ErrorDetails.LEVEL_LOAD_TIMEOUT){var s=r.media;if(s&&f.default.isBuffered(s,s.currentTime)&&f.default.isBuffered(s,s.currentTime+.5)){var l=r.config.levelLoadingRetryDelay;c.logger.warn("level controller,"+t+", but media buffered, retry in "+l+"ms"),this.timer=setTimeout(this.ontick,l),e.levelRetry=!0}else c.logger.error("cannot recover "+t+" error"),this._level=void 0,this.cleanTimer(),e.fatal=!0}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var r=this._levels[t.level];r&&(r.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var n=e.details;if(n.live){var a=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),i=r.details;i&&n.endSN===i.endSN&&(a/=2,c.logger.log("same live playlist, reload twice faster")),a-=performance.now()-e.stats.trequest,a=Math.max(1e3,Math.round(a)),c.logger.log("live playlist, reload in "+a+" ms"),this.timer=setTimeout(this.ontick,a)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e];if(t&&t.url){var r=t.urlId;this.hls.trigger(l.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.nextAutoLevel=e)}}]),t}(u.default);r.default=h},{28:28,29:29,30:30,32:32,46:46}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(43)),u=n(e(32)),c=n(e(20)),d=n(e(30)),f=n(e(29)),h=n(e(33)),v=n(e(47)),p=e(28),g=e(46),m={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},y=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.LEVEL_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_LOAD_EMERGENCY_ABORTED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_SWITCHED,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r._state=m.STOPPED,r.ontick=r.tick.bind(r),r}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),f.default.prototype.destroy.call(this),this.state=m.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(g.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=m.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=m.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case m.ERROR:break;case m.BUFFER_FLUSHING:this.fragLoadError=0;break;case m.IDLE:this._doTickIdle();break;case m.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=m.IDLE);break;case m.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(g.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=m.IDLE);case m.ERROR:case m.STOPPED:case m.FRAG_LOADING:case m.PARSING:case m.PARSED:case m.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,r=this.media;if(void 0===this.levelLastLoaded||r||!this.startFragRequested&&t.startFragPrefetch){var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var a=e.nextLoadLevel,i=this.levels[a];if(i){var o=i.bitrate,s=void 0;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=u.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),c=l.len;if(!(c>=s)){g.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=a;var f=i.details;if(void 0===f||f.live&&this.levelLastLoaded!==a)this.state=m.WAITING_LEVEL;else{var h=this.fragPrevious;if(!f.live&&h&&h.sn===f.endSN&&c&&!l.nextStart&&Math.min(r.duration,h.start+h.duration)-Math.max(l.end,h.start)<=Math.max(.2,h.duration)){var v={};return this.altAudio&&(v.type="video"),this.hls.trigger(d.default.BUFFER_EOS,v),void(this.state=m.ENDED)}this._fetchPayloadOrEos(n,l,f)}}}}}},{key:"_fetchPayloadOrEos",value:function(e,t,r){var n=this.fragPrevious,a=this.level,i=r.fragments,o=i.length;if(0!==o){var s=i[0].start,l=i[o-1].start+i[o-1].duration,u=t.end,c=void 0;if(r.initSegment&&!r.initSegment.data)c=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(o<d)return void g.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);if(null===(c=this._ensureFragmentAtLivePoint(r,u,s,l,n,i,o)))return}else u<s&&(c=i[0]);c||(c=this._findFragment(s,n,o,i,u,l,r)),c&&this._loadFragmentOrKey(c,a,r,e,u)}}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,r,n,a,i,o){var s=this.hls.config,u=this.media,c=void 0,d=void 0!==s.liveMaxLatencyDuration?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-s.maxFragLookUpTolerance,n-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);g.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),t=f,u&&u.readyState&&u.duration>f&&(u.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>n&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(a){var h=a.sn+1;if(h>=e.startSN&&h<=e.endSN){var v=i[h-e.startSN];a.cc===v.cc&&(c=v,g.logger.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=l.default.search(i,(function(e){return a.cc-e.cc})))&&g.logger.log("live playlist, switching playlist, load frag with same CC: "+c.sn)}c||(c=i[Math.min(o-1,Math.round(o/2))],g.logger.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c}},{key:"_findFragment",value:function(e,t,r,n,a,i,o){var s=this.hls.config,u=void 0,c=void 0,d=s.maxFragLookUpTolerance,f=t?n[t.sn-n[0].sn+1]:void 0,h=function(e){var t=Math.min(d,e.duration);return e.start+e.duration-t<=a?1:e.start-t>a&&e.start?-1:0};if(a<i?(a>i-d&&(d=0),c=f&&!h(f)?f:l.default.search(n,h)):c=n[r-1],c){var v=(u=c).sn-o.startSN,p=t&&u.level===t.level,m=n[v-1],y=n[v+1];if(t&&u.sn===t.sn)if(p&&!u.backtracked)if(u.sn<o.endSN){var b=t.deltaPTS;b&&b>s.maxBufferHole&&t.dropped&&v?(u=m,g.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(u=y,g.logger.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(y&&y.backtracked?(g.logger.warn("Already backtracked from fragment "+y.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+y.sn),u=y):(g.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,m?(m.loadCounter&&m.loadCounter--,(u=m).backtracked=!0):v&&(u=null)))}return u}},{key:"_loadFragmentOrKey",value:function(e,t,r,n,a){var i=this.hls,o=i.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(g.logger.log("Loading "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t+", currentTime:"+n.toFixed(3)+",bufferEnd:"+a.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var s=o.fragLoadingLoopThreshold;if(e.loadCounter>s&&Math.abs(this.fragLoadIdx-e.loadIdx)<s)return void i.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=i.autoLevelEnabled,e.bitrateTest=this.bitrateTest,i.trigger(d.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new c.default(i,"main")),void(this.state=m.FRAG_LOADING)}g.logger.log("Loading key for "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t),this.state=m.KEY_LOADING,i.trigger(d.default.KEY_LOADING,{frag:e})}},{key:"getBufferedFrag",value:function(e){return l.default.search(this._bufferedFrags,(function(t){return e<t.startPTS?-1:e>t.endPTS?1:0}))}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),u.default.isBuffered(r,t)?e=this.getBufferedFrag(t):u.default.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(d.default.FRAG_CHANGED,{frag:n});var a=n.level;this.fragPlaying&&this.fragPlaying.level===a||this.hls.trigger(d.default.LEVEL_SWITCHED,{level:a}),this.fragPlaying=n}}}},{key:"immediateLevelSwitch",value:function(){if(g.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,u.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,(r=this.getBufferedFrag(e.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var a=this.hls.nextLoadLevel,i=this.levels[a],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*i.bitrate/(1e3*o)+1:0}if((n=this.getBufferedFrag(e.currentTime+t))&&(n=this.followingBufferedFrag(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=m.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(d.default.BUFFER_FLUSHING,r)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(g.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.loadCounter=void 0,e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,r=this.config;isNaN(t)||g.logger.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,a=u.default.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===m.FRAG_LOADING){var i=this.fragCurrent;if(0===a.len&&i){var o=r.maxFragLookUpTolerance,s=i.start-o,l=i.start+i.duration+o;t<s||t>l?(i.loader&&(g.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=m.IDLE):g.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===m.ENDED&&(0===a.len&&(this.fragPrevious=0),this.state=m.IDLE);e&&(this.lastCurrentTime=t),this.state!==m.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||g.logger.log("media seeked to "+t.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){g.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){g.logger.log("trigger BUFFER_RESET"),this.hls.trigger(d.default.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,r=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&g.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var a=this.config;(a.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(a.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,n=this.levels[r],a=t.totalduration,i=0;if(g.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),this.levelLastLoaded=r,t.live){var o=n.details;o&&t.fragments.length>0?(h.default.mergeDetails(o,t),i=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(i,o),t.PTSKnown?g.logger.log("live playlist sliding:"+i.toFixed(3)):g.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,g.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(d.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(i,t),g.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(g.logger.log("negative start time offset "+s+", count from end of last fragment"),s=i+a+s),g.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===m.WAITING_LEVEL&&(this.state=m.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===m.KEY_LOADING&&(this.state=m.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===m.FRAG_LOADING&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var n=e.stats,a=this.levels[t.level],i=a.details;if(g.logger.log("Loaded  "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=n,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=m.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=m.IDLE,n.tparsed=n.tbuffered=performance.now(),i.initSegment.data=e.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=m.PARSING;var o=i.totalduration,s=t.level,l=t.sn,u=this.config.defaultAudioCodec||a.audioCodec;this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),void 0===u&&(u=this.lastAudioCodec),u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,g.logger.log("Parsing "+l+" of ["+i.startSN+" ,"+i.endSN+"],level "+s+", cc "+t.cc);var f=this.demuxer;f||(f=this.demuxer=new c.default(this.hls,"main"));var h=this.media,v=!(h&&h.seeking)&&(i.PTSKnown||!i.live),p=i.initSegment?i.initSegment.data:[];f.push(e.payload,p,u,a.videoCodec,t,o,v,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.PARSING){var n,a,i=e.tracks;if(i.audio&&this.altAudio&&delete i.audio,a=i.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(g.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==a.container&&(o="mp4a.40.2",g.logger.log("Android: force audio codec to "+o)),a.levelCodec=o,a.id=e.id}for(n in(a=i.video)&&(a.levelCodec=this.levels[this.level].videoCodec,a.id=e.id),this.hls.trigger(d.default.BUFFER_CODECS,i),i){a=i[n],g.logger.log("main track:"+n+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var l=a.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"main"===e.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===m.PARSING){var a=this.levels[this.level],i=r;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),g.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(i.dropped=e.dropped,i.dropped){if(!i.backtracked)return g.logger.warn("missing video frame(s), backtracking fragment"),i.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=m.IDLE,this.fragPrevious=i,void this.tick();g.logger.warn("Already backtracked on this fragment, appending with the gap")}else i.backtracked=!1;var o=h.default.updateFragPTSDTS(a.details,i,e.startPTS,e.endPTS,e.startDTS,e.endDTS),s=this.hls;s.trigger(d.default.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(r){r&&r.length&&t.state===m.PARSING&&(t.appended=!0,t.pendingBuffering=!0,s.trigger(d.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))})),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===m.PARSING&&(this.stats.tparsed=performance.now(),this.state=m.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){g.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(g.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=m.IDLE}var a=this.hls;a.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),a.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(g.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,r=void 0,n=void 0,a=!1;for(var i in t){var o=t[i];"main"===o.id?(n=i,r=o,"video"===i&&(this.videoBuffer=t[i].buffer)):a=!0}a&&r?(g.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==m.PARSING&&t!==m.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==m.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;g.logger.log("main buffered : "+v.default.toString(t.buffered));var r=this._bufferedFrags.filter((function(e){return u.default.isBuffered(t,(e.startPTS+e.endPTS)/2)}));r.push(e),this._bufferedFrags=r.sort((function(e,t){return e.startPTS-t.startPTS})),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=m.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=this.media,n=r&&u.default.isBuffered(r,r.currentTime)&&u.default.isBuffered(r,r.currentTime+.5);switch(e.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var a=this.fragLoadError;a?a++:a=1;var i=this.config;if(a<=i.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=a,t.loadCounter=0;var o=Math.min(Math.pow(2,a-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);g.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=m.FRAG_LOADING_WAITING_RETRY}else g.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=m.ERROR}break;case p.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=m.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=m.ERROR));break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==m.ERROR&&(e.fatal?(this.state=m.ERROR,g.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==m.WAITING_LEVEL||(this.state=m.IDLE));break;case p.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==m.PARSING&&this.state!==m.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=m.IDLE):(g.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,g.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media,t=this.config;if(e&&e.readyState){var r=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,a=n.buffered;if(!this.loadedmetadata&&a.length){this.loadedmetadata=!0;var i=e.seeking?r:this.startPosition,o=u.default.isBuffered(n,i),s=a.start(0);(r!==i||!o&&Math.abs(i-s)<t.maxSeekHole)&&(g.logger.log("target start position:"+i),o||(i=s,g.logger.log("target start position not buffered, seek to buffered.start(0) "+i)),g.logger.log("adjust currentTime from "+r+" to "+i),e.currentTime=i)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var l=u.default.bufferInfo(e,r,0),c=!(e.paused||e.ended||0===e.buffered.length);if(r!==this.lastCurrentTime)this.stallReported&&(g.logger.warn("playback not stuck anymore @"+r+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var f=performance.now(),h=this.hls;if(this.stalled){var v=f-this.stalled,m=l.len,y=this.nudgeRetry||0;if(m<=.5&&v>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,g.logger.warn("playback stalling in low buffer @"+r),h.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m}));var b=l.nextStart,E=b-r;if(b&&E<t.maxSeekHole&&E>0){this.nudgeRetry=++y;var S=y*t.nudgeOffset;g.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+b+" + nudge "+S),e.currentTime=b+S,this.stalled=void 0,h.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:b+S-r})}}else if(m>.5&&v>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,g.logger.warn("playback stalling in high buffer @"+r),h.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m})),this.stalled=void 0,this.nudgeRetry=++y,y<t.nudgeMaxRetry){var k=e.currentTime,T=k+y*t.nudgeOffset;g.logger.log("adjust currentTime from "+k+" to "+T),e.currentTime=T,h.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else g.logger.error("still stuck in high buffer @"+r+" after "+t.nudgeMaxRetry+", raise fatal error"),h.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=f,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=m.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter((function(t){return u.default.isBuffered(e,(t.startPTS+t.endPTS)/2)})),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=m.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,g.logger.log("main stream:"+t+"->"+e),this.hls.trigger(d.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(f.default);r.default=y},{20:20,28:28,29:29,30:30,32:32,33:33,43:43,46:46,47:47}],12:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){n(this,e),this.subtle=t,this.aesIV=r}return a(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();r.default=i},{}],13:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return a(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],i=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],f=new Uint32Array(256),h=0,v=0,p=0;for(p=0;p<256;p++)f[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var m=f[h],y=f[m],b=f[y],E=257*f[g]^16843008*g;n[h]=E<<24|E>>>8,a[h]=E<<16|E>>>16,i[h]=E<<8|E>>>24,o[h]=E,E=16843009*b^65537*y^257*m^16843008*h,l[g]=E<<24|E>>>8,u[g]=E<<16|E>>>16,c[g]=E<<8|E>>>24,d[g]=E,h?(h=m^f[f[f[b^m]]],v^=f[f[v]]):h=v=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var i=this.ksRows=4*(a+6+1),o=void 0,s=void 0,l=this.keySchedule=new Uint32Array(i),u=this.invKeySchedule=new Uint32Array(i),c=this.sBox,d=this.rcon,f=this.invSubMix,h=f[0],v=f[1],p=f[2],g=f[3],m=void 0,y=void 0;for(o=0;o<i;o++)o<a?m=l[o]=t[o]:(y=m,o%a==0?(y=c[(y=y<<8|y>>>24)>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=d[o/a|0]<<24):a>6&&o%a==4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),l[o]=m=(l[o-a]^y)>>>0);for(s=0;s<i;s++)o=i-s,y=3&s?l[o]:l[o-4],u[s]=s<4||o<=4?y:h[c[y>>>24]]^v[c[y>>>16&255]]^p[c[y>>>8&255]]^g[c[255&y]],u[s]=u[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,a,i=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,l=this.invSubMix,u=l[0],c=l[1],d=l[2],f=l[3],h=this.uint8ArrayToUint32Array_(r),v=h[0],p=h[1],g=h[2],m=h[3],y=new Int32Array(e),b=new Int32Array(y.length),E=void 0,S=void 0,k=void 0,T=void 0,L=void 0,w=void 0,_=void 0,A=void 0,O=void 0,R=void 0,C=void 0,P=void 0,x=this.networkToHostOrderSwap;t<y.length;){for(O=x(y[t]),R=x(y[t+1]),C=x(y[t+2]),P=x(y[t+3]),L=O^o[0],w=P^o[1],_=C^o[2],A=R^o[3],n=4,a=1;a<i;a++)E=u[L>>>24]^c[w>>16&255]^d[_>>8&255]^f[255&A]^o[n],S=u[w>>>24]^c[_>>16&255]^d[A>>8&255]^f[255&L]^o[n+1],k=u[_>>>24]^c[A>>16&255]^d[L>>8&255]^f[255&w]^o[n+2],T=u[A>>>24]^c[L>>16&255]^d[w>>8&255]^f[255&_]^o[n+3],L=E,w=S,_=k,A=T,n+=4;E=s[L>>>24]<<24^s[w>>16&255]<<16^s[_>>8&255]<<8^s[255&A]^o[n],S=s[w>>>24]<<24^s[_>>16&255]<<16^s[A>>8&255]<<8^s[255&L]^o[n+1],k=s[_>>>24]<<24^s[A>>16&255]<<16^s[L>>8&255]<<8^s[255&w]^o[n+2],T=s[A>>>24]<<24^s[L>>16&255]<<16^s[w>>8&255]<<8^s[255&_]^o[n+3],n+=3,b[t]=x(E^v),b[t+1]=x(T^p),b[t+2]=x(k^g),b[t+3]=x(S^m),v=O,p=R,g=C,m=P,t+=4}return b.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();r.default=i},{}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(12)),s=n(e(15)),l=n(e(13)),u=e(28),c=e(46),d=function(){function e(t,r){a(this,e),this.observer=t,this.config=r,this.logEnabled=!0;try{var n=crypto||self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return i(e,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(e,t,r,n){var a=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(c.logger.log("JS AES decrypt"),this.logEnabled=!1);var i=this.decryptor;i||(this.decryptor=i=new l.default),i.expandKey(t),n(i.decrypt(e,0,r))}else{this.logEnabled&&(c.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new s.default(u,t)),this.fastAesKey.expandKey().then((function(i){new o.default(u,r).decrypt(e,i).catch((function(i){a.onWebCryptoError(i,e,t,r,n)})).then((function(e){n(e)}))})).catch((function(i){a.onWebCryptoError(i,e,t,r,n)}))}}},{key:"onWebCryptoError",value:function(e,t,r,n,a){this.config.enableSoftwareAES?(c.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,a)):(c.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();r.default=d},{12:12,13:13,15:15,28:28,46:46}],15:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){n(this,e),this.subtle=t,this.key=r}return a(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();r.default=i},{}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(17)),s=e(46),l=n(e(22)),u=function(){function e(t,r,n){a(this,e),this.observer=t,this.config=n,this.remuxer=r}return i(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var a=this._audioTrack,i=l.default.getID3Data(e,0),u=90*l.default.getTimeStamp(i),c=0,d=u,f=e.length,h=i.length,v=[{pts:d,dts:d,data:i}];h<f-1;)if(o.default.isHeader(e,h)&&h+5<f){o.default.initTrackConfig(a,this.observer,e,h,a.manifestCodec);var p=o.default.appendFrame(a,e,h,u,c);if(!p){s.logger.log("Unable to parse AAC frame");break}h+=p.length,d=p.sample.pts,c++}else l.default.isHeader(e,h)?(i=l.default.getID3Data(e,h),v.push({pts:d,dts:d,data:i}),h+=i.length):h++;this.remuxer.remux(a,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=l.default.getID3Data(e,0);if(n&&void 0!==l.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(o.default.probe(e,t))return s.logger.log("ADTS sync word found !"),!0;return!1}}]),e}();r.default=u},{17:17,22:22,46:46}],17:[function(e,t,r){"use strict";var n=e(46),a=e(28),i={getAudioConfig:function(e,t,r,i){var o,s,l,u,c,d=navigator.userAgent.toLowerCase(),f=i,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((s=(60&t[r+2])>>>2)>h.length-1))return u=(1&t[r+2])<<2,u|=(192&t[r+3])>>>6,n.logger.log("manifest codec:"+i+",ADTS data:type:"+o+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+u),/firefox/i.test(d)?s>=6?(o=5,c=new Array(4),l=s-3):(o=2,c=new Array(2),l=s):-1!==d.indexOf("android")?(o=2,c=new Array(2),l=s):(o=5,c=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&s>=6?l=s-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(s>=6&&1===u||/vivaldi/i.test(d))||!i&&1===u)&&(o=2,c=new Array(2)),l=s)),c[0]=o<<3,c[0]|=(14&s)>>1,c[1]|=(1&s)<<7,c[1]|=u<<3,5===o&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[s],channelCount:u,codec:"mp4a.40."+o,manifestCodec:f};e.trigger(Event.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s})},isHeaderPattern:function(e,t){return 255===e[t]&&240==(246&e[t+1])},getHeaderLength:function(e,t){return 1&e[t+1]?7:9},getFullFrameLength:function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.getHeaderLength(e,t);t+5<e.length&&(r=this.getFullFrameLength(e,t));var n=t+r;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1},initTrackConfig:function(e,t,r,a,i){if(!e.samplerate){var o=this.getAudioConfig(t,r,a,i);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},getFrameDuration:function(e){return 9216e4/e},appendFrame:function(e,t,r,n,a){var i=this.getFrameDuration(e.samplerate),o=this.parseFrameHeader(t,r,n,a,i);if(o){var s=o.stamp,l=o.headerLength,u=o.frameLength,c={unit:t.subarray(r+l,r+l+u),pts:s,dts:s};return e.samples.push(c),e.len+=u,{sample:c,length:u+l}}},parseFrameHeader:function(e,t,r,n,a){var i,o,s=e.length;if(i=this.getHeaderLength(e,t),o=this.getFullFrameLength(e,t),(o-=i)>0&&t+i+o<=s)return{headerLength:i,frameLength:o,stamp:r+n*a}}};t.exports=i},{28:28,46:46}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(30)),s=e(28),l=n(e(14)),u=n(e(16)),c=n(e(24)),d=n(e(27)),f=n(e(23)),h=n(e(40)),v=n(e(41)),p=function(){function e(t,r,n,i){a(this,e),this.observer=t,this.typeSupported=r,this.config=n,this.vendor=i}return i(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,n,a,i,s,u,c,d,f,h){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var v=this.decrypter;null==v&&(v=this.decrypter=new l.default(this.observer,this.config));var p,g=this;try{p=performance.now()}catch(e){p=Date.now()}v.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var l;try{l=performance.now()}catch(e){l=Date.now()}g.observer.trigger(o.default.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:l}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,a,i,s,u,c,d,f,h)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,a,i,s,u,c,d,f,h)}},{key:"pushDecrypted",value:function(e,t,r,n,a,i,l,p,g,m,y,b){var E=this.demuxer;if(!E||l&&!this.probe(e)){for(var S=this.observer,k=this.typeSupported,T=this.config,L=[{demux:u.default,remux:h.default},{demux:f.default,remux:h.default},{demux:d.default,remux:h.default},{demux:c.default,remux:v.default}],w=0,_=L.length;w<_;w++){var A=L[w],O=A.demux.probe;if(O(e)){var R=this.remuxer=new A.remux(S,T,k,this.vendor);E=new A.demux(S,R,T,k),this.probe=O;break}}if(!E)return void S.trigger(o.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=E}var C=this.remuxer;(l||p)&&(E.resetInitSegment(r,n,a,m),C.resetInitSegment()),l&&(E.resetTimeStamp(b),C.resetTimeStamp(b)),"function"==typeof E.setDecryptData&&E.setDecryptData(t),E.append(e,i,g,y)}}]),e}();r.default=p},{14:14,16:16,23:23,24:24,27:27,28:28,30:30,40:40,41:41}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=n(e(18)),i=n(e(30)),o=e(46),s=n(e(1));r.default=function(e){var t=new s.default;t.trigger=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",(function(n){var i=n.data;switch(i.cmd){case"init":var s=JSON.parse(i.config);e.demuxer=new a.default(t,i.typeSupported,s,i.vendor);try{(0,o.enableLogs)(!0===s.debug)}catch(e){}r("init",null);break;case"demux":e.demuxer.push(i.data,i.decryptdata,i.initSegment,i.audioCodec,i.videoCodec,i.timeOffset,i.discontinuity,i.trackSwitch,i.contiguous,i.duration,i.accurateTimeOffset,i.defaultInitPTS)}})),t.on(i.default.FRAG_DECRYPTED,r),t.on(i.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(i.default.FRAG_PARSED,r),t.on(i.default.ERROR,r),t.on(i.default.FRAG_PARSING_METADATA,r),t.on(i.default.FRAG_PARSING_USERDATA,r),t.on(i.default.INIT_PTS_FOUND,r),t.on(i.default.FRAG_PARSING_DATA,(function(t,r){var n=[],a={event:t,data:r};r.data1&&(a.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(a.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(a,n)}))}},{1:1,18:18,30:30,46:46}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(30)),s=n(e(18)),l=n(e(19)),u=e(46),c=e(28),d=n(e(1)),f=function(){function t(r,n){a(this,t),this.hls=r,this.id=n;var i=this.observer=new d.default,f=r.config;i.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(r))},i.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(r))};var h=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,r.trigger(e,t)}.bind(this);i.on(o.default.FRAG_DECRYPTED,h),i.on(o.default.FRAG_PARSING_INIT_SEGMENT,h),i.on(o.default.FRAG_PARSING_DATA,h),i.on(o.default.FRAG_PARSED,h),i.on(o.default.ERROR,h),i.on(o.default.FRAG_PARSING_METADATA,h),i.on(o.default.FRAG_PARSING_USERDATA,h),i.on(o.default.INIT_PTS_FOUND,h);var v={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(f.enableWorker&&"undefined"!=typeof Worker){u.logger.log("demuxing in webworker");var g=void 0;try{var m=e(3);g=this.w=m(l.default),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener("message",this.onwmsg),g.onerror=function(e){r.trigger(o.default.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},g.postMessage({cmd:"init",typeSupported:v,vendor:p,id:n,config:JSON.stringify(f)})}catch(e){u.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),g&&URL.revokeObjectURL(g.objectURL),this.demuxer=new s.default(i,v,f,p),this.w=void 0}}else this.demuxer=new s.default(i,v,f,p)}return i(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)}},{key:"push",value:function(e,t,r,n,a,i,o,s){var l=this.w,c=isNaN(a.startDTS)?a.start:a.startDTS,d=a.decryptdata,f=this.frag,h=!(f&&a.cc===f.cc),v=!(f&&a.level===f.level),p=f&&a.sn===f.sn+1,g=!v&&p;if(h&&u.logger.log(this.id+":discontinuity detected"),v&&u.logger.log(this.id+":switch detected"),this.frag=a,l)l.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:c,discontinuity:h,trackSwitch:v,contiguous:g,duration:i,accurateTimeOffset:o,defaultInitPTS:s},[e]);else{var m=this.demuxer;m&&m.push(e,d,t,r,n,c,h,v,g,i,o,s)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,r=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case o.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}}}]),t}();r.default=f},{1:1,18:18,19:19,28:28,3:3,30:30,46:46}],21:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(46),o=function(){function e(t){n(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return a(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n}},{key:"readSPS",value:function(){var e,t,r,n,a,i,o,s=0,l=0,u=0,c=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),v=this.readBoolean.bind(this),p=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),f(5),p(3),d(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&p(1),m(),m(),p(1),v())for(i=3!==b?8:12,o=0;o<i;o++)v()&&y(o<6?16:64)}m();var E=h();if(0===E)h();else if(1===E)for(p(1),g(),g(),t=h(),o=0;o<t;o++)g();m(),p(1),r=h(),n=h(),0===(a=f(1))&&p(1),p(1),v()&&(s=h(),l=h(),u=h(),c=h());var S=[1,1];if(v()&&v())switch(d()){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:S=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-a)*(n+1)*16-(a?2:4)*(u+c),pixelRatio:S}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();r.default=o},{46:46}],22:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return a(e,null,[{key:"isHeader",value:function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"isFooter",value:function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"getID3Data",value:function(t,r){for(var n=r,a=0;e.isHeader(t,r);)a+=10,a+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(a+=10),r+=a;if(a>0)return t.subarray(n,n+a)}},{key:"_readSize",value:function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]}},{key:"getTimeStamp",value:function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var a=r[n];if(e.isTimeStampFrame(a))return e._readTimeStamp(a)}}},{key:"isTimeStampFrame",value:function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}},{key:"_getFrameData",value:function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}}},{key:"getID3Frames",value:function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var a=e._readSize(t,r+6),i=(r+=10)+a;r+8<i;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n}},{key:"_decodeFrame",value:function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0}},{key:"_readTimeStamp",value:function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}},{key:"_decodePrivFrame",value:function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}}},{key:"_decodeTextFrame",value:function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:i}}}},{key:"_decodeURLFrame",value:function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var a=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:a}}var i=e._utf8ArrayToStr(t.data);return{key:t.type,data:i}}},{key:"_utf8ArrayToStr",value:function(e){for(var t=void 0,r=void 0,n="",a=0,i=e.length;a<i;){var o=e[a++];switch(o>>4){case 0:return n;case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(o);break;case 12:case 13:t=e[a++],n+=String.fromCharCode((31&o)<<6|63&t);break;case 14:t=e[a++],r=e[a++],n+=String.fromCharCode((15&o)<<12|(63&t)<<6|(63&r)<<0)}}return n}}]),e}();r.default=i},{}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(22)),s=e(46),l=n(e(25)),u=function(){function e(t,r,n){a(this,e),this.observer=t,this.config=n,this.remuxer=r}return i(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var a=o.default.getID3Data(e,0),i=90*o.default.getTimeStamp(a),s=a.length,u=e.length,c=0,d=0,f=this._audioTrack,h=[{pts:i,dts:i,data:a}];s<u;)if(l.default.isHeader(e,s)){var v=l.default.appendFrame(f,e,s,i,c);if(!v)break;s+=v.length,d=v.sample.pts,c++}else o.default.isHeader(e,s)?(a=o.default.getID3Data(e,s),h.push({pts:d,dts:d,data:a}),s+=a.length):s++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=o.default.getID3Data(e,0);if(n&&void 0!==o.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(l.default.probe(e,t))return s.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),e}();r.default=u},{22:22,25:25,46:46}],24:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e(30)),o=Math.pow(2,32)-1,s=function(){function e(t,r){n(this,e),this.observer=t,this.remuxer=r}return a(e,[{key:"resetTimeStamp",value:function(e){this.initPTS=e}},{key:"resetInitSegment",value:function(t,r,n,a){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t),s={};o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:a?t:null}),this.observer.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)}},{key:"append",value:function(t,r,n,a){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),o=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(o,t);this.initPTS=l=u-r,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,n,a,t)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(t){if(t.length>=8){var r=e.bin2str(t.subarray(4,8));return["moof","ftyp","styp"].indexOf(r)>=0}return!1}},{key:"bin2str",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"readUint32",value:function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r}},{key:"writeUint32",value:function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}},{key:"findBox",value:function(t,r){var n,a,i,o,s,l,u=[];if(t.data?(s=t.start,i=t.end,t=t.data):(s=0,i=t.byteLength),!r.length)return null;for(n=s;n<i;)l=(a=e.readUint32(t,n))>1?n+a:i,e.bin2str(t.subarray(n+4,n+8))===r[0]&&(1===r.length?u.push({data:t,start:n+8,end:l}):(o=e.findBox({data:t,start:n+8,end:l},r.slice(1))).length&&(u=u.concat(o))),n=l;return u}},{key:"parseInitSegment",value:function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var a=n.data[n.start],i=0===a?12:20,o=e.readUint32(n,i),s=e.findBox(t,["mdia","mdhd"])[0];if(s){i=0===(a=s.data[s.start])?12:20;var l=e.readUint32(s,i),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];c&&(r[o]={timescale:l,type:c},r[c]={timescale:l,id:o})}}}})),r}},{key:"getStartDTS",value:function(t,r){var n,a,i;return n=e.findBox(r,["moof","traf"]),a=[].concat.apply([],n.map((function(r){return e.findBox(r,["tfhd"]).map((function(n){var a,i,o;return a=e.readUint32(n,4),i=t[a].timescale||9e4,o=e.findBox(r,["tfdt"]).map((function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0],(o=o||1/0)/i}))}))),i=Math.min.apply(null,a),isFinite(i)?i:0}},{key:"offsetStartDTS",value:function(t,r,n){e.findBox(r,["moof","traf"]).map((function(r){return e.findBox(r,["tfhd"]).map((function(a){var i=e.readUint32(a,4),s=t[i].timescale||9e4;e.findBox(r,["tfdt"]).map((function(t){var r=t.data[t.start],a=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,a-n*s);else{a*=Math.pow(2,32),a+=e.readUint32(t,8),a-=n*s;var i=Math.floor(a/(o+1)),l=Math.floor(a%(o+1));e.writeUint32(t,4,i),e.writeUint32(t,8,l)}}))}))}))}}]),e}();r.default=s},{30:30}],25:[function(e,t,r){"use strict";var n={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(e,t,r,n,a){if(!(r+24>t.length)){var i=this.parseHeader(t,r);if(i&&r+i.frameLength<=t.length){var o=n+a*(10368e4/i.sampleRate),s={unit:t.subarray(r,r+i.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(s),e.len+=i.frameLength,{sample:s,length:i.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3,s=!!(2&e[t+2]);if(1!==r&&0!==i&&15!==i&&3!==o){var l=3===r?3-a:3===a?3:4,u=1e3*n.BitratesMap[14*l+i-1],c=3===r?0:2===r?1:2,d=n.SamplingRateMap[3*c+o],f=s?1:0;return{sampleRate:d,channelCount:e[t+3]>>6==3?1:2,frameLength:3===a?(3===r?12:6)*u/d+f<<2:(3===r?144:72)*u/d+f|0}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var a=t+n;if(a===e.length||a+1<e.length&&this.isHeaderPattern(e,a))return!0}return!1}};t.exports=n},{}],26:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e(14)),o=function(){function e(t,r,a,o){n(this,e),this.decryptdata=a,this.discardEPB=o,this.decrypter=new i.default(t,r)}return a(e,[{key:"decryptBuffer",value:function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)}},{key:"decryptAacSample",value:function(e,t,r,n){var a=e[t].unit,i=a.subarray(16,a.length-a.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length),s=this;this.decryptBuffer(o,(function(i){i=new Uint8Array(i),a.set(i,16),n||s.decryptAacSamples(e,t+1,r)}))}},{key:"decryptAacSamples",value:function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,a=32;a<=e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r}},{key:"getAvcDecryptedUnit",value:function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e}},{key:"decryptAvcSample",value:function(e,t,r,n,a,i){var o=this.discardEPB(a.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,(function(s){a.data=l.getAvcDecryptedUnit(o,s),i||l.decryptAvcSamples(e,t,r+1,n)}))}},{key:"decryptAvcSamples",value:function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var a=e[t].units;!(r>=a.length);r++){var i=a[r];if(!(i.length<=48||1!==i.type&&5!==i.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,i,o),!o)return}}}}}]),e}();r.default=o},{14:14}],27:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(17)),s=n(e(25)),l=n(e(30)),u=n(e(21)),c=n(e(26)),d=e(46),f=e(28),h=function(){function e(t,r,n,i){a(this,e),this.observer=t,this.config=n,this.typeSupported=i,this.remuxer=r,this.sampleAes=null}return i(e,[{key:"setDecryptData",value:function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new c.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:n,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=n}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){var a,i,o,s,u,c=e.length,h=!1;this.contiguous=r;var v=this.pmtParsed,p=this._avcTrack,g=this._audioTrack,m=this._id3Track,y=p.id,b=g.id,E=m.id,S=this._pmtId,k=p.pesData,T=g.pesData,L=m.pesData,w=this._parsePAT,_=this._parsePMT,A=this._parsePES,O=this._parseAVCPES.bind(this),R=this._parseAACPES.bind(this),C=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this);for(c-=c%188,a=0;a<c;a+=188)if(71===e[a]){if(i=!!(64&e[a+1]),o=((31&e[a+1])<<8)+e[a+2],(48&e[a+3])>>4>1){if((s=a+5+e[a+4])===a+188)continue}else s=a+4;switch(o){case y:i&&(k&&(u=A(k))&&O(u,!1),k={data:[],size:0}),k&&(k.data.push(e.subarray(s,a+188)),k.size+=a+188-s);break;case b:i&&(T&&(u=A(T))&&(g.isAAC?R(u):C(u)),T={data:[],size:0}),T&&(T.data.push(e.subarray(s,a+188)),T.size+=a+188-s);break;case E:i&&(L&&(u=A(L))&&P(u),L={data:[],size:0}),L&&(L.data.push(e.subarray(s,a+188)),L.size+=a+188-s);break;case 0:i&&(s+=e[s]+1),S=this._pmtId=w(e,s);break;case S:i&&(s+=e[s]+1);var x=_(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(y=x.avc)>0&&(p.id=y),(b=x.audio)>0&&(g.id=b,g.isAAC=x.isAAC),(E=x.id3)>0&&(m.id=E),h&&!v&&(d.logger.log("reparse from beginning"),h=!1,a=-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:h=!0}}else this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});k&&(u=A(k))?(O(u,!0),p.pesData=null):p.pesData=k,T&&(u=A(T))?(g.isAAC?R(u):C(u),g.pesData=null):(T&&T.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),g.pesData=T),L&&(u=A(L))?(P(u),m.pesData=null):m.pesData=L,null==this.sampleAes?this.remuxer.remux(g,p,m,this._txtTrack,t,r,n):this.decryptAndRemux(g,p,m,this._txtTrack,t,r,n)}},{key:"decryptAndRemux",value:function(e,t,r,n,a,i,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){s.decryptAndRemuxAvc(e,t,r,n,a,i,o)}))}else this.decryptAndRemuxAvc(e,t,r,n,a,i,o)}},{key:"decryptAndRemuxAvc",value:function(e,t,r,n,a,i,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){s.remuxer.remux(e,t,r,n,a,i,o)}))}else this.remuxer.remux(e,t,r,n,a,i,o)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,r,n){var a,i,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(a=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){switch(i=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){d.logger.log("unkown stream type:"+e[t]);break}case 15:-1===o.audio&&(o.audio=i);break;case 21:-1===o.id3&&(o.id3=i);break;case 219:if(!n){d.logger.log("unkown stream type:"+e[t]);break}case 27:-1===o.avc&&(o.avc=i);break;case 3:case 4:r?-1===o.audio&&(o.audio=i,o.isAAC=!1):d.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:d.logger.warn("HEVC stream type found, not supported for now");break;default:d.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return o}},{key:"_parsePES",value:function(e){var t,r,n,a,i,o,s,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var f=new Uint8Array(c[0].length+c[1].length);f.set(c[0]),f.set(c[1],c[0].length),c[0]=f,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&((o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(o-=8589934592),64&r?((s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592),o-s>54e5&&(d.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),l=(a=t[8])+9,e.size-=l,i=new Uint8Array(e.size);for(var h=0,v=c.length;h<v;h++){var p=(t=c[h]).byteLength;if(l){if(l>p){l-=p;continue}t=t.subarray(l),p-=l,l=0}i.set(t,u),u+=p}return n&&(n-=a+3),{data:i,pts:o,dts:s,len:n}}return null}},{key:"pushAccesUnit",value:function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&d.logger.log(e.pts+"/"+e.dts+":"+e.debug)}},{key:"_parseAVCPES",value:function(e,t){var r,n,a,i=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),l=this.avcSample,c=!1,d=this.pushAccesUnit.bind(this),f=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,l&&s.length&&(d(l,o),l=this.avcSample=f(!1,e.pts,e.dts,"")),s.forEach((function(t){switch(t.type){case 1:n=!0,l.frame=!0;var s=t.data;if(c&&s.length>4){var h=new u.default(s).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=i.avcSample=f(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(r=new u.default(i.discardEPB(t.data))).readUByte();for(var v=0,p=0,g=!1,m=0;!g&&r.bytesAvailable>1;){v=0;do{v+=m=r.readUByte()}while(255===m);p=0;do{p+=m=r.readUByte()}while(255===m);if(4===v&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var y=r.readUByte(),b=31&y,E=[y,r.readUByte()];for(a=0;a<b;a++)E.push(r.readUByte()),E.push(r.readUByte()),E.push(r.readUByte());i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:e.pts,bytes:E})}}else if(p<r.bytesAvailable)for(a=0;a<p;a++)r.readUByte()}break;case 7:if(n=!0,c=!0,!o.sps){var S=(r=new u.default(t.data)).readSPS();o.width=S.width,o.height=S.height,o.pixelRatio=S.pixelRatio,o.sps=[t.data],o.duration=i._duration;var k=t.data.subarray(1,4),T="avc1.";for(a=0;a<3;a++){var L=k[a].toString(16);L.length<2&&(L="0"+L),T+=L}o.codec=T}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,l&&d(l,o),l=i.avcSample=f(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&n&&l.units.push(t)})),t&&l&&(d(l,o),this.avcSample=null)}},{key:"_insertSampleInOrder",value:function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,r,n,a,i=0,o=e.byteLength,s=this._avcTrack,l=s.naluState||0,u=l,c=[],d=-1;for(-1===l&&(d=0,a=31&e[0],l=0,i=1);i<o;)if(t=e[i++],l)if(1!==l)if(t)if(1===t){if(d>=0)n={data:e.subarray(d,i-l-1),type:a},c.push(n);else{var f=this._getLastNalUnit();if(f&&(u&&i<=4-u&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-u)),(r=i-l-1)>0)){var h=new Uint8Array(f.data.byteLength+r);h.set(f.data,0),h.set(e.subarray(0,r),f.data.byteLength),f.data=h}}i<o?(d=i,a=31&e[i],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(d>=0&&l>=0&&(n={data:e.subarray(d,o),type:a,state:l},c.push(n)),0===c.length){var v=this._getLastNalUnit();if(v){var p=new Uint8Array(v.data.byteLength+e.byteLength);p.set(v.data,0),p.set(e,v.data.byteLength),v.data=p}}return s.naluState=l,c}},{key:"discardEPB",value:function(e){for(var t,r,n=e.byteLength,a=[],i=1;i<n-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(a.push(i+2),i+=2):i++;if(0===a.length)return e;t=n-a.length,r=new Uint8Array(t);var o=0;for(i=0;i<t;o++,i++)o===a[0]&&(o++,a.shift()),r[i]=e[o];return r}},{key:"_parseAACPES",value:function(e){var t,r,n,a,i,s,u,c=this._audioTrack,h=e.data,v=e.pts,p=this.aacOverFlow,g=this.aacLastPTS;if(p){var m=new Uint8Array(p.byteLength+h.byteLength);m.set(p,0),m.set(h,p.byteLength),h=m}for(n=0,i=h.length;n<i-1&&!o.default.isHeader(h,n);n++);if(!n||(n<i-1?(s="AAC PES did not start with ADTS header,offset:"+n,u=!1):(s="no ADTS header found in AAC PES",u=!0),d.logger.warn("parsing error:"+s),this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:u,reason:s}),!u)){if(o.default.initTrackConfig(c,this.observer,h,n,this.audioCodec),r=0,t=o.default.getFrameDuration(c.samplerate),p&&g){var y=g+t;Math.abs(y-v)>1&&(d.logger.log("AAC: align PTS for overlapping frames by "+Math.round((y-v)/90)),v=y)}for(;n<i;)if(o.default.isHeader(h,n)&&n+5<i){var b=o.default.appendFrame(c,h,n,v,r);if(!b)break;n+=b.length,a=b.sample.pts,r++}else n++;p=n<i?h.subarray(n,i):null,this.aacOverFlow=p,this.aacLastPTS=a}}},{key:"_parseMPEGPES",value:function(e){for(var t=e.data,r=t.length,n=0,a=0,i=e.pts;a<r;)if(s.default.isHeader(t,a)){var o=s.default.appendFrame(this._audioTrack,t,a,i,n);if(!o)break;a+=o.length,n++}else a++}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();r.default=h},{17:17,21:21,25:25,26:26,28:28,30:30,46:46}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],29:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e(46),s=e(28),l=function(e){return e&&e.__esModule?e:{default:e}}(e(30)),u=function(){function e(t){n(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];this.handledEvents=a,this.useGenericHandler=!0,this.registerListeners()}return i(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}),this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){o.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(l.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();r.default=u},{28:28,30:30,46:46}],30:[function(e,t,r){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],31:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return a(e,null,[{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();r.default=i},{}],32:[function(e,t,r){"use strict";var n={isBuffered:function(e,t){if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0;return!1},bufferInfo:function(e,t,r){if(e){var n,a=e.buffered,i=[];for(n=0;n<a.length;n++)i.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(i,t,r)}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,r){var n,a,i,o,s,l=[];for(e.sort((function(e,t){return e.start-t.start||t.end-e.end})),s=0;s<e.length;s++){var u=l.length;if(u){var c=l[u-1].end;e[s].start-c<r?e[s].end>c&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,n=0,a=i=t;s<l.length;s++){var d=l[s].start,f=l[s].end;if(t+r>=d&&t<f)a=d,n=(i=f)-t;else if(t+r<d){o=d;break}}return{len:n,start:a,end:i,nextStart:o}}};t.exports=n},{}],33:[function(e,t,r){"use strict";var n=e(46),a={mergeDetails:function(e,t){var r,i=Math.max(e.startSN,t.startSN)-t.startSN,o=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,l=e.fragments,u=t.fragments,c=0;if(o<i)t.PTSKnown=!1;else{for(var d=i;d<=o;d++){var f=l[s+d],h=u[d];h&&f&&(c=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,h.backtracked=f.backtracked,h.dropped=f.dropped,r=h))}if(c)for(n.logger.log("discontinuity sliding from playlist, take drift into account"),d=0;d<u.length;d++)u[d].cc+=c;if(r)a.updateFragPTSDTS(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<l.length){var v=l[s].start;for(d=0;d<u.length;d++)u[d].start+=v}t.PTSKnown=e.PTSKnown}},updateFragPTSDTS:function(e,t,r,n,i,o){var s=r;if(!isNaN(t.startPTS)){var l=Math.abs(t.startPTS-r);isNaN(t.deltaPTS)?t.deltaPTS=l:t.deltaPTS=Math.max(l,t.deltaPTS),s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),n=Math.max(n,t.endPTS),i=Math.min(i,t.startDTS),o=Math.max(o,t.endDTS)}var u=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=n,t.startDTS=i,t.endDTS=o,t.duration=n-r;var c,d,f,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;for(c=h-e.startSN,(d=e.fragments)[c]=t,f=c;f>0;f--)a.updatePTS(d,f,f-1);for(f=c;f<d.length-1;f++)a.updatePTS(d,f,f+1);return e.PTSKnown=!0,u},updatePTS:function(e,t,r){var a=e[t],i=e[r],o=i.startPTS;isNaN(o)?i.start=r>t?a.start+a.duration:Math.max(a.start-i.duration,0):r>t?(a.duration=o-a.start,a.duration<0&&n.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(i.duration=a.start-o,i.duration<0&&n.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}};t.exports=a},{46:46}],34:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(2)),s=n(e(30)),l=e(28),u=n(e(38)),c=n(e(36)),d=n(e(37)),f=n(e(11)),h=n(e(10)),v=n(e(9)),p=e(46),g=n(e(1)),m=e(4),y=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e);var n=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in n)i in r||(r[i]=n[i]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,p.enableLogs)(r.debug),this.config=r,this._autoLevelCapping=-1;var o=this.observer=new g.default;o.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o.emit.apply(o,[e,e].concat(r))},o.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o.removeListener.apply(o,[e].concat(r))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o);var s=this.abrController=new r.abrController(this),l=new r.bufferController(this),m=new r.capLevelController(this),y=new r.fpsController(this),b=new u.default(this),E=new c.default(this),S=new d.default(this),k=new v.default(this),T=[this.levelController=new h.default(this),this.streamController=new f.default(this)],L=r.audioStreamController;L&&T.push(new L(this)),this.networkControllers=T;var w=[b,E,S,s,l,m,y,k];if(L=r.audioTrackController){var _=new L(this);this.audioTrackController=_,w.push(_)}if(L=r.subtitleTrackController){var A=new L(this);this.subtitleTrackController=A,w.push(A)}[r.subtitleStreamController,r.timelineController].forEach((function(e){e&&w.push(new e(t))})),this.coreComponents=w}return i(e,null,[{key:"isSupported",value:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return r&&n}},{key:"version",get:function(){return"0.7.11"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:m.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),i(e,[{key:"destroy",value:function(){p.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(e){p.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){p.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){e=o.default.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),p.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;p.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))}},{key:"stopLoad",value:function(){p.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))}},{key:"swapAudioCodec",value:function(){p.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){p.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){p.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){p.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){p.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){p.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){p.logger.log("set startLevel:"+e);var t=this;-1!==e&&(e=Math.max(e,t.minAutoLevel)),t.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){p.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this,t=e.levels,r=e.config.minAutoBitrate,n=t?t.length:0,a=0;a<n;a++)if((t[a].realBitrate?Math.max(t[a].realBitrate,t[a].bitrate):t[a].bitrate)>r)return a;return 0}},{key:"maxAutoLevel",get:function(){var e=this,t=e.levels,r=e.autoLevelCapping;return-1===r&&t&&t.length?t.length-1:r}},{key:"nextAutoLevel",get:function(){var e=this;return Math.min(Math.max(e.abrController.nextAutoLevel,e.minAutoLevel),e.maxAutoLevel)},set:function(e){var t=this;t.abrController.nextAutoLevel=Math.max(t.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();r.default=y},{1:1,10:10,11:11,2:2,28:28,30:30,36:36,37:37,38:38,4:4,46:46,9:9}],35:[function(e,t,r){"use strict";t.exports=e(34).default},{34:34}],36:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=e(28),d=e(46),f=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING));return r.loaders={},r}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},u.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],a=this.hls.config;t.loaded=0,n&&(d.logger.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=t.loader=void 0!==a.fLoader?new a.fLoader(a):new a.loader(a);var i=void 0,o=void 0,s=void 0;i={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,u=t.byteRangeEndOffset;isNaN(l)||isNaN(u)||(i.rangeStart=l,i.rangeEnd=u),o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(i,o,s)}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.data,i=r.frag;i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(l.default.FRAG_LOADED,{payload:a,frag:i,stats:t,networkDetails:n})}},{key:"loaderror",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})}},{key:"loadtimeout",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})}},{key:"loadprogress",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.frag;a.loaded=e.loaded,this.hls.trigger(l.default.FRAG_LOAD_PROGRESS,{frag:a,stats:e,networkDetails:n})}}]),t}(u.default);r.default=f},{28:28,29:29,30:30,46:46}],37:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(30)),u=n(e(29)),c=e(28),d=e(46),f=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],a=t.decryptdata,i=a.uri;if(i!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;n&&(d.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new o.loader(o),this.decrypturl=i,this.decryptkey=null;var s=void 0,u=void 0,c=void 0;s={url:i,frag:t,responseType:"arraybuffer"},u={timeout:o.fragLoadingTimeOut,maxRetry:o.fragLoadingMaxRetry,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,u,c)}else this.decryptkey&&(a.key=this.decryptkey,this.hls.trigger(l.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(l.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})}}]),t}(u.default);r.default=f},{28:28,29:29,30:30,46:46}],38:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(e(2)),u=n(e(30)),c=n(e(29)),d=e(28),f=n(e(42)),h=e(46),v=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,p=/#EXT-X-MEDIA:(.*)/g,g=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),m=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,y=function(){function e(){o(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return s(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=l.default.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),b=function(){function e(){o(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return s(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new y).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=l.default.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),E=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING));return r.loaders={},r}return i(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},c.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"onSubtitleTrackLoading",value:function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})}},{key:"load",value:function(e,t){var r=this.loaders[t.type];if(r){var n=r.context;if(n&&n.url===e)return void h.logger.trace("playlist request ongoing");h.logger.warn("abort previous loader for type:"+t.type),r.abort()}var a=this.hls.config,i=void 0,o=void 0,s=void 0,l=void 0;"manifest"===t.type?(i=a.manifestLoadingMaxRetry,o=a.manifestLoadingTimeOut,s=a.manifestLoadingRetryDelay,l=a.manifestLoadingMaxRetryTimeout):(i=a.levelLoadingMaxRetry,o=a.levelLoadingTimeOut,s=a.levelLoadingRetryDelay,l=a.levelLoadingMaxRetryTimeout,h.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),r=this.loaders[t.type]=t.loader=void 0!==a.pLoader?new a.pLoader(a):new a.loader(a),t.url=e,t.responseType="";var u=void 0,c=void 0;u={timeout:o,maxRetry:i,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,u,c)}},{key:"resolve",value:function(e,t){return l.default.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(e,t){var r=[],n=void 0;for(v.lastIndex=0;null!=(n=v.exec(e));){var a={},i=a.attrs=new f.default(n[1]);a.url=this.resolve(n[2],t);var o=i.decimalResolution("RESOLUTION");o&&(a.width=o.width,a.height=o.height),a.bitrate=i.decimalInteger("AVERAGE-BANDWIDTH")||i.decimalInteger("BANDWIDTH"),a.name=i.NAME;var s=i.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var u=s[l];-1!==u.indexOf("avc1")?a.videoCodec=this.avc1toavcoti(u):-1!==u.indexOf("hvc1")?a.videoCodec=u:a.audioCodec=u}}r.push(a)}return r}},{key:"parseMasterPlaylistMedia",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=void 0,i=[],o=0;for(p.lastIndex=0;null!=(a=p.exec(e));){var s={},l=new f.default(a[1]);l.TYPE===r&&(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=r,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=this.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),n&&(s.audioCodec=n),s.id=o++,i.push(s))}return i}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,r,n){var a,i,o=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},u=new y,c=0,d=null,v=new b;for(g.lastIndex=0;null!==(a=g.exec(e));){var p=a[1];if(p){v.duration=parseFloat(p);var E=(" "+a[2]).slice(1);v.title=E||null,v.tagList.push(E?["INF",p,E]:["INF",p])}else if(a[3]){if(!isNaN(v.duration)){var S=o++;v.type=n,v.start=s,v.levelkey=u,v.sn=S,v.level=r,v.cc=c,v.baseurl=t,v.relurl=(" "+a[3]).slice(1),l.fragments.push(v),d=v,s+=v.duration,v=new b}}else if(a[4]){if(v.rawByteRange=(" "+a[4]).slice(1),d){var k=d.byteRangeEndOffset;k&&(v.lastByteRangeEndOffset=k)}}else if(a[5])v.rawProgramDateTime=(" "+a[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]);else{for(a=a[0].match(m),i=1;i<a.length&&void 0===a[i];i++);var T=(" "+a[i+1]).slice(1),L=(" "+a[i+2]).slice(1);switch(a[i]){case"#":v.tagList.push(L?[T,L]:[T]);break;case"PLAYLIST-TYPE":l.type=T.toUpperCase();break;case"MEDIA-SEQUENCE":o=l.startSN=parseInt(T);break;case"TARGETDURATION":l.targetduration=parseFloat(T);break;case"VERSION":l.version=parseInt(T);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":c++,v.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(T);break;case"KEY":var w=T,_=new f.default(w),A=_.enumeratedString("METHOD"),O=_.URI,R=_.hexadecimalInteger("IV");A&&(u=new y,O&&["AES-128","SAMPLE-AES"].indexOf(A)>=0&&(u.method=A,u.baseuri=t,u.reluri=O,u.key=null,u.iv=R));break;case"START":var C=T,P=new f.default(C).decimalFloatingPoint("TIME-OFFSET");isNaN(P)||(l.startTimeOffset=P);break;case"MAP":var x=new f.default(T);v.relurl=x.URI,v.rawByteRange=x.BYTERANGE,v.baseurl=t,v.level=r,v.type=n,v.sn="initSegment",l.initSegment=v,v=new b;break;default:h.logger.warn("line parsed but not handled: "+a)}}}return(v=d)&&!v.relurl&&(l.fragments.pop(),s-=v.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=o-1,l}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.data,i=e.url,o=r.type,s=r.id,l=r.level,c=this.hls;if(this.loaders[o]=void 0,void 0!==i&&0!==i.indexOf("data:")||(i=r.url),t.tload=performance.now(),0===a.indexOf("#EXTM3U"))if(a.indexOf("#EXTINF:")>0){var f="audioTrack"!==o&&"subtitleTrack"!==o,v=isNaN(l)?isNaN(s)?0:s:l,p=this.parseLevelPlaylist(a,i,v,"audioTrack"===o?"audio":"subtitleTrack"===o?"subtitle":"main");p.tload=t.tload,"manifest"===o&&c.trigger(u.default.MANIFEST_LOADED,{levels:[{url:i,details:p}],audioTracks:[],url:i,stats:t,networkDetails:n}),t.tparsed=performance.now(),p.targetduration?f?c.trigger(u.default.LEVEL_LOADED,{details:p,level:l||0,id:s||0,stats:t,networkDetails:n}):"audioTrack"===o?c.trigger(u.default.AUDIO_TRACK_LOADED,{details:p,id:s,stats:t,networkDetails:n}):"subtitleTrack"===o&&c.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:p,id:s,stats:t,networkDetails:n}):c.trigger(u.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"invalid targetduration",networkDetails:n})}else{var g=this.parseMasterPlaylist(a,i);if(g.length){var m=this.parseMasterPlaylistMedia(a,i,"AUDIO",g[0].audioCodec),y=this.parseMasterPlaylistMedia(a,i,"SUBTITLES");if(m.length){var b=!1;m.forEach((function(e){e.url||(b=!0)})),!1===b&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(h.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main"}))}c.trigger(u.default.MANIFEST_LOADED,{levels:g,audioTracks:m,subtitles:y,url:i,stats:t,networkDetails:n})}else c.trigger(u.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no level found in manifest",networkDetails:n})}else c.trigger(u.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no EXTM3U delimiter",networkDetails:n})}},{key:"loaderror",value:function(e,t){var r,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.loader;switch(t.type){case"manifest":r=d.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=d.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=d.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(u.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:i.url,loader:i,response:e,context:t,networkDetails:a})}},{key:"loadtimeout",value:function(e,t){var r,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.loader;switch(t.type){case"manifest":r=d.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=d.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=d.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(u.default.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:i.url,loader:i,context:t,networkDetails:a})}}]),t}(c.default);r.default=E},{2:2,28:28,29:29,30:30,42:42,46:46}],39:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=Math.pow(2,32)-1,o=function(){function e(){n(this,e)}return a(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,a=r.length,i=a;a--;)n+=r[a].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),a=0,n=8;a<i;a++)t.set(r[a],n),n+=r[a].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)}},{key:"sdtp",value:function(t){var r,n,a=t.samples||[],i=new Uint8Array(4+a.length);for(n=0;n<a.length;n++)r=a[n].flags,i[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,i)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,a,i=[],o=[];for(r=0;r<t.sps.length;r++)a=(n=t.sps[r]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)a=(n=t.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,n=t.duration*t.timescale,a=t.width,o=t.height,s=Math.floor(n/(i+1)),l=Math.floor(n%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),a=t.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,a,i,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)i=(a=u[n]).duration,o=a.size,s=a.flags,l=a.cts,f.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r}}]),e}();r.default=o},{}],40:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(e(31)),s=n(e(30)),l=e(46),u=n(e(39)),c=e(28),d=function(){function e(t,r,n,i){a(this,e),this.observer=t,this.config=r,this.typeSupported=n;var o=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&o&&!o.match("CriOS"),this.ISGenerated=!1}return i(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this._initPTS=this._initDTS=e}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,a,i,o){if(this.ISGenerated){if(o){var u=this._initPTS,c=this._PTSNormalize,d=e.inputTimeScale||t.inputTimeScale,f=1/0,h=1/0,v=e.samples;if(v.length&&(f=h=c(v[0].pts-d*a,u)),(v=t.samples).length){var p=v[0];f=Math.min(f,c(p.pts-d*a,u)),h=Math.min(h,c(p.dts-d*a,u))}if(f!==1/0){var g=u-f;Math.abs(g)>10*d&&(l.logger.warn("timestamp inconsistency, "+(g/d).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=f,this._initDTS=h,this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:f}))}}}else this.generateIS(e,t,a);if(this.ISGenerated)if(e.samples.length){e.timescale||(l.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var m=this.remuxAudio(e,a,i,o);if(t.samples.length){var y=void 0;m&&(y=m.endPTS-m.startPTS),t.timescale||(l.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,a,i,y,o)}}else{var b=void 0;t.samples.length&&(b=this.remuxVideo(t,a,i,o)),b&&e.codec&&this.remuxEmptyAudio(e,a,i,b)}r.samples.length&&this.remuxID3(r,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(s.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,r){var n,a,i=this.observer,o=e.samples,d=t.samples,f=this.typeSupported,h="audio/mp4",v={},p={tracks:v},g=void 0===this._initPTS;if(g&&(n=a=1/0),e.config&&o.length&&(e.timescale=e.samplerate,l.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(f.mpeg?(h="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3")),v.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&f.mpeg?new Uint8Array:u.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(n=a=o[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&d.length){var m=t.inputTimeScale;t.timescale=m,v.video={container:"video/mp4",codec:t.codec,initSegment:u.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(n=Math.min(n,d[0].pts-m*r),a=Math.min(a,d[0].dts-m*r),this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(v).length?(i.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=n,this._initDTS=a)):i.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r,n,a){var i,o,d,f,h,v,p,g=8,m=e.timescale,y=e.samples,b=[],E=y.length,S=this._PTSNormalize,k=this._initDTS,T=this.nextAvcDts,L=this.isSafari;L&&(r|=y.length&&T&&(a&&Math.abs(t-T/m)<.1||Math.abs(y[0].pts-T-k)<m/5)),r||(T=t*m),y.forEach((function(e){e.pts=S(e.pts-k,T),e.dts=S(e.dts-k,T)})),y.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id}));var w=y.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)}),0);if(w<0){l.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(w/90)+" ms to overcome this issue");for(var _=0;_<y.length;_++)y[_].dts+=w}var A=y[0];h=Math.max(A.dts,0),f=Math.max(A.pts,0);var O=Math.round((h-T)/90);r&&O&&(O>1?l.logger.log("AVC:"+O+" ms hole between fragments detected,filling it"):O<-1&&l.logger.log("AVC:"+-O+" ms overlapping between fragments detected"),h=T,y[0].dts=h,f=Math.max(f-O,T),y[0].pts=f,l.logger.log("Video/PTS/DTS adjusted: "+Math.round(f/90)+"/"+Math.round(h/90)+",delta:"+O+" ms")),A=y[y.length-1],p=Math.max(A.dts,0),v=Math.max(A.pts,0,p),L&&(i=Math.round((p-h)/(y.length-1)));for(var R=0,C=0,P=0;P<E;P++){for(var x=y[P],D=x.units,M=D.length,I=0,B=0;B<M;B++)I+=D[B].data.length;C+=I,R+=M,x.length=I,x.dts=L?h+P*i:Math.max(x.dts,h),x.pts=Math.max(x.pts,x.dts)}var F=C+4*R+8;try{o=new Uint8Array(F)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating video mdat "+F})}var j=new DataView(o.buffer);j.setUint32(0,F),o.set(u.default.types.mdat,4);for(var N=0;N<E;N++){for(var U=y[N],G=U.units,V=0,H=void 0,W=0,z=G.length;W<z;W++){var q=G[W],K=q.data,Y=q.data.byteLength;j.setUint32(g,Y),g+=4,o.set(K,g),g+=Y,V+=4+Y}if(L)H=Math.max(0,i*Math.round((U.pts-U.dts)/i));else{if(N<E-1)i=y[N+1].dts-U.dts;else{var Q=this.config,X=U.dts-y[N>0?N-1:N].dts;if(Q.stretchShortVideoTrack){var Z=Q.maxBufferHole,J=Q.maxSeekHole,$=Math.floor(Math.min(Z,J)*m),ee=(n?f+n*m:this.nextAudioPts)-U.pts;ee>$?((i=ee-X)<0&&(i=X),l.logger.log("It is approximately "+ee/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=X}else i=X}H=Math.round(U.pts-U.dts)}b.push({size:V,duration:i,cts:H,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:U.key?2:1,isNonSync:U.key?0:1}})}this.nextAvcDts=p+i;var te=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var re=b[0].flags;re.dependsOn=2,re.isNonSync=0}e.samples=b,d=u.default.moof(e.sequenceNumber++,h,e),e.samples=[];var ne={data1:d,data2:o,startPTS:f/m,endPTS:(v+i)/m,startDTS:h/m,endDTS:this.nextAvcDts/m,type:"video",nb:b.length,dropped:te};return this.observer.trigger(s.default.FRAG_PARSING_DATA,ne),ne}},{key:"remuxAudio",value:function(e,t,r,n){var a,i,d,f,h,v,p,g=e.inputTimeScale,m=g/e.timescale,y=(e.isAAC?1024:1152)*m,b=this._PTSNormalize,E=this._initDTS,S=!e.isAAC&&this.typeSupported.mpeg,k=e.samples,T=[],L=this.nextAudioPts;if((r|=k.length&&L&&(n&&Math.abs(t-L/g)<.1||Math.abs(k[0].pts-L-E)<20*y))||(L=t*g),k.forEach((function(e){e.pts=e.dts=b(e.pts-E,L)})),k.sort((function(e,t){return e.pts-t.pts})),n&&e.isAAC)for(var w=0,_=L;w<k.length;){var A,O=k[w];A=O.pts-_;var R=Math.abs(1e3*A/g);if(A<=-y)l.logger.warn("Dropping 1 audio frame @ "+(_/g).toFixed(3)+"s due to "+R+" ms overlap."),k.splice(w,1),e.len-=O.unit.length;else if(A>=y&&R<1e4&&_){var C=Math.round(A/y);l.logger.warn("Injecting "+C+" audio frame @ "+(_/g).toFixed(3)+"s due to "+Math.round(1e3*A/g)+" ms gap.");for(var P=0;P<C;P++){var x=Math.max(_,0);(d=o.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),d=O.unit.subarray()),k.splice(w,0,{unit:d,pts:x,dts:x}),e.len+=d.length,_+=y,w++}O.pts=O.dts=_,_+=y,w++}else Math.abs(A),O.pts=O.dts=_,_+=y,w++}for(var D=0,M=k.length;D<M;D++){var I=k[D],B=I.unit,F=I.pts;if(void 0!==p)i.duration=Math.round((F-p)/m);else{var j=Math.round(1e3*(F-L)/g),N=0;if(r&&e.isAAC&&j){if(j>0&&j<1e4)N=Math.round((F-L)/y),l.logger.log(j+" ms hole between AAC samples detected,filling it"),N>0&&((d=o.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(d=B.subarray()),e.len+=N*d.length);else if(j<-12){l.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(L/g).toFixed(3)+"s/"+(F/g).toFixed(3)+"s/"+-j+"ms"),e.len-=B.byteLength;continue}F=L}if(v=Math.max(0,F),!(e.len>0))return;var U=S?e.len:e.len+8;a=S?0:8;try{f=new Uint8Array(U)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:U,reason:"fail allocating audio mdat "+U})}S||(new DataView(f.buffer).setUint32(0,U),f.set(u.default.types.mdat,4));for(var G=0;G<N;G++)(d=o.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),d=B.subarray()),f.set(d,a),a+=d.byteLength,i={size:d.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(i)}f.set(B,a);var V=B.byteLength;a+=V,i={size:V,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(i),p=F}var H=0,W=T.length;if(W>=2&&(H=T[W-2].duration,i.duration=H),W){this.nextAudioPts=L=p+m*H,e.len=0,e.samples=T,h=S?new Uint8Array:u.default.moof(e.sequenceNumber++,v/m,e),e.samples=[];var z=v/g,q=L/g,K={data1:h,data2:f,startPTS:z,endPTS:q,startDTS:z,endDTS:q,type:"audio",nb:W};return this.observer.trigger(s.default.FRAG_PARSING_DATA,K),K}return null}},{key:"remuxEmptyAudio",value:function(e,t,r,n){var a=e.inputTimeScale,i=a/(e.samplerate?e.samplerate:a),s=this.nextAudioPts,u=(void 0!==s?s:n.startDTS*a)+this._initDTS,c=n.endDTS*a+this._initDTS,d=1024*i,f=Math.ceil((c-u)/d),h=o.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(l.logger.warn("remux empty Audio"),h){for(var v=[],p=0;p<f;p++){var g=u+p*d;v.push({unit:h,pts:g,dts:g}),e.len+=h.length}e.samples=v,this.remuxAudio(e,t,r)}else l.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var r,n=e.samples.length,a=e.inputTimeScale,i=this._initPTS,o=this._initDTS;if(n){for(var l=0;l<n;l++)(r=e.samples[l]).pts=(r.pts-i)/a,r.dts=(r.dts-o)/a;this.observer.trigger(s.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort((function(e,t){return e.pts-t.pts}));var r,n=e.samples.length,a=e.inputTimeScale,i=this._initPTS;if(n){for(var o=0;o<n;o++)(r=e.samples[o]).pts=(r.pts-i)/a;this.observer.trigger(s.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}}]),e}();r.default=d},{28:28,30:30,31:31,39:39,46:46}],41:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e(30)),o=function(){function e(t){n(this,e),this.observer=t}return a(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(e,t,r,n,a,o,s,l){var u=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),u.trigger(i.default.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:c,nb:1,dropped:0}),u.trigger(i.default.FRAG_PARSED)}}]),e}();r.default=o},{30:30}],42:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=/^(\d+)x(\d+)$/,o=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){for(var r in n(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}return a(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=i.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,r={};for(o.lastIndex=0;null!==(t=o.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r}}]),e}();r.default=s},{}],43:[function(e,t,r){"use strict";var n={search:function(e,t){for(var r=0,n=e.length-1,a=null,i=null;r<=n;){var o=t(i=e[a=(r+n)/2|0]);if(o>0)r=a+1;else{if(!(o<0))return i;n=a-1}}return null}};t.exports=n},{}],44:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e(45)),o=function(){function e(t,r,a,o){n(this,e),this.hls=t,this.defaultEstimate_=o,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(r),this.fast_=new i.default(a)}return a(e,[{key:"sample",value:function(e,t){var r=8e3*t/(e=Math.max(e,this.minDelayMs_)),n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();r.default=o},{45:45}],45:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){n(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return a(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();r.default=i},{}],46:[function(e,t,r){"use strict";function n(){}function a(e,t){return"["+e+"] > "+t}function i(e){var t=self.console[e];return t?function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=a(e,n[0])),t.apply(self.console,n)}:n}function o(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){u[t]=e[t]?e[t].bind(e):i(t)}))}Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l={trace:n,debug:n,log:n,warn:n,info:n,error:n},u=l;r.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":s(e))){o(e,"debug","log","info","warn","error");try{u.log()}catch(e){u=l}}else u=l},r.logger=u},{}],47:[function(e,t,r){"use strict";var n={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}};t.exports=n},{}],48:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(46),o=function(){function e(t){n(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return a(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,a=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var l=void 0,u=void 0;u="arraybuffer"===a.responseType?(l=t.response).byteLength:(l=t.responseText).length,n.loaded=n.total=u;var c={url:t.responseURL,data:l};this.callbacks.onSuccess(c,n,a,t)}else n.retry>=o.maxRetry||s>=400&&s<499?(i.logger.error(s+" while loading "+a.url),this.callbacks.onError({code:s,text:t.statusText},a,t)):(i.logger.warn(s+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){i.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)}}]),e}();r.default=o},{46:46}]},{},[35])(35)},365:function(e,t,r){"use strict";r.d(t,"a",(function(){return pe}));var n=r(43),a=r(42),i=r(304),o=r(331),s=r(121),l=r(34),u=r(41),c=r(0),d=r.n(c),f=r(316),h=r(366),v=r.n(h);var p=function(){function e(t,r,n,a){var i=this;Object(l.a)(this,e),this.remove=function(){e.queue=e.queue.filter((function(e){return e.start!==i.start}))},this.start=r,e.queue.push(this);var o=new XMLHttpRequest;this.xhr=o,o.open("get",t),o.responseType="arraybuffer",o.setRequestHeader("Range","bytes=".concat(r,"-").concat(n)),o.onload=function(){200!==o.status&&206!==o.status||a(o.response),i.remove()},o.send(),o.onerror=function(){i.remove()},o.onabort=function(){i.remove()}}return Object(u.a)(e,null,[{key:"clear",value:function(){for(;e.queue.length;){e.queue.shift().xhr.abort()}}}]),e}();p.queue=[];var g=function(){function e(t){Object(l.a)(this,e),this.buffer=t,this.position=0}return Object(u.a)(e,[{key:"readType",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=[],r=0;r<e;r++)t.push(this.buffer[this.position++]);return String.fromCharCode.apply(null,t)}},{key:"readByte",value:function(e){switch(e){case 1:return this.readOneByte();case 2:return this.readTwoByte();case 3:return this.readThreeByte();case 4:return this.readFourByte();default:return 0}}},{key:"readOneByte",value:function(){return this.buffer[this.position++]>>>0}},{key:"readTwoByte",value:function(){return(this.buffer[this.position++]<<8|this.buffer[this.position++])>>>0}},{key:"readThreeByte",value:function(){return(this.buffer[this.position++]<<16|this.buffer[this.position++]<<8|this.buffer[this.position++])>>>0}},{key:"readFourByte",value:function(){return(this.buffer[this.position++]<<24|this.buffer[this.position++]<<16|this.buffer[this.position++]<<8|this.buffer[this.position++])>>>0}}]),e}();var m=[null,null,null,"ESDescrTag","DecoderConfigDescrTag","DecSpecificDescrTag"];var y={ftyp:function(e){for(var t=new g(e),r=t.readType(),n=t.readByte(4),a=[],i=t.position;i<e.length;i+=4)a.push(t.readType(4));return{majorBrand:r,minorVersion:n,compatibleBrands:a}},mvhd:function(e){var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=t.readByte(4),o=t.readByte(4),s=t.readByte(4),l=t.readByte(4),u=t.readByte(1);t.readByte(3),t.readByte(4),t.readByte(4);for(var c=[],d=0;d<36;d+=4)c.push(t.readByte(4));for(var f=0;f<24;f+=4)t.readByte(4);return{version:r,flags:n,creationTime:a,modificationTime:i,timescale:o,duration:s,rate:l,volume:u,matrix:c,nextTrackID:t.readByte(4)}},tkhd:function(e){var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=t.readByte(4),o=t.readByte(4);t.readByte(4);var s=t.readByte(4);t.readByte(4),t.readByte(4);var l=t.readByte(2),u=t.readByte(2),c=t.readByte(2);t.readByte(2);for(var d=[],f=0;f<36;f+=4)d.push(t.readByte(4));return{version:r,flags:n,creationTime:a,modificationTime:i,trackID:o,duration:s,layer:l,alternateGroup:u,volume:c,matrix:d,width:Number("".concat(t.readByte(2),".").concat(t.readByte(2))),height:Number("".concat(t.readByte(2),".").concat(t.readByte(2)))}},elst:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;++o){var s=t.readByte(4),l=t.readByte(4);4294967295===l&&(l=-1);var u=t.readByte(2),c=t.readByte(2);i.push({segmentDuration:s,mediaTime:l,mediaRateInteger:u,mediaRateFraction:c})}return{version:r,flags:n,entries:i}},mdhd:function(e){var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=t.readByte(4),o=t.readByte(4),s=t.readByte(4),l=t.readByte(2),u=[];u[0]=l>>10&31,u[1]=l>>5&31,u[2]=31&l;var c=String.fromCharCode(96+u[0],96+u[1],96+u[2]);return t.readByte(2),{version:r,flags:n,creationTime:a,modificationTime:i,timescale:o,duration:s,languageString:c}},hdlr:function(e){var t=new g(e),r=t.readByte(1),n=t.readByte(3);t.readByte(4);var a=t.readType().toString(),i=t.readType().toString();t.readByte(4),t.readByte(4);for(var o,s=[];0!==(o=t.readByte(1));)s.push(String.fromCharCode(o));return{version:r,flags:n,handlerType:a,handlerType2:i||0,name:s.join("")}},vmhd:function(e){var t=new g(e);return{version:t.readByte(1),flags:t.readByte(3),graphicsmode:t.readByte(2),opcolor:new Array(3).fill(t.readByte(2))}},dref:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=t.buffer.slice(8),s=new g(o),l=new S,u=0;u<a;u++)l.readSize(s),l.readType(s),l.readBody(s),i.push(l.box);return{version:r,flags:n,url:i}},"url ":function(e){var t=new g(e);return{version:t.readByte(1),flags:t.readByte(3)}},stsd:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=t.buffer.slice(8),l=new g(o),u=new S,c="avc1",d=0;d<a;d++)u.readSize(l),u.readType(l),u.readBody(l),i.push(u.box),c=u.type;return Object(s.a)({version:r,flags:n},c,i)},avc1:function(e){var t=new g(e);t.readByte(4),t.readByte(2);var r=t.readByte(2);t.readByte(2),t.readByte(2),t.readByte(4),t.readByte(4),t.readByte(4);var n=t.readByte(2),a=t.readByte(2),i=t.readByte(4),o=t.readByte(4);t.readByte(4);var s=t.readByte(2),l=t.readType(32),u=t.readByte(2);t.readByte(2);var c=t.buffer.slice(78),d=new g(c),f=new S;return f.readSize(d),f.readType(d),f.readBody(d),{dataReferenceIndex:r,width:n,height:a,horizresolution:i,vertresolution:o,frameCount:s,compressorname:l,depth:u,avcC:f.box}},avcC:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(1),a=t.readByte(1),i=t.readByte(1),s=3&t.readByte(1),l=31&t.readByte(1),u=[],c=0;c<l;c++){var d=t.readByte(2);u.push.apply(u,Object(o.a)(t.buffer.slice(t.position,t.position+d))),t.position+=d}for(var f=t.readByte(1),h=[],v=0;v<f;v++){var p=t.readByte(2);h.push.apply(h,Object(o.a)(t.buffer.slice(t.position,t.position+p))),t.position+=p}return{configurationVersion:r,AVCProfileIndication:n,profileCompatibility:a,AVCLevelIndication:i,lengthSizeMinusOne:s,SPS:u,PPS:h}},stts:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;o++){var s=t.readByte(4),l=t.readByte(4);i.push({sampleCount:s,sampleDelta:l})}return{version:r,flags:n,samples:i}},stss:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;o++)i.push({sampleNumber:t.readByte(4)});return{version:r,flags:n,samples:i}},ctts:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;o++)i.push({sampleCount:t.readByte(4),sampleOffset:t.readByte(4)});return{version:r,flags:n,samples:i}},stsc:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;o++)i.push({firstChunk:t.readByte(4),samplesPerChunk:t.readByte(4),sampleDescriptionIndex:t.readByte(4)});return{version:r,flags:n,samples:i}},stsz:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=t.readByte(4),o=[],s=0;s<i;s++)o.push({entrySize:t.readByte(4)});return{version:r,flags:n,sampleSize:a,samples:o}},stco:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=t.readByte(4),i=[],o=0;o<a;o++)i.push({chunkOffset:t.readByte(4)});return{version:r,flags:n,samples:i}},smhd:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=[],i=0;i<4;i++)a.push(t.readByte(1));return{version:r,flags:n,data:a}},mp4a:function(e){var t=new g(e);t.readByte(4),t.readByte(2);var r=t.readByte(2);t.readByte(2),t.readByte(2),t.readByte(4);var n=t.readByte(2),a=t.readByte(2);t.readByte(4);var i=t.readByte(4)/65536,o=t.buffer.slice(28),s=new g(o),l=new S;return l.readSize(s),l.readType(s),l.readBody(s),{dataReferenceIndex:r,channelCount:n,sampleSize:a,sampleRate:i,esds:l.box}},esds:function(e){var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=m[t.readByte(1)],i=Object(s.a)({version:r,flags:n},a,function(e){var t={},r=e.readByte(1);128===r?(e.readByte(2),r=e.readByte(1)+5):r+=2;return t.size=r,t.ESID=e.readByte(2),t.streamPriority=e.readByte(1),t[m[e.readByte(1)]]=function(e){var t={},r=e.readByte(1);128===r?(e.readByte(2),r=e.readByte(1)+5):r+=2;t.size=r,t.objectTypeIndication=e.readByte(1);var n=e.readByte(1);return t.streamType=127&n,t.upStream=2&n,t.bufferSize=e.readByte(3),t.maxBitrate=e.readByte(4),t.avgBitrate=e.readByte(4),t}(e),t[m[e.readByte(1)]]=function(e){var t={},r=e.readByte(1),n=r;128===r?(e.readByte(2),n=(r=e.readByte(1)+5)-5):r+=2;t.size=r;for(var a=[],i=0;i<n;i++)a.push(Number(e.readByte(1)).toString(16).padStart(2,"0"));return t.audioConfig=a.map((function(e){return Number("0x".concat(e))})),t}(e),t}(t));return i},meta:function(e){var t=new g(e);return{version:t.readByte(1),flags:t.readByte(3)}},mdat:function(e){var t=new g(e);return{data:t.buffer.subarray(t.position,t.buffer.length)}},sdtp:function(e){for(var t=new g(e),r=t.readByte(1),n=t.readByte(3),a=[],i=t.position;i<e.length;i++){var o=t.readByte(1);a.push({isLeading:o>>6,dependsOn:o>>4&3,isDepended:o>>2&3,hasRedundancy:3&o})}return{version:r,flags:n,samplesFlag:a}},thmb:function(e){return{data:new g(e).readByte(e.length)}}},b=["moov","trak","edts","mdia","minf","dinf","stbl"],E=["udta","free"],S=function(){function e(){Object(l.a)(this,e),this.size=0,this.type="",this.start=0,this.box={}}return Object(u.a)(e,[{key:"readSize",value:function(e){this.start=e.position,this.size=e.readByte(4)}},{key:"readType",value:function(e){this.type=e.readType(),1===this.size&&(this.size=e.readByte(4)<<32,this.size|=e.readByte(4))}},{key:"readBody",value:function(e){var t=this;this.data=e.buffer.slice(e.position,this.size+this.start),b.find((function(e){return e===t.type}))||E.find((function(e){return e===t.type}))?this.parserContainerBox():y[this.type]?this.box=Object.assign(Object.assign({},this.box),y[this.type](this.data)):this.box={},e.position+=this.data.length}},{key:"parserContainerBox",value:function(){for(var t=new g(this.data),r=t.buffer.length;t.position<r;){var n=new e;if(n.readSize(t),n.readType(t),n.readBody(t),"trak"===n.type&&n.box.mdia&&n.box.mdia.hdlr){var a=n.box.mdia.hdlr.handlerType;"vide"===a?this.box.videoTrak=n.box:"soun"===a?this.box.audioTrak=n.box:this.box["".concat(a,"Trak")]=n.box}else this.box[n.type]=n.box}}}]),e}(),k=function(){function e(t){Object(l.a)(this,e),this.buffer=t,this.stream=new g(t),this.mp4BoxTreeObject={},this.init()}return Object(u.a)(e,[{key:"init",value:function(){this.parse()}},{key:"parse",value:function(){for(;this.stream.position<this.buffer.length;){var e=new S;e.readSize(this.stream),e.readType(this.stream),e.readBody(this.stream),this.mp4BoxTreeObject[e.type]=e.box,this.mp4BoxTreeObject[e.type].size=e.size}}}]),e}(),T={moov:w,mvhd:function(e){return w(e).mvhd},videoTrak:_,audioTrak:O,videoTkhd:function(e){return _(e).tkhd},audioTkhd:function(e){return O(e).tkhd},videoStbl:A,audioStbl:R,videoStsc:function(e){return A(e).stsc},audioStsc:function(e){return R(e).stsc},avcC:function(e){return A(e).stsd.avc1[0].avcC},esds:function(e){return C(e).esds},videoStco:function(e){return A(e).stco},audioStco:function(e){return R(e).stco},videoStts:function(e){return A(e).stts},audioStts:function(e){return R(e).stts},audioMdhd:function(e){return O(e).mdia.mdhd},videoMdhd:function(e){return _(e).mdia.mdhd},videoStss:function(e){return A(e).stss},videoStsz:function(e){return A(e).stsz},videoCtts:function(e){return A(e).ctts},audioStsz:function(e){return R(e).stsz},mp4a:C,audioElst:function(e){return O(e).edts.elst},videoElst:function(e){return O(e).edts.elst}};function L(e,t){var r=T[t];return r?r(e):{}}function w(e){return e.moov}function _(e){return w(e).videoTrak}function A(e){return _(e).mdia.minf.stbl}function O(e){return w(e).audioTrak}function R(e){return O(e).mdia.minf.stbl}function C(e){return R(e).stsd.mp4a[0]}function P(e,t){for(var r=[],n=e.samples.length,a=0;a<t;a++)0!==a&&a<n&&e.samples[a].firstChunk-1!==e.samples[a-1].firstChunk&&(a--,e.samples[a].firstChunk++),a>=n?(1!==e.samples[n-1]&&(a=a+e.samples[n-1].samplesPerChunk-1),r.push(e.samples[n-1].samplesPerChunk)):r.push(e.samples[a].samplesPerChunk);return r}function x(e,t,r){for(var n=0,a=P(v()(L(e,"video"===r?"videoStsc":"audioStsc")),t),i=0,o=0;t>0&&o<=a.length;o++){if((n+=a[o])===t){i=o+1;break}if(n>t){n-=a[o],i=o;break}}for(var s=[n,t],l=0,u=L(e,"video"===r?"videoStsz":"audioStsz").samples.slice(s[0],s[1]),c=0;c<u.length;c++)l+=u[c].entrySize;var d=L(e,"video"===r?"videoStco":"audioStco");return i>=d.samples.length?Number.MAX_SAFE_INTEGER:d.samples[i].chunkOffset+l}function D(e,t,r,n){for(var a=Object(i.a)(r,2),o=a[0],s=a[1],l=[],u=L(e,n?"videoStts":"audioStts"),c=L(e,n?"videoStsz":"audioStsz"),d=L(e,n?"videoStco":"audioStco"),f=P(v()(L(e,n?"videoStsc":"audioStsc")),s),h=function(e,t){for(var r=[],n=0,a=0;n<t.length&&!(n+a>=e.samples.length);n++)if(r.push(e.samples[n+a].entrySize),1!==t[n]){for(var i=1;i<t[n];i++){var o=e.samples[n+i+a].entrySize+r[n+i-1+a];r.push(o)}a=a+t[n]-1}return r}(c,f),p=[],g=0;g<u.samples.length;g++){var m=u.samples[g],y=m.sampleCount,b=m.sampleDelta;p.push({sampleCount:y+(p[g-1]?p[g-1].sampleCount:0),sampleDelta:b})}for(var E=[],S=0;S<f.length;S++)for(var k=0;k<f[S];k++){var T=d.samples[S];E.push(T?T.chunkOffset:d.samples[d.samples.length-1].chunkOffset)}for(var w=function(e){var r=c.samples[e].entrySize,a=E[e]-t+h[e],i=a-r,o=p.find((function(t,r){return p[r-1]?e+1<=t.sampleCount&&e+1>p[r-1].sampleCount:e+1<=t.sampleCount})).sampleDelta;l.push(Object.assign(Object.assign({},n&&{compositionTimeOffset:n.length?n[e]:0}),{duration:o,size:r,start:i,end:a,bufferStart:t}))},_=o;_<s;_++)w(_);return l}function M(e,t){for(var r=0,n=0,a=0;a<e.samples.length;a++)for(var i=e.samples[a],o=i.sampleCount,s=i.sampleDelta,l=0;l<o;l++){if(!(r<t&&0!==t))return n;n+=s,r++}return n}function I(e,t){var r=[];if(e)r=e.samples.map((function(e){return e.sampleNumber-1}));else for(var n=0;n<=Math.floor(t.samples.length/5);n++)r.push(5*n);return r}var B=function(){function e(t){var r=this;Object(l.a)(this,e),this.updateInterval=function(e){var t=r.mp4Data,n=t.videoTimescale,a=t.audioTimescale;r.videoInterval="number"===typeof e?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=v()(L(e,"videoStss")),n=v()(L(e,"videoStts")),a=L(e,"videoStsz"),i=M(n,a.samples.length),o=I(r,a),s=o.map((function(e){return M(n,e)})),l={offsetInterVal:[],timeInterVal:[]},u=0;u<s.length;u++){var c=s[u],d=s[u+1]?s[u+1]:i;if(c<=t&&t<d){var f=o[u],h=void 0!==o[u+1]?o[u+1]:a.samples.length;l.offsetInterVal.push(f,h),l.timeInterVal.push(c,d);break}}return l}(r.mp4BoxTree,e*n):function(e,t){var r=v()(L(e,"videoStss")),n=v()(L(e,"videoStts")),a=L(e,"videoStsz"),i=a.samples.length,o=M(n,i),s=I(r,a),l=s.map((function(e){return M(n,e)})),u=[];t+1>s[s.length-1]&&(u={offsetInterVal:[s[s.length-1],i],timeInterVal:[l[s.length-1],o]});for(var c=0;c<s.length;c++)if(s[c]<t+1&&s[c+1]>=t+1){u={offsetInterVal:[s[c],s[c+1]],timeInterVal:[l[c],l[c+1]]};break}return u}(r.mp4BoxTree,r.videoInterval.offsetInterVal[1]),r.audioInterval=function(e,t){for(var r,n=Object(i.a)(t.timeInterVal,2),a=n[0],o=n[1],s=t.offsetInterVal,l=v()(L(e,"audioStts")),u=L(e,"audioMdhd").timescale,c=L(e,"videoMdhd").timescale,d=L(e,"videoStsz"),f=L(e,"audioStsz"),h=a/c*u,p=o/c*u,g=0,m=0,y=L(e,"audioElst").entries[0],b=y.mediaTime,E=y.segmentDuration,S=-1!==b?b:E,k=0,T=0;T<l.samples.length;T++)for(var w=l.samples[T],_=w.sampleCount,A=w.sampleDelta,O=0;O<_;O++)S<=h&&0!==h&&(S+=A,g++),k<=p&&(k+=A,m++);return s[1]===d.samples.length&&(r=f.samples.length),{offsetInterVal:[g,r||m],timeInterVal:[S,k]}}(r.mp4BoxTree,r.videoInterval);var o=r.videoInterval.timeInterVal.map((function(e){return e/n})),s=r.audioInterval.timeInterVal.map((function(e){return e/a}));r.timeRange=[Math.min(o[0],s[0]),Math.max(o[1],s[1])]},this.isDraining=function(e){return e>(r.timeRange[1]-r.timeRange[0])/4+r.timeRange[0]},this.getFragmentPosition=function(e){r.updateInterval(e),r.bufferStart=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(x(e,t,"video"),x(e,r,"audio"))}(r.mp4BoxTree,r.videoInterval.offsetInterVal[0],r.audioInterval.offsetInterVal[0]);var t=r.getSamples(),n=t.videoSamples,a=t.audioSamples,i=L(r.mp4BoxTree,"videoStco"),o=0;n.length>0&&(o=n[n.length-1].start);var s=o+n[n.length-1].bufferStart===i.samples[i.samples.length-1].chunkOffset;return function(e,t,r,n){var a=e[e.length-1].end,i=0;e.length>0&&(i=e[0].start);var o=0,s=Number.MAX_SAFE_INTEGER;0!==t.length&&(o=t[t.length-1].end,s=t[0].start);var l=n?"":Math.max(a,o)+r;return[Math.min(i,s)+r,l]}(n,a,r.bufferStart,s)},this.getSamples=function(){var e=function(e,t,r){var n=v()(L(e,"videoCtts")),a=[];if(n)for(var i=0;i<n.samples.length;i++)a.push(n.samples[i].sampleOffset),1!==n.samples[i].sampleCount&&(n.samples[i].sampleCount--,i--);return D(e,t,r,a)}(r.mp4BoxTree,r.bufferStart,r.videoInterval.offsetInterVal),t=function(e,t,r){return D(e,t,r)}(r.mp4BoxTree,r.bufferStart,r.audioInterval.offsetInterVal);return{videoSamples:e,audioSamples:t}},this.getTrackInfo=function(e){var t=r.getSamples(),n=t.videoSamples,a=t.audioSamples,i=function(e,t){return{samples:e.map((function(e){return Object.assign(Object.assign({},e),{buffer:t.slice(e.start,e.end)})})),trackId:1}}(n,e),o=function(e,t){return{samples:e.map((function(e){return Object.assign(Object.assign({},e),{buffer:t.slice(e.start,e.end)})})),trackId:2}}(a,e);return{videoTrackInfo:i,audioTrackInfo:o}},this.mp4BoxTree=t,this.mp4Data={},this.init()}return Object(u.a)(e,[{key:"init",value:function(){this.getMP4Data()}},{key:"getMP4Data",value:function(){var e=L(this.mp4BoxTree,"mvhd"),t=e.duration,r=e.timescale,n=L(this.mp4BoxTree,"mp4a"),a=n.channelCount,i=n.sampleRate,o=L(this.mp4BoxTree,"audioMdhd"),s=o.timescale,l=o.duration,u=L(this.mp4BoxTree,"esds").ESDescrTag.DecSpecificDescrTag.audioConfig;if(this.mp4Data={duration:t,timescale:r,channelCount:a,sampleRate:i,audioConfig:u,audioDuration:l,audioTimescale:s},L(this.mp4BoxTree,"videoTrak")){var c=L(this.mp4BoxTree,"videoTkhd"),d=c.width,f=c.height,h=L(this.mp4BoxTree,"videoStsz").samples,v=L(this.mp4BoxTree,"avcC"),p=v.SPS,g=v.PPS,m=L(this.mp4BoxTree,"videoMdhd"),y=m.timescale,b=m.duration;this.mp4Data=Object.assign(Object.assign({},this.mp4Data),{width:d,height:f,SPS:p,PPS:g,videoDuration:b,videoTimescale:y,videoSamplesLength:h.length})}}}]),e}();function F(e,t){return new Uint8Array([255&e,t>>16&255,t>>8&255,255&t])}function j(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var a=0,i=r;a<i.length;a++){var o=i[a];e+=o.length}for(var s=new Uint8Array(e),l=0,u=0,c=r;u<c.length;u++){var d=c[u];s.set(d,l),l+=d.length}return s}function N(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}function U(e){var t=e/Math.pow(2,32),r=e%Math.pow(2,32);return new Uint8Array([t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}var G=function(e){return e.charCodeAt(0)},V=function(e){return new Uint8Array(Array.prototype.map.call(e,G))};function H(e,t){return j(N(t.length+8),V(e),t)}function W(e){return q(e)}function z(e){return q(e)}function q(e){return new Uint8Array(e)}var K=new Uint8Array([0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0]);function Y(){return H("dinf",H("dref",j(new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,1])),H("url ",[0,0,0,1]))))}function Q(e){var t=e.width,r=e.height,n=new Uint8Array([].concat(Object(o.a)(z(6)),[0,1],Object(o.a)(W(16)),[t>>8&255,255&t,r>>8&255,255&r,0,72,0,0,0,72,0,0],Object(o.a)(z(4)),[0,1,11,87,65,78,71,76,117,118,68,65,78,71],Object(o.a)(W(20)),[0,24,255,255]));return n=j(n,function(e){var t=e.SPS,r=e.PPS;return H("avcC",new Uint8Array([1,t[1],t[2],t[3],255,225,t.length>>8&255,255&t.length].concat(Object(o.a)(t),[1,r.length>>8&255,255&r.length],Object(o.a)(r))))}(e)),H("avc1",n)}function X(e){var t=e.channelCount,r=e.sampleRate,n=new Uint8Array([].concat(Object(o.a)(z(6)),[0,1],Object(o.a)(z(8)),[0,t,0,16],Object(o.a)(z(4)),[r>>8&255,255&r,0,0]));return n=j(n,function(e){var t=e.audioConfig,r=void 0===t?[43,146,8,0]:t;return H("esds",new Uint8Array([].concat(Object(o.a)(F(0,0)),[3,23+r.length,0,1,0,4,15+r.length,64,21,0,0,0,0,0,0,0,0,0,0,0,5,r.length],Object(o.a)(r),[6,1,2])))}(e)),H("mp4a",n)}function Z(e){var t=j(function(e){var t,r=e.type;return"video"===r?t=Q(e):"audio"===r&&(t=X(e)),H("stsd",t=j(new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,1])),t))}(e),ee(),$(),J(),te());return H("stbl",t)}var J=function(){return H("stsz",new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,0,0,0,0,0])))},$=function(){return H("stsc",new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,0])))},ee=function(){return H("stts",new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,0])))},te=function(){return H("stco",new Uint8Array([].concat(Object(o.a)(F(0,0)),[0,0,0,0])))};function re(e){var t="";switch(e.type){case"video":t=H("vmhd",new Uint8Array([].concat(Object(o.a)(F(0,1)),[0,0,0,0,0,0,0,0])));break;case"audio":t=H("smhd",[].concat(Object(o.a)(F(0,0)),[0,0,0,0]))}return H("minf",j(t,Y(),Z(e)))}function ne(e){var t=j(function(e){var t,r;return"video"===e.type?(t=e.videoDuration,r=e.videoTimescale):(t=e.audioDuration,r=e.audioTimescale),H("mdhd",new Uint8Array([].concat(Object(o.a)(F(1,0)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Object(o.a)(N(r)),Object(o.a)(U(t)),[85,196,0,0])))}(e),function(e){var t="",r="";switch(e){case"video":t="vide",r="VideoHandler";break;case"audio":t="soun",r="SoundHandler"}return H("hdlr",new Uint8Array([].concat(Object(o.a)(F(0,0)),Object(o.a)(W(4)),Object(o.a)(V(t)),Object(o.a)(z(12)),Object(o.a)(V(r)),[0])))}(e.type),re(e));return H("mdia",t)}function ae(e){var t=j(function(e){var t=e.type,r=e.duration,n=e.width,a=e.height;return H("tkhd",new Uint8Array([].concat(Object(o.a)(F(1,7)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Object(o.a)(N("video"===t?1:2)),Object(o.a)(z(4)),Object(o.a)(U(r)),Object(o.a)(z(8)),[0,0,0,0,0,0,0,0],Object(o.a)(K),[n>>8&255,255&n,0,0,a>>8&255,255&a,0,0])))}(e),ne(e));return H("trak",t)}function ie(e){var t=j(function(e){var t=e.duration;return H("mehd",new Uint8Array([].concat(Object(o.a)(F(0,0)),Object(o.a)(N(t)))))}(e),oe(1),oe(2));return H("mvex",t)}function oe(e){return H("trex",new Uint8Array([].concat(Object(o.a)(F(0,0)),Object(o.a)(N(e)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])))}function se(e,t){var r=j(function(e){var t=e.duration,r=e.timescale;return H("mvhd",new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(Object(o.a)(N(r)),Object(o.a)(U(t)),[0,1,0,0,1,0],Object(o.a)(z(10)),Object(o.a)(K),Object(o.a)(W(24)),[255,255,255,255])))}(e),ae(Object.assign(Object.assign({},e),{type:t})),ie(e));return H("moov",r)}function le(e){var t=j(function(e){var t=e.trackId;return H("tfhd",new Uint8Array([].concat(Object(o.a)(F(0,0)),Object(o.a)(N(t)))))}(e),function(e){var t=e.baseMediaDecodeTime;return H("tfdt",new Uint8Array([].concat(Object(o.a)(F(1,0)),[0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t])))}(e),function(e){var t=e.samples;return H("sdtp",j.apply(void 0,[[0,0,0,0]].concat(Object(o.a)(t.map((function(){return new Uint8Array([16])}))))))}(e),function(e){var t=e.samples,r=e.trackId,n=108+(1===r?16:12)*t.length+t.length,a=new Uint8Array([0,0,1===r?15:7,1].concat(Object(o.a)(N(t.length)),Object(o.a)(N(n)),Object(o.a)(j.apply(void 0,Object(o.a)(t.map((function(e,t){var n=e.duration,a=e.size,i=e.compositionTimeOffset;return j(N(n),N(a),1===r?0===t?[2,0,0,0]:[1,1,0,0]:[1,0,0,0],1===r?N(i):[])})))))));return H("trun",a)}(e));return H("traf",t)}function ue(e){var t=j(function(e){var t=e.sequenceNumber;return H("mfhd",new Uint8Array([].concat(Object(o.a)(F(0,0)),Object(o.a)(N(t)))))}(e),le(e));return H("moof",t)}var ce=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"ftyp",value:function(){return H("ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))}},{key:"moov",value:function(e,t){return se(e,t)}},{key:"moof",value:function(t,r){return ue(Object.assign({},t,{sequenceNumber:e.sequenceNumber++,baseMediaDecodeTime:r}))}},{key:"mdat",value:function(e){var t=e.samples.map((function(e){return new Uint8Array(e.buffer)}));return H("mdat",j.apply(void 0,Object(o.a)(t)))}}]),e}();ce.sequenceNumber=1;var de=2e4,fe=function(){function e(t,r){var n=this;Object(l.a)(this,e),this.installSrc=function(){n.mediaSource=new MediaSource,n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen),n.video.src=URL.createObjectURL(n.mediaSource)},this.handleSourceOpen=function(){n.sourceBuffers.video=n.mediaSource.addSourceBuffer(n.mimeTypes.video),n.sourceBuffers.audio=n.mediaSource.addSourceBuffer(n.mimeTypes.audio),n.sourceBuffers.video.addEventListener("updateend",(function(){var e=n.videoQueue.shift();e&&"open"===n.mediaSource.readyState&&n.handleAppendBuffer(e,"video"),n.needUpdateTime&&(n.needUpdateTime=!1,n.handleTimeUpdate())})),n.sourceBuffers.audio.addEventListener("updateend",(function(){var e=n.audioQueue.shift();e&&"open"===n.mediaSource.readyState&&n.handleAppendBuffer(e,"audio")}))},this.handleAppendBuffer=function(e,t){if("open"===n.mediaSource.readyState)try{n.sourceBuffers[t]&&n.sourceBuffers[t].appendBuffer(e)}catch(r){if(22!==r.code)throw r;n.handleQuotaExceededError(e,t)}else n["".concat(t,"Queue")].push(e)},this.hasBufferedCache=function(e){var t=Object(i.a)(n.mp4Probe.timeRange,2),r=t[0],a=t[1],o=e?n.video.currentTime:Math.floor((r+a)/2),s=n.video.buffered;if(s&&s.length>0)for(var l=0;l<s.length;l++)if(o>=s.start(l)&&o<=s.end(l))return!0;return!1},this.seek=function(e){p.clear();var t=n.mp4Probe.getFragmentPosition(e),r=Object(i.a)(t,2),a=r[0],o=r[1];n.hasBufferedCache(e)&&!n.qualityChangeFlag||(n.handleReplayCase(),n.loadData(a,o).then((function(t){if(t){var r=n.mp4Probe.getTrackInfo(t),a=r.videoTrackInfo,i=r.audioTrackInfo,o=n.mp4Probe,s=o.videoInterval,l=o.audioInterval,u=s.timeInterVal[0],c=l.timeInterVal[0],d=j(ce.moof(a,u),ce.mdat(a));if(0!==i.samples.length){var f=j(ce.moof(i,c),ce.mdat(i));n.handleAppendBuffer(f,"audio")}n.handleAppendBuffer(d,"video"),e&&(n.needUpdateTime=!0),n.qualityChangeFlag=!1}})))},this.handleTimeUpdate=function(){if(n.mp4Probe){var e=n.mp4Probe,t=e.videoInterval,r=(t=void 0===t?[]:t).offsetInterVal,a=void 0===r?[]:r,i=e.mp4Data.videoSamplesLength,o=e.timeRange,s=void 0===o?[]:o;"closed"!==n.mediaSource.readyState&&(a[1]===i&&n.video.currentTime>s[0]?n.destroy():n.shouldFetchNextSegment()&&n.seek())}},this.handleReplayCase=function(){"ended"===n.mediaSource.readyState&&(n.sourceBuffers.video.timestampOffset=0)},this.shouldFetchNextSegment=function(){return n.handleReplayCase(),!!n.mp4Probe.isDraining(n.video.currentTime)},this.destroy=function(){n.mediaSource.removeEventListener("sourceopen",n.handleSourceOpen),URL.revokeObjectURL(n.video.src),"open"!==n.mediaSource.readyState||n.sourceBuffers.video.updating||n.sourceBuffers.audio.updating||n.mediaSource.endOfStream()},this.handleQuotaExceededError=function(e,t){for(var r in n.sourceBuffers){var a=n.sourceBuffers[r],i=n.video.currentTime,o=0;a.buffered.length>0&&(o=a.buffered.start(0)+10),n.removeBuffer(o,i-10,r)}n.handleAppendBuffer(e,t)},this.video=t,this.src=r,this.qualityChangeFlag=!1,this.videoQueue=[],this.audioQueue=[],this.sourceBuffers={video:null,audio:null},this.mimeTypes={video:'video/mp4; codecs="avc1.42E01E"',audio:'audio/mp4; codecs="mp4a.40.2"'},this.installSrc()}return Object(u.a)(e,[{key:"init",value:function(){var e=this;return this.loadData().then((function(e){return new k(new Uint8Array(e)).mp4BoxTreeObject})).then((function(t){var r=t.moov,n=t.ftyp;if(!r){var a=0;for(var i in t)a+=t[i].size;return e.loadData(a,"").then((function(e){var r=new k(new Uint8Array(e)).mp4BoxTreeObject.moov;if(r)return t.moov=r,t}))}var o=r.size+n.size;return o>de?e.loadData(n.size,o).then((function(e){var r=new k(new Uint8Array(e)).mp4BoxTreeObject.moov;if(r)return t.moov=r,t})):t})).then((function(t){e.mp4Probe=new B(t),e.mp4BoxTreeObject=t;var r=j(ce.ftyp(),ce.moov(e.mp4Probe.mp4Data,"video")),n=j(ce.ftyp(),ce.moov(e.mp4Probe.mp4Data,"audio"));e.qualityChangeFlag?(e.handleAppendBuffer(r,"video"),e.handleAppendBuffer(n,"audio")):e.mediaSource.addEventListener("sourceopen",(function(){e.handleAppendBuffer(r,"video"),e.handleAppendBuffer(n,"audio")}))}))}},{key:"changeQuality",value:function(e){var t=this;for(var r in this.src=e,this.qualityChangeFlag=!0,this.sourceBuffers){var n=this.sourceBuffers[r],a=n.buffered.length;a>0&&this.removeBuffer(n.buffered.start(0),n.buffered.end(a-1),r)}this.init().then((function(){t.video.currentTime=t.video.currentTime}))}},{key:"removeBuffer",value:function(e,t,r){var n=this.sourceBuffers[r];n.updating&&(f.e.isSafari&&function(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=e.apply(this,r);return a.abort=function(){},a}}(),n.abort());n.remove(e,t)}},{key:"loadData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de;return new Promise((function(n){new p(e.src,t,r,n)})).catch((function(){}))}}]),e}(),he=f.e.isSafari,ve=function(e){Object(n.a)(r,e);var t=Object(a.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments)).video=null,e.useMSE=!0,e.handleTimeUpdate=function(t){var r,n;e.useMSE&&e.mse.handleTimeUpdate(),null===(n=(r=e.props).onTimeUpdate)||void 0===n||n.call(r,t)},e.handleVideoSeeking=function(t){var r,n;if(e.video){var a=e.video.currentTime,i=e.video.buffered;if(he&&i&&i.length>0){if(a-.1>i.start(0))e.useMSE&&e.mse.seek(e.video.currentTime);else if(a<i.start(0))return void e.handleSafariBug()}else e.useMSE&&e.mse.seek(e.video.currentTime);null===(n=(r=e.props).onSeeking)||void 0===n||n.call(r,t)}},e.handlePlay=function(t){if(e.video){0===e.video.currentTime&&e.useMSE&&e.mse.seek(0);var r=e.props.onPlay;r&&r(t)}},e.handleVideoProgress=function(t){var r,n;if(e.video){var a=e.video.buffered,i=e.video.currentTime;he&&a&&a.length>0&&i<a.start(0)&&e.handleVideoSeeking(t),null===(n=(r=e.props).onProgress)||void 0===n||n.call(r,t)}},e.handleSafariBug=function(){if(e.video){var t=0;e.video.buffered.length>0&&(t=e.video.buffered.start(0)),e.video.currentTime=t+.1}},e}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.mse=new fe(this.video,this.props.src),this.mse.init().then((function(){e.mse.mp4Probe.mp4Data.videoDuration||(e.useMSE=!1,e.video.src=e.props.src)}))}},{key:"componentDidUpdate",value:function(e){this.props.src!==e.src&&this.useMSE&&this.mse.changeQuality(this.props.src)}},{key:"componentWillUnmount",value:function(){this.useMSE&&this.mse.destroy()}},{key:"render",value:function(){var e=this,t=this.props,r=(t.src,t.onRef),n=(t.currentQuality,t.useAutoQuality,t.onSeeking,t.onPlay,t.paused,t.onTimeUpdate,t.onProgress,function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(t,["src","onRef","currentQuality","useAutoQuality","onSeeking","onPlay","paused","onTimeUpdate","onProgress"]));return d.a.createElement("video",Object.assign({ref:function(t){e.video=t,r(t)}},n,{onSeeking:this.handleVideoSeeking,onTimeUpdate:this.handleTimeUpdate,onPlay:this.handlePlay,onProgress:this.handleVideoProgress}))}}]),r}(c.Component),pe={pluginName:"griffith-mp4",VideoComponent:ve,willHandleSrcChange:!0}},366:function(e,t,r){var n=r(367);e.exports=function(e){return n(e,5)}},367:function(e,t,r){var n=r(169),a=r(368),i=r(317),o=r(370),s=r(371),l=r(374),u=r(375),c=r(376),d=r(377),f=r(171),h=r(378),v=r(163),p=r(379),g=r(380),m=r(385),y=r(103),b=r(130),E=r(387),S=r(116),k=r(389),T=r(165),L=r(299),w="[object Arguments]",_="[object Function]",A="[object Object]",O={};O[w]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[A]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[_]=O["[object WeakMap]"]=!1,e.exports=function e(t,r,R,C,P,x){var D,M=1&r,I=2&r,B=4&r;if(R&&(D=P?R(t,C,P,x):R(t)),void 0!==D)return D;if(!S(t))return t;var F=y(t);if(F){if(D=p(t),!M)return u(t,D)}else{var j=v(t),N=j==_||"[object GeneratorFunction]"==j;if(b(t))return l(t,M);if(j==A||j==w||N&&!P){if(D=I||N?{}:m(t),!M)return I?d(t,s(D,t)):c(t,o(D,t))}else{if(!O[j])return P?t:{};D=g(t,j,M)}}x||(x=new n);var U=x.get(t);if(U)return U;x.set(t,D),k(t)?t.forEach((function(n){D.add(e(n,r,R,n,t,x))})):E(t)&&t.forEach((function(n,a){D.set(a,e(n,r,R,a,t,x))}));var G=F?void 0:(B?I?h:f:I?L:T)(t);return a(G||t,(function(n,a){G&&(n=t[a=n]),i(D,a,e(n,r,R,a,t,x))})),D}},368:function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},369:function(e,t,r){var n=r(56),a=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=a},370:function(e,t,r){var n=r(289),a=r(165);e.exports=function(e,t){return e&&n(t,a(t),e)}},371:function(e,t,r){var n=r(289),a=r(299);e.exports=function(e,t){return e&&n(t,a(t),e)}},372:function(e,t,r){var n=r(116),a=r(168),i=r(373),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=a(e),r=[];for(var s in e)("constructor"!=s||!t&&o.call(e,s))&&r.push(s);return r}},373:function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},374:function(e,t,r){(function(e){var n=r(36),a=t&&!t.nodeType&&t,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a?n.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(131)(e))},375:function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},376:function(e,t,r){var n=r(289),a=r(164);e.exports=function(e,t){return n(e,a(e),t)}},377:function(e,t,r){var n=r(289),a=r(319);e.exports=function(e,t){return n(e,a(e),t)}},378:function(e,t,r){var n=r(172),a=r(319),i=r(299);e.exports=function(e){return n(e,i,a)}},379:function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},380:function(e,t,r){var n=r(300),a=r(381),i=r(382),o=r(383),s=r(384);e.exports=function(e,t,r){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return a(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,r);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return i(e);case"[object Symbol]":return o(e)}}},381:function(e,t,r){var n=r(300);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},382:function(e,t){var r=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}},383:function(e,t,r){var n=r(102),a=n?n.prototype:void 0,i=a?a.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},384:function(e,t,r){var n=r(300);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},385:function(e,t,r){var n=r(386),a=r(320),i=r(168);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(a(e))}},386:function(e,t,r){var n=r(116),a=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(a)return a(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},387:function(e,t,r){var n=r(388),a=r(166),i=r(167),o=i&&i.isMap,s=o?a(o):n;e.exports=s},388:function(e,t,r){var n=r(163),a=r(73);e.exports=function(e){return a(e)&&"[object Map]"==n(e)}},389:function(e,t,r){var n=r(390),a=r(166),i=r(167),o=i&&i.isSet,s=o?a(o):n;e.exports=s},390:function(e,t,r){var n=r(163),a=r(73);e.exports=function(e){return a(e)&&"[object Set]"==n(e)}}}]);
//# sourceMappingURL=1.58cde327.chunk.js.map